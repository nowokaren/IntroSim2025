(()=>{var e,t,i={540:e=>{"use strict";e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},1113:e=>{"use strict";e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},2467:e=>{"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var i=e(t);return t[2]?"@media ".concat(t[2]," {").concat(i,"}"):i})).join("")},t.i=function(e,i,r){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(r)for(var o=0;o<this.length;o++){var a=this[o][0];null!=a&&(n[a]=!0)}for(var s=0;s<e.length;s++){var l=[].concat(e[s]);r&&n[l[0]]||(i&&(l[2]?l[2]="".concat(i," and ").concat(l[2]):l[2]=i),t.push(l))}},t}},2635:(e,t,i)=>{"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,o(r.key),r)}}function o(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}i.d(t,{A:()=>s});var a=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.label="[".concat(t,"]"),this.isTrackerOn=this.debugLevels.indexOf("*")>-1||this.debugLevels.indexOf("qa")>-1},(t=[{key:"_templateLogging",value:function(e,t,i,r){if(this.isTrackerOn){var n="";for(var o in i)n+="".concat(o,": ").concat(i[o],"; ");"string"==typeof t?console[r]("%c".concat(this.label," [").concat(e,"] ").concat(t),n):console[r]("%c".concat(this.label," [").concat(e,"]"),n,t)}}},{key:"error",value:function(e,t,i){this._templateLogging(e,t,i,"error")}},{key:"warn",value:function(e,t,i){this._templateLogging(e,t,i,"warn")}},{key:"info",value:function(e,t,i){this._templateLogging(e,t,i,"info")}},{key:"log",value:function(e,t,i){this._templateLogging(e,t,i,"log")}},{key:"time",value:function(e){this.isTrackerOn&&console.time(e)}},{key:"timeEnd",value:function(e){this.isTrackerOn&&console.timeEnd(e)}}])&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();a.prototype.debugLevels="";const s=a},4135:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r={playerDisplayImpression:81,forceWf:126,lowNetworkDownlink:157,ppdAdIsPlaying:158,start:"start",creativeView:"creativeView",close:"close",maxReadyVpaidHit:169,queueSizeHit:170,iiqIds:177,oldBlockListLoaded:178}},4900:(e,t,i)=>{"use strict";i.d(t,{A:()=>o});var r=i(2467),n=i.n(r)()((function(e){return e[1]}));n.push([e.id,"#_cm-css-reset {\n    height: inherit;\n    width: inherit;\n    direction: ltr;\n    text-align: left;\n}\n\n#_cm-css-reset.vpaid-player-container .vjs-tech {\n    background-color: #000000;\n}\n\n#_cm-css-reset.vpaid-player-container {\n    position: relative;\n    z-index: 99;\n}\n\n#_cm-css-reset.vpaid-player-container video ~ iframe {\n    z-index: 10;\n    position: absolute;\n    left: 0;\n    top: 0;\n}\n\n#_cm-css-reset .vpaid-ad-controls {\n    -webkit-transition: opacity 500ms ease-out;\n    -moz-transition: opacity 500ms ease-out;\n    -o-transition: opacity 500ms ease-out;\n    transition: opacity 500ms ease-out;\n    opacity: 0;\n}\n\n#_cm-css-reset.vpaid-player-container:hover .vpaid-ad-controls {\n    opacity: 1;\n}\n\n#_cm-css-reset.vpaid-player-container .vpaid-ad-controls,\n#_cm-css-reset.vpaid-player-container .vpaid-ad-pause {\n    height: 30px;\n    right: 0;\n    position: absolute;\n    left: 0px;\n    bottom: 0;\n    z-index: 1001;\n    background-color: rgba(0, 0, 0, 1);\n    border-top: 1px rgba(255, 255, 255, 0.7) solid;\n}\n\n#_cm-css-reset .vpaid-ad-controls.vjs-default-skin .vjs-control {\n    width: 2em;\n}\n/*\n#_cm-css-reset .vpaid-ad-controls.vjs-default-skin .vjs-control:before {\n    line-height: 2;\n    font-size: 16px;\n}*/\n\n#_cm-css-reset\n    .vpaid-ad-controls.vjs-default-skin\n    .vjs-control.c-paused:before {\n    content: '\\e001';\n}\n\n#_cm-css-reset.vpaid-player-container .vpaid-ad-volume-container {\n    height: 30px;\n    width: 60px;\n    position: relative;\n    float: right;\n    margin-right: 10px;\n    top: 0;\n    cursor: pointer;\n}\n\n#_cm-css-reset.vpaid-player-container .vpaid-ad-mute-container {\n    height: 30px;\n    width: 30px;\n    position: relative;\n    float: right;\n    top: 0;\n    cursor: pointer;\n}\n\n#_cm-css-reset.vpaid-player-container .vpaid-ad-volume-track {\n    height: 8px;\n    border: 1px #000000 solid;\n    box-shadow: 0 0 5px 1px rgb(255, 255, 255);\n    position: absolute;\n    z-index: 0;\n    right: 0;\n    top: 11px;\n    left: 0;\n    background: rgba(51, 51, 51, 0.9);\n}\n\n#_cm-css-reset.vpaid-player-container .vpaid-ad-volume-slider {\n    height: 8px;\n    border: 1px #000000 solid;\n    position: absolute;\n    width: 40%;\n    top: 11px;\n    left: 0;\n    background: rgba(183, 234, 187, 0.9);\n    z-index: 1;\n}\n\n/*#_cm-css-reset .mpegcnv::before {\n    content: \"\";\n    position: absolute;\n    \n    top: 0;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    z-index: 100;\n}*/\n\n#_cm-css-reset .tbl-text {\n    font-family: Arial, Helvetica, sans-serif;\n    white-space: nowrap;\n    font-size: 11px;\n    color: #fff;\n    left: 10px;\n    top: 4px;\n    position: absolute;\n    font-weight: bold;\n    z-index: 1001;\n}\n\n#_cm-css-reset .mc-video {\n    z-index: 101;\n}\n\n#_cm-css-reset .vpaid-handler {\n    z-index: 1000;\n    height: 100%;\n    width: 100%;\n}\n\n#_cm-css-reset .speaker {\n    position: absolute;\n    width: 46px;\n    height: 46px;\n    bottom: -3px;\n    right: -5px;\n    z-index: 1001;\n    background-image: url('https://vidstat.taboola.com/player-assets/mob-vol-on.svg');\n}\n#_cm-css-reset .speaker.mute {\n    background-image: url('https://vidstat.taboola.com/player-assets/mob-vol-off.svg');\n}\n\n#_cm-css-reset .hide {\n    display: none;\n}\n\n#_cm-css-reset .mc-loud-video {\n    position: absolute;\n    pointer-events: none;\n}\n#_cm-css-reset .mc-loud-video::-webkit-media-controls-panel {\n    display: none !important;\n    -webkit-appearance: none;\n}\n\n/* Old shadow dom for play button */\n\n#_cm-css-reset .mc-loud-video::state(webkit-media-controls-play-button) {\n    display: none !important;\n    -webkit-appearance: none;\n}\n\n/* New shadow dom for play button */\n\n/* This one works */\n\n#_cm-css-reset .mc-loud-video::-webkit-media-controls-start-playback-button {\n    display: none !important;\n    -webkit-appearance: none;\n}\n\n#_cm-css-reset .mc-loud-video::-webkit-media-controls {\n    display: none !important;\n}\n#_cm-css-reset .mc-loud-video::-webkit-media-controls-enclosure {\n    display: none !important;\n}\n\n#_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls.show {\n    display: block;\n    margin: 0;\n    padding: 0;\n    position: initial;\n}\n\n#_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls.show * {\n    position: absolute !important;\n    display: block;\n    margin: 0;\n    padding: 0;\n    background-color: transparent;\n}\n\n#_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls {\n    width: 100%;\n    height: 100%;\n    z-index: 1000;\n    left: 0;\n    bottom: -32px;\n    -webkit-transition: bottom 0.35s ease-in-out;\n    -moz-transition: bottom 0.35s ease-in-out;\n    -o-transition: bottom 0.35s ease-in-out;\n    transition: bottom 0.35s ease-in-out;\n}\n\n#_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .control {\n    z-index: 100;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .interactive {\n    pointer-events: all;\n    cursor: pointer;\n}\n\n#_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls.hide,\n#_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .hide {\n    display: none;\n}\n\n#_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls.show,\n#_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .show {\n    display: block;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .cm_video_controls_progressbar_area {\n    width: 100%;\n    height: 5px;\n    bottom: 0%;\n    cursor: default;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .cm_video_controls_progressbar_area\n    .cm_video_controls_progressbar {\n    height: 100%;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .cm_video_controls_progressbar_area\n    .cm_video_controls_progressbar_bg {\n    width: 100%;\n    height: 100%;\n}\n\n#_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .white_bg {\n    background: rgba(255, 255, 255, 0.3);\n}\n\n#_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .blue_bg {\n    background: rgba(21, 75, 145, 1);\n    -webkit-transition: width 0.5s ease;\n    -moz-transition: width 0.5s ease;\n    -o-transition: width 0.5s ease;\n    transition: width 0.5s ease;\n    width: 0%;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .blue_bg.init_bg {\n    -webkit-transition: none;\n    -moz-transition: none;\n    -o-transition: none;\n    transition: none;\n}\n\n#_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls {\n    width: 100%;\n    height: 27px;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .cm_video_controls_main_area\n    .play_pause {\n    top: 3px;\n    left: 5px;\n    width: 20px;\n    height: 20px;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .cm_video_controls_main_area\n    .play_pause\n    .pause {\n    width: 40px;\n    height: 27px;\n    top: -7px;\n    left: -8px;\n    background-image: url('https://vidstat.taboola.com/player-assets/pause2.svg');\n    background-size: 36px;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .cm_video_controls_main_area\n    .play_pause\n    .play {\n    border-top: 5px solid transparent;\n    border-left: 10px solid #fff;\n    border-bottom: 5px solid transparent;\n    left: 6px;\n    top: 5px;\n    z-index: 102;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .cm_video_controls_main_area\n    .title {\n    top: 7px;\n    left: 30px;\n    width: 140px;\n    text-align: left;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .cm_video_controls_main_area\n    .timer {\n    top: 6px;\n    right: 110px;\n}\n\n#_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls .text {\n    color: white;\n    font-size: 13px;\n    font-weight: bold;\n    font-family: Arial, Helvetica, sans-serif;\n    top: 10px;\n    left: 28px;\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -khtml-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n    cursor: default;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .text.opt-out-hidden {\n    left: 13px;\n}\n\n#_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls {\n    width: 100%;\n    height: 100%;\n    right: 0px;\n    bottom: 0;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .video_controls_main_area\n    .cm_video_controls_mute {\n    width: 35px;\n    height: 27px;\n    right: 8px;\n    bottom: 5px;\n    background-size: 44px;\n    box-sizing: content-box;\n    background-position-y: center;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .video_controls_main_area\n    .cm_video_controls_mute.display_mute {\n    background-image: url('https://vidstat.taboola.com/player-assets/desk_muted2.svg');\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .video_controls_main_area\n    .cm_video_controls_mute.display_unmute {\n    background-image: url('https://vidstat.taboola.com/player-assets/desk_playing2.svg');\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .video_controls_main_area\n    .video-controls-scroller-area {\n    width: 80px;\n    height: 100%;\n    right: 5px;\n    top: 0%;\n}\n\n#_cm-css-reset ._cm-video-ad.vpaid-player-container .video_controls_mobile {\n    width: 100%;\n    height: 100%;\n    top: 0;\n    left: 0;\n    pointer-events: none;\n    z-index: 1001;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .video_controls_main_area {\n    pointer-events: none;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .video_controls_main_area\n    .cm_video_controls_playpause.hide {\n    display: none;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .video_controls_main_area\n    .cm_video_controls_playpause.show {\n    display: block;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .video_controls_main_area\n    .cm_video_controls_playpause {\n    bottom: 28px;\n    left: 5px;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .video_controls_main_area\n    .cm_video_controls_playpause\n    .pause {\n    width: 40px;\n    height: 27px;\n    top: -10px;\n    left: -8px;\n    background-image: url(https://vidstat.taboola.com/player-assets/pause2.svg);\n    background-size: 40px;\n}\n\n#_cm-css-reset\n    ._cm-video-ad.vpaid-player-container\n    .video_controls\n    .video_controls_main_area\n    .cm_video_controls_playpause\n    .play {\n    border-top: 6px solid transparent;\n    border-left: 10px solid #fff;\n    border-bottom: 6px solid transparent;\n    left: 7px;\n    top: 3px;\n    z-index: 102;\n}\n\n#_cm-css-reset .mc-play {\n    width: 0;\n    height: 0;\n    border-top: 7px solid transparent;\n    border-left: 9px solid #fff;\n    border-bottom: 7px solid transparent;\n    left: 14px;\n    position: absolute;\n    bottom: 10px;\n    z-index: 1001;\n}\n\n#_cm-css-reset .mc-pause {\n    display: block;\n    width: 42px;\n    height: 42px;\n    left: -4px;\n    position: absolute;\n    bottom: -2px;\n    z-index: 1001;\n    background-image: url('https://vidstat.taboola.com/player-assets/mob-pause.svg');\n}\n\n#_cm-css-reset .mc-pause.hide,\n#_cm-css-reset .mc-play.hide {\n    display: none;\n}\n\n#_cm-css-reset .mc-pause.show,\n#_cm-css-reset .mc-play.show {\n    display: block;\n}\n\n#_cm-css-reset .mc-progressbar_area {\n    width: 100%;\n    height: 5px;\n    bottom: 0%;\n    position: absolute;\n    z-index: 9999;\n}\n\n#_cm-css-reset .mc-progressbar_area .mc-progressbar_bg.white_bg {\n    background: rgba(255, 255, 255, 0.3);\n    width: 100%;\n    height: 100%;\n}\n\n#_cm-css-reset .mc-progressbar_area .mc-progressbar_bg.blue_bg {\n    background: rgba(21, 75, 145, 1);\n    -webkit-transition: width 0.5s ease;\n    -moz-transition: width 0.5s ease;\n    -o-transition: width 0.5s ease;\n    transition: width 0.5s ease;\n    position: absolute;\n    bottom: 0%;\n    height: 100%;\n}\n\n#_cm-css-reset .mc-progressbar_area .mc-progressbar_bg.blue_bg.init_bg {\n    -webkit-transition: none;\n    -moz-transition: none;\n    -o-transition: none;\n    transition: none;\n}\n\n#_cm-css-reset > .multi-vpaids {\n    height: 0px;\n}\n\n#_cm-css-reset *::-webkit-media-controls-panel {\n    display: none !important;\n    -webkit-appearance: none;\n}\n\n/* Old shadow dom for play button */\n\n#_cm-css-reset *::-webkit-media-controls-play-button {\n    display: none !important;\n    -webkit-appearance: none;\n}\n\n/* New shadow dom for play button */\n\n/* This one works! */\n\n#_cm-css-reset *::-webkit-media-controls-start-playback-button {\n    display: none !important;\n    -webkit-appearance: none;\n}\n\n#_cm-css-reset .cm-ad-player {\n    cursor: pointer;\n    position: absolute;\n    left: 0px;\n    top: 0px;\n    z-index: 0;\n}\n\n@supports (object-fit: cover) {\n    #_cm-css-reset .cm-ad-player {\n        object-fit: cover;\n    }\n\n    #_cm-css-reset .cm-ad-player.vertical-video,\n    #_cm-css-reset .cm-ad-player.next-up-fit {\n        object-fit: contain;\n    }\n}\n\n#_cm-css-reset .cm-ad-player.ie-black-edges {\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n}\n\n#_cm-css-reset .cm-ad-player-active {\n    visibility: visible;\n}\n\n#_cm-css-reset ._cm-ad-feed-manager ._cm-ad {\n    display: block !important;\n    visibility: hidden !important;\n}\n\n#_cm-css-reset ._cm-ad-choices-player {\n    position: absolute;\n    top: 16px;\n    left: 13px;\n}\n\n#_cm-css-reset ._cm-ad-choices-player-anchor {\n    display: inline-block;\n    opacity: 0.5;\n    vertical-align: middle;\n}\n\n#_cm-css-reset .interactive-video {\n    position: absolute;\n    z-index: 999 !important;\n    cursor: pointer;\n    transition:\n        visibility 0.2s,\n        opacity 0.5s linear;\n    display: initial !important;\n    opacity: 0.8;\n    font-size: 0.875rem;\n    padding-left: 0.75rem;\n    padding-right: 0.75rem;\n    padding-top: 0.25rem;\n    padding-bottom: 0.25rem;\n    font-weight: 600;\n    border-radius: 9999px;\n    font-size: 3.5vmin;\n    text-shadow: 1px 1px black;\n    font-family: Impact, Charcoal, sans-serif !important;\n    letter-spacing: 0.2px;\n}\n\n#_cm-css-reset .interactive-video-lbls {\n    font-family: Impact, Charcoal, sans-serif !important;\n    letter-spacing: 0.2px;\n}\n\n#_cm-css-reset .interactive-video.center {\n    position: relative;\n}\n\n#_cm-css-reset .interactive-video.hide {\n    opacity: 0;\n    visibility: hidden;\n}\n\n#_cm-css-reset .interactive-video-wrapper {\n    position: absolute;\n    width: 100%;\n    text-align: center;\n}\n\n#_cm-css-reset .interactive-video-wrapper.hide {\n    opacity: 0;\n    visibility: hidden;\n}\n\n#_cm-css-reset .interactive-video.show {\n    opacity: 1;\n    visibility: visible;\n}\n\n#_cm-css-reset .interactive-video-effect {\n    -webkit-transition: width 0s ease;\n    -moz-transition: width 0s ease;\n    -o-transition: width 0s ease;\n    transition: width 0s ease;\n    height: 1px;\n    background-color: white;\n    pointer-events: none;\n}\n\n#_cm-css-reset .interactive-video-effect-wrapper {\n    padding-left: 0.75rem;\n}\n\n@media only screen and (max-width: 768px) {\n    #_cm-css-reset .interactive-video {\n        font-size: 3vmin;\n    }\n}\n\n#_cm-css-reset .cm-vpaid-iframe {\n    position: absolute;\n    left: 0px;\n    top: 0px;\n    margin: 0px !important;\n    padding: 0px;\n    border: none;\n    width: 100%;\n    height: 100%;\n    z-index: 1;\n}\n\n.buff-vid {\n    z-index: 2147483647 !important;\n    position: fixed;\n    right: 0;\n    width: 1px;\n    height: 1px;\n}\n\n#_cm-css-reset ._cm-ad-choices-player {\n    z-index: 1;\n}\n\n#_cm-css-reset ._cm-ad-choices-player-anchor {\n    width: 19px;\n    height: 15px;\n}\n",""]);const o=n},5056:(e,t,i)=>{"use strict";e.exports=function(e){var t=i.nc;t&&e.setAttribute("nonce",t)}},5072:e=>{"use strict";var t=[];function i(e){for(var i=-1,r=0;r<t.length;r++)if(t[r].identifier===e){i=r;break}return i}function r(e,r){for(var o={},a=[],s=0;s<e.length;s++){var l=e[s],d=r.base?l[0]+r.base:l[0],u=o[d]||0,c="".concat(d," ").concat(u);o[d]=u+1;var h=i(c),p={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var f=n(p,r);r.byIndex=s,t.splice(s,0,{identifier:c,updater:f,references:1})}a.push(c)}return a}function n(e,t){var i=t.domAPI(t);i.update(e);return function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;i.update(e=t)}else i.remove()}}e.exports=function(e,n){var o=r(e=e||[],n=n||{});return function(e){e=e||[];for(var a=0;a<o.length;a++){var s=i(o[a]);t[s].references--}for(var l=r(e,n),d=0;d<o.length;d++){var u=i(o[d]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}o=l}}},7628:(e,t,i)=>{"use strict";i.d(t,{A:()=>l,V:()=>s});var r=i(7886);function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a(r.key),r)}}function a(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}var s={vastDuration:"vdr",videoElementDuration:"edr",vastWidth:"vwd",videoElementWidth:"ewd",vastHeight:"vht",videoElementHeight:"eht",vastBitrate:"vbr",videoElementUrl:"vu",videoElementType:"vt",vastOriginalType:"ot",vastSubType:"st",effectiveConnectionType:"ect",connectionType:"ct",vasts:"vst",videoUrlChanged:"vuc",winningPrice:"wp",vpaidUrl:"vpu"},l=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t,this.hadImpression=!1,this.onNavigatorConnectionChange=this._onNavigatorConnectionChange.bind(this),this.store.on("navigatorConnectionChange",this.onNavigatorConnectionChange);var i=this.store.get("navigatorConnection")||{};this.dast={vdr:void 0,edr:void 0,vwd:void 0,ewd:void 0,vht:void 0,eht:void 0,vbr:void 0,vu:void 0,vt:void 0,ot:void 0,st:void 0,ect:i.effectiveTypeId,ct:i.typeId,vst:[],vuc:!1,wp:void 0}},(t=[{key:"set",value:function(e){this.stopped||(e.hasOwnProperty("vu")&&""!==e.vu&&(e.vt=this._getVideoTypeFromUrl(e.vu),this.hadImpression&&e.vu!==this.dast.vu&&(this.dast.vuc=!0)),this.dast=Object.assign(this.dast,e))}},{key:"_getVideoTypeFromUrl",value:function(e){var t,i=e.match(/\.([^\/#?]+)([#?][^\/]*)?$/);return i&&i.length>1&&(t=i[1]),t}},{key:"addWrapper",value:function(e){this.stopped||(e.hasOwnProperty("wu")&&""!==e.wu&&(e.wu=this._getHostnameFromWrapperUrl(e.wu)),this.dast.vst.push(e))}},{key:"_getHostnameFromWrapperUrl",value:function(e){var t=document.createElement("a");t.href=e;var i=t.hostname;return t=null,i}},{key:"_onNavigatorConnectionChange",value:function(e){this.stopped||(this.dast.ect=e.effectiveTypeId,this.dast.ct=e.typeId)}},{key:"get",value:function(){if(!this.stopped)return(0,r.Rt)(this.dast)}},{key:"getByKey",value:function(e){var t=s[e]||e;return this.dast[t]}},{key:"destroy",value:function(){this.stopped=!0,this.store.off("navigatorConnectionChange",this.onNavigatorConnectionChange),this.store=this.onNavigatorConnectionChange=this.dast=void 0}},{key:"onImpression",value:function(e,t){this.hadImpression=!0,this.dast.vu=e,t&&(this.dast.edr=t.duration,this.dast.ewd=parseInt(t.videoWidth),this.dast.eht=parseInt(t.videoHeight))}},{key:"getWrappers",value:function(){return this.dast.vst}}])&&o(e.prototype,t),i&&o(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}()},7659:e=>{"use strict";var t={};e.exports=function(e,i){var r=function(e){if(void 0===t[e]){var i=document.querySelector(e);if(window.HTMLIFrameElement&&i instanceof window.HTMLIFrameElement)try{i=i.contentDocument.head}catch(e){i=null}t[e]=i}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(i)}},7825:e=>{"use strict";e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(i){!function(e,t,i){var r="";i.supports&&(r+="@supports (".concat(i.supports,") {")),i.media&&(r+="@media ".concat(i.media," {"));var n=void 0!==i.layer;n&&(r+="@layer".concat(i.layer.length>0?" ".concat(i.layer):""," {")),r+=i.css,n&&(r+="}"),i.media&&(r+="}"),i.supports&&(r+="}");var o=i.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,i)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},7886:(e,t,i)=>{"use strict";i.d(t,{$O:()=>O,$e:()=>I,AY:()=>oe,As:()=>D,Bq:()=>T,DA:()=>b,Em:()=>te,Go:()=>S,Hj:()=>C,Ih:()=>de,JO:()=>Z,Jr:()=>ce,Kk:()=>$,O5:()=>re,Ob:()=>N,Ok:()=>q,QR:()=>E,Q_:()=>m,Qv:()=>K,Rt:()=>G,SI:()=>Y,Sp:()=>ae,T7:()=>le,TF:()=>M,Tn:()=>he,VT:()=>H,Xg:()=>R,ZE:()=>V,_o:()=>j,_x:()=>pe,bv:()=>ie,d5:()=>z,gM:()=>U,h2:()=>se,hX:()=>ee,hw:()=>g,iQ:()=>k,jr:()=>x,k3:()=>f,p4:()=>ue,ph:()=>X,q1:()=>L,ri:()=>y,s1:()=>A,sk:()=>J,tZ:()=>F,uo:()=>B,v6:()=>ne,vZ:()=>fe,vn:()=>P,vy:()=>w,wx:()=>W});var r=i(9054),n=i(9312),o=i(8029);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,o,a,s=[],l=!0,d=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(r=o.call(i)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){d=!0,n=e}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(d)throw n}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?s(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function l(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function d(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}var c,h=32766,p=null;function f(e){c=e}function v(e){return!!e&&(null!==p?p:e.get("dpndonuntfrlgtoelstc")?function(e){var t=e.get("elasticSessionId");return p=e.get("shouldSendDataToElastic")&&void 0!==t,p}(e):function(e){var t=parseInt(e.get("ga_factor"));if(!t)return p;if(1===t)return p=!0;t>100&&(t=100);var i=g(0,t);return p=i===t}(e))}function y(e){return 0!==(e=Math.max(Math.min(100,e),0))&&(1===e||g(0,e)===e)}function m(e,t,i,r){v(r)&&function(e,t,i,r){var n=r.get("player_version"),o=r.get("ab_test")||"",a=new XMLHttpRequest;a.open("POST","".concat(r.get("kbnul"),"/putes/").concat(e),!0);var s={event:t,timestamp:(new Date).toISOString(),version:n,abTest:o};s=Object.assign(s,i),a.send(D(function(e){return function(e,t){var i=[],r=function(e,n,o){var a=0;if(void 0===e)a=0;else if("boolean"==typeof e)a=4;else if("string"==typeof e)t&&e.length>h&&(e=n[o]="STRING TOO LONG"),a=2*e.length;else if("number"==typeof e)a=8;else if(he(e))try{a=2*e.toString().length}catch(e){}else if("object"===u(e)&&-1===i.indexOf(e))for(var s in i[i.length]=e,e)a+=8,a+=r(e[s],e,s);return a};r(e,e,null)}(e,!0),e}(s)))}(e,t,i,r)}function g(e,t){return Math.floor(Math.random()*(t-e+1))+e}var _="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split("");function b(e,t){var i=_,r=[];t=t||i.length,e=e||22;for(var n=0;n<e;n++)r[n]=i[0|Math.random()*t];return r.join("")}function A(e){return"string"!=typeof e||0!==(e=e.replace(/^(http[s]?:|ftp:)/g,"")).indexOf("//")&&(e="//"+e),e}function E(e){if(!e||"string"!=typeof e)return 0;var t;void 0===t&&(t=0);var i=0;t=~t;for(var r=0,n=(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;i<e.length;i++){var r=e.charCodeAt(i);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t}(e)).length;r<n;r++)i=255&(t^e.charCodeAt(r)),t=t>>>8^"0x"+"00000000 77073096 EE0E612C 990951BA 076DC419 706AF48F E963A535 9E6495A3 0EDB8832 79DCB8A4 E0D5E91E 97D2D988 09B64C2B 7EB17CBD E7B82D07 90BF1D91 1DB71064 6AB020F2 F3B97148 84BE41DE 1ADAD47D 6DDDE4EB F4D4B551 83D385C7 136C9856 646BA8C0 FD62F97A 8A65C9EC 14015C4F 63066CD9 FA0F3D63 8D080DF5 3B6E20C8 4C69105E D56041E4 A2677172 3C03E4D1 4B04D447 D20D85FD A50AB56B 35B5A8FA 42B2986C DBBBC9D6 ACBCF940 32D86CE3 45DF5C75 DCD60DCF ABD13D59 26D930AC 51DE003A C8D75180 BFD06116 21B4F4B5 56B3C423 CFBA9599 B8BDA50F 2802B89E 5F058808 C60CD9B2 B10BE924 2F6F7C87 58684C11 C1611DAB B6662D3D 76DC4190 01DB7106 98D220BC EFD5102A 71B18589 06B6B51F 9FBFE4A5 E8B8D433 7807C9A2 0F00F934 9609A88E E10E9818 7F6A0DBB 086D3D2D 91646C97 E6635C01 6B6B51F4 1C6C6162 856530D8 F262004E 6C0695ED 1B01A57B 8208F4C1 F50FC457 65B0D9C6 12B7E950 8BBEB8EA FCB9887C 62DD1DDF 15DA2D49 8CD37CF3 FBD44C65 4DB26158 3AB551CE A3BC0074 D4BB30E2 4ADFA541 3DD895D7 A4D1C46D D3D6F4FB 4369E96A 346ED9FC AD678846 DA60B8D0 44042D73 33031DE5 AA0A4C5F DD0D7CC9 5005713C 270241AA BE0B1010 C90C2086 5768B525 206F85B3 B966D409 CE61E49F 5EDEF90E 29D9C998 B0D09822 C7D7A8B4 59B33D17 2EB40D81 B7BD5C3B C0BA6CAD EDB88320 9ABFB3B6 03B6E20C 74B1D29A EAD54739 9DD277AF 04DB2615 73DC1683 E3630B12 94643B84 0D6D6A3E 7A6A5AA8 E40ECF0B 9309FF9D 0A00AE27 7D079EB1 F00F9344 8708A3D2 1E01F268 6906C2FE F762575D 806567CB 196C3671 6E6B06E7 FED41B76 89D32BE0 10DA7A5A 67DD4ACC F9B9DF6F 8EBEEFF9 17B7BE43 60B08ED5 D6D6A3E8 A1D1937E 38D8C2C4 4FDFF252 D1BB67F1 A6BC5767 3FB506DD 48B2364B D80D2BDA AF0A1B4C 36034AF6 41047A60 DF60EFC3 A867DF55 316E8EEF 4669BE79 CB61B38C BC66831A 256FD2A0 5268E236 CC0C7795 BB0B4703 220216B9 5505262F C5BA3BBE B2BD0B28 2BB45A92 5CB36A04 C2D7FFA7 B5D0CF31 2CD99E8B 5BDEAE1D 9B64C2B0 EC63F226 756AA39C 026D930A 9C0906A9 EB0E363F 72076785 05005713 95BF4A82 E2B87A14 7BB12BAE 0CB61B38 92D28E9B E5D5BE0D 7CDCEFB7 0BDBDF21 86D3D2D4 F1D4E242 68DDB3F8 1FDA836E 81BE16CD F6B9265B 6FB077E1 18B74777 88085AE6 FF0F6A70 66063BCA 11010B5C 8F659EFF F862AE69 616BFFD3 166CCF45 A00AE278 D70DD2EE 4E048354 3903B3C2 A7672661 D06016F7 4969474D 3E6E77DB AED16A4A D9D65ADC 40DF0B66 37D83BF0 A9BCAE53 DEBB9EC5 47B2CF7F 30B5FFE9 BDBDF21C CABAC28A 53B39330 24B4A3A6 BAD03605 CDD70693 54DE5729 23D967BF B3667A2E C4614AB8 5D681B02 2A6F2B94 B40BBE37 C30C8EA1 5A05DF1B 2D02EF8D".substr(9*i,8);return~t}function T(e){return e.replace(/\s/g,"")}function k(e,t){e.classList.add(t)}function w(e,t){e.classList.remove(t)}function S(e){try{return JSON.parse(D(e))}catch(e){return{}}}function P(e,t,i,r,n){try{!n&&e.contentWindow.console.error&&(e.contentWindow.console.error=function(){});var o="iframe"==e.tagName.toLowerCase()?e.contentDocument:e;if(!o)return;o.querySelectorAll(t).forEach((function(e){P(e,t,i,r,n)})),i(o.querySelectorAll(r))}catch(e){return}}function I(e){if(!e)return null;for(var t=e.querySelector("iframe");t;)try{t=t.contentDocument.querySelector("iframe")}catch(e){break}return t}function O(e){try{return/\{\s*\[native code\]\s*\}/.test(e.toString())}catch(e){return!0}}function D(e,t){var i,r=null;try{var n=[];O(Array.prototype.toJSON)||(r=Array.prototype.toJSON,delete Array.prototype.toJSON),i=JSON.stringify(e,(function(e,t){if(null!=t&&"object"==u(t)){if(n.indexOf(t)>-1)return;n.push(t)}return t}),t)}catch(e){i=""}return null!==r&&(Array.prototype.toJSON=r),i}function C(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];e&&e.push(t,i,r,n)}function V(e){return e>1?e/100:e}function R(e){return parseInt(e)}function L(e){return e<1e3?1e3*e:e}function M(e,t){var i={cijs:"convusmp",ttype:e,cisd:"convusmp",cipid:t.get("cipid")||"",crid:t.get("creativeId")||"",dast:t.get("auc_dast")||"",cmcv:"",uv:t.get("unit_version")||"",unm:t.get("unit_type")||"",cb:Date.now(),abt:t.get("ab_test")||"",mp:t.get("modifiedPlacement")||void 0,su:t.get("subUnitType")||""};return i=Object.assign(i,function(e){var t=window.cmTag&&window.cmTag.config?window.cmTag.config:{baseReportD:"taboola.com",dataCenter:"am"};return{baseReportD:e.get("baseReportD")||t.baseReportD,dataCenter:e.get("dataCenter")||t.dataCenter}}(t)),i}function x(e){if(!1!==c.get("isFirePixel")){var t="".concat(F(e),"?");for(var i in e)void 0!==e[i]&&(t+="".concat(i,"=").concat(e[i],"&"));document.createElement("img").src=t}}function F(e){return c.get("pixelsUrl")||"//conv".concat(e.dataCenter,"mp.").concat(e.baseReportD,"/st")}function N(e){var t=e.split("."),i=t[0].split(":"),r=0,n=1;for(2===t.length&&(r+=parseInt(t[1])/1e3);i.length>0;)r+=n*parseInt(i.pop(),10),n*=60;return r}function B(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?l(Object(i),!0).forEach((function(t){d(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},o.l.PLATFORM_DETECTION.DEFAULT_PLATFORM_INFO);if(e){var r=e.get("wurfl");if(r&&"object"===u(r)){var n,a,s,c,h,p,f,v,y,m,g,_,b,A,E,T,k,w,S,P,I,O,D,C=null!==(n=null===(a=r.os)||void 0===a||null===(a=a.name)||void 0===a?void 0:a.toLowerCase())&&void 0!==n?n:o.l.PLATFORM_DETECTION.OS_NAMES.UNKNOWN,V=null!==(s=null===(c=r.os)||void 0===c?void 0:c.version)&&void 0!==s?s:null,R=null!==(h=null===(p=r.browser)||void 0===p||null===(p=p.name)||void 0===p?void 0:p.toLowerCase())&&void 0!==h?h:o.l.PLATFORM_DETECTION.BROWSER_NAMES.UNKNOWN,L=null!==(f=null===(v=r.browser)||void 0===v?void 0:v.version)&&void 0!==f?f:null,M=null!==(y=null!==(m=null===(g=r.form_factor)||void 0===g?void 0:g.toLowerCase())&&void 0!==m?m:null===(_=r.device)||void 0===_||null===(_=_.form_factor)||void 0===_?void 0:_.toLowerCase())&&void 0!==y?y:null,x=null!==(b=null===(A=r.device)||void 0===A||null===(A=A.name)||void 0===A?void 0:A.toLowerCase())&&void 0!==b?b:"";return i.os={name:null!==(E=null===(T=r.os)||void 0===T?void 0:T.name)&&void 0!==E?E:o.l.PLATFORM_DETECTION.DEFAULT_VALUES.UNKNOWN,version:V},i.browser={name:null!==(k=null===(w=r.browser)||void 0===w?void 0:w.name)&&void 0!==k?k:o.l.PLATFORM_DETECTION.DEFAULT_VALUES.UNKNOWN,version:L},i.device={name:null!==(S=null===(P=r.device)||void 0===P?void 0:P.name)&&void 0!==S?S:o.l.PLATFORM_DETECTION.DEFAULT_VALUES.UNKNOWN,type:null!==(I=null!==(O=null===(D=r.device)||void 0===D?void 0:D.type)&&void 0!==O?O:M)&&void 0!==I?I:o.l.PLATFORM_DETECTION.DEFAULT_VALUES.UNKNOWN},i.formFactor=M,i.isIOS=C===o.l.PLATFORM_DETECTION.OS_NAMES.IOS,i.isAndroid=C===o.l.PLATFORM_DETECTION.OS_NAMES.ANDROID,i.isAndroid&&(i.isAndroidWebView=function(e,t){var i=o.l.PLATFORM_DETECTION.WEBVIEW_DETECTION.FLAGS.map((function(t){var i;return null===(i=e.browser)||void 0===i?void 0:i[t]}));if(i.some((function(e){return!0===e})))return!0;if(o.l.PLATFORM_DETECTION.WEBVIEW_DETECTION.BROWSER_PATTERNS.some((function(e){return t.includes(e)})))return!0;if(t.includes(o.l.PLATFORM_DETECTION.BROWSER_NAMES.CHROME)){if(o.l.PLATFORM_DETECTION.WEBVIEW_DETECTION.ENGINE_NAMES.map((function(t){return o.l.PLATFORM_DETECTION.WEBVIEW_DETECTION.ENGINE_PATTERNS.some((function(i){var r;return null===(r=e.browser)||void 0===r||null===(r=r[t])||void 0===r?void 0:r.toLowerCase().includes(i)}))})).some((function(e){return!0===e})))return!0}if("undefined"!=typeof navigator&&navigator.userAgent){var r=navigator.userAgent;return o.l.PLATFORM_DETECTION.WEBVIEW_DETECTION.UA_PATTERNS.some((function(e){return e.test(r)}))}return!1}(r,R)),i.platform=M?function(e){var t=o.l.PLATFORM_DETECTION.FORM_FACTOR_MAPPINGS;if(t[e])return t[e];var i=o.l.PLATFORM_DETECTION.FORM_FACTOR_PATTERNS;if(i.MOBILE.some((function(t){return e.includes(t)})))return o.l.PLATFORM_DETECTION.PLATFORMS.MOBILE;if(i.TABLET.some((function(t){return e.includes(t)})))return o.l.PLATFORM_DETECTION.PLATFORMS.TABLET;if(i.DESKTOP.some((function(t){return e.includes(t)})))return o.l.PLATFORM_DETECTION.PLATFORMS.DESKTOP;return o.l.PLATFORM_DETECTION.PLATFORMS.DESKTOP}(M):function(e,t){if(e===o.l.PLATFORM_DETECTION.OS_NAMES.IOS)return t.includes(o.l.PLATFORM_DETECTION.IOS_DEVICE_PATTERNS.TABLET)?o.l.PLATFORM_DETECTION.PLATFORMS.TABLET:o.l.PLATFORM_DETECTION.PLATFORMS.MOBILE;if(e===o.l.PLATFORM_DETECTION.OS_NAMES.ANDROID){return o.l.PLATFORM_DETECTION.ANDROID_TABLET_PATTERNS.some((function(e){return t.includes(e)}))?o.l.PLATFORM_DETECTION.PLATFORMS.TABLET:o.l.PLATFORM_DETECTION.PLATFORMS.MOBILE}if(o.l.PLATFORM_DETECTION.DESKTOP_OS_PATTERNS.some((function(t){return e.includes(t)})))return o.l.PLATFORM_DETECTION.PLATFORMS.DESKTOP;return o.l.PLATFORM_DETECTION.PLATFORMS.DESKTOP}(C,x),i.isMobile=i.platform===o.l.PLATFORM_DETECTION.PLATFORMS.MOBILE,i.isTablet=i.platform===o.l.PLATFORM_DETECTION.PLATFORMS.TABLET,t?i:i.platform}}return function(e,t){var i=o.l.PLATFORM_DETECTION.PLATFORMS.DESKTOP;if("undefined"!=typeof navigator&&navigator.userAgent){var r=navigator.userAgent;o.l.PLATFORM_DETECTION.LEGACY_UA_PATTERNS.IPAD.test(r)?i=o.l.PLATFORM_DETECTION.PLATFORMS.TABLET:o.l.PLATFORM_DETECTION.LEGACY_UA_PATTERNS.MOBILE.test(r)&&!o.l.PLATFORM_DETECTION.LEGACY_UA_PATTERNS.IPAD.test(r)&&(i=o.l.PLATFORM_DETECTION.PLATFORMS.MOBILE)}if(t)return e.platform=i,e.isMobile=i===o.l.PLATFORM_DETECTION.PLATFORMS.MOBILE,e.isTablet=i===o.l.PLATFORM_DETECTION.PLATFORMS.TABLET,e;return i}(i,t)}function U(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=t.get("creatives"),a=encodeURIComponent(o.VIDEO_URL&&o.VIDEO_URL.url?o.VIDEO_URL.url:o.VIDEO_URL),s=(new Date).getTime(),l=t.get("context")||n.R.OUTSTREAM;return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/(%%|\[|\{)referrer(%%|\]|\})/gi,o.REFERRER)).replace(/(%%|\[|\{)domain(%%|\]|\})/gi,o.DOMAIN)).replace(/(%%|\[|\{)video-url(%%|\]|\})/gi,a)).replace(/(%%|\[|\{)(page-url|site_full_url)(%%|\]|\})/gi,o.PAGE_URL)).replace(/(%%|\[|\{)player-width(%%|\]|\})/gi,o.PLAYER_WIDTH)).replace(/(%%|\[|\{)player-height(%%|\]|\})/gi,o.PLAYER_HEIGHT)).replace(/(%%|\[|\{)vidlength(%%|\]|\})/gi,o.VIDLENGTH)).replace(/(%%|\[|\{)keywords(%%|\]|\})/gi,o.KEY_WORDS)).replace(/(%%|\[|\{)description(%%|\]|\})/gi,o.DESCRIPTION)).replace(/(%%|\[|\{)vertical(%%|\]|\})/gi,o.VERTICAL)).replace(/(%%|\[|\{)tag(%%|\]|\})/gi,o.TAG?o.TAG:"")).replace(/(%%|\[|\{)cirf(%%|\]|\})/gi,encodeURIComponent(decodeURIComponent(o.CIRF)))).replace(/(%%|\[|\{)cb(%%|\]|\})/gi,"R0."+s)).replace(/(%%|\[|\{)country(%%|\]|\})/gi,t.get("country"))).replace(/(%%|\[|\{)ip(%%|\]|\})/gi,t.get("ip"))).replace(/(%%|\[|\{)ua(%%|\]|\})/gi,encodeURIComponent(navigator.userAgent))).replace(/(%%|\[|\{)dast(%%|\]|\})/gi,t.get("auc_dast")||"")).replace(/(%%|\[|\{)impression_id(%%|\]|\})/gi,i.impressionId||"")).replace(/(%%|\[|\{)duration(%%|\]|\})/gi,i.adDuration||0)).replace(/(%%|\[|\{)context(%%|\]|\})/gi,l)).replace(/(%%|\[|\{)format(%%|\]|\})/gi,l===n.R.OUTSTREAM?n.R.INTEXT:n.R.INSTREAM)).replace(/%%[^%]*%%/gi,"")).replace(/(\[|\{)site(\]|\})/gi,window.TRC?window.TRC.publisherId:"")).replace(/(\[|\{)site_id(\]|\})/gi,window.TRC?window.TRC.publisherId:"")).replace(/(\[|\{)site_domain(\]|\})/gi,o.DOMAIN)).replace(/(\[|\{)thumbnail(\]|\})/gi,o.VIDEO_URL&&o.VIDEO_URL.url?o.VIDEO_URL.url:"")).replace(/(%%|\[|\{)title(%%|\]|\})/gi,o.TITLE)).replace(/(%%|\[|\{)timestamp(%%|\]|\})/gi,Math.floor(s/1e3))).replace(/(\[|\{)platform(%%|\]|\})/gi,B(t))).replace(/(\[|\{)campaign_id(\]|\})/gi,r.campaignId)).replace(/(\[|\{)campaign_item_id(\]|\})/gi,r.lineItem)).replace(/(\[|\{)request_id(\]|\})/gi,window.TRCImpl&&he(window.TRCImpl.getGlobalRequestId)?window.TRCImpl.getGlobalRequestId():"")}function W(e){for(var t,i=JSON.stringify(e),r="PlAyER",n="",o=0;o<i.length;o++)t=o%6,n+=String.fromCharCode(i[o].charCodeAt(0).toString(10)^r[t].charCodeAt(0).toString(10));try{n=btoa(n)}catch(e){return!1}return n}function j(e,t,i){if(e&&t){var r=e.document.createElement("script");r.type="text/javascript",r.innerHTML=t,r.onload=function(){i&&i()},r.onerror=function(e){i&&i(e)},(e.document.head||e.document).appendChild(r)}}function H(e){return"https:"===window.location.protocol&&e.get("scrmf")}function G(e){return btoa(unescape(encodeURIComponent(D(e)))).replace(/\//g,"_").replace(/\+/g,"-")}function q(e){if(!e)return r.A.undefinedError;try{if(e.eventData){var t=D(e.eventData),i=t.match(r.A.codesMatcher);if(i&&i[0])return parseInt(i[0]);if(t.toLowerCase().match(r.A.noAdsMatcher))return r.A.schemaValidationError;if(t.toLowerCase().match("timeout"))return r.A.timeout}}catch(e){}return r.A.undefinedError}function z(e,t){return e.match(new RegExp("".concat(t,"$")))}var Q="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function K(e){try{for(var t=e.length,i=[],r=0;r<Q.length;r++)i[Q.charCodeAt(r)]=r;var n=Q.charAt(64);if(n){var o=e.indexOf(n);-1!==o&&(t=o)}for(var a=[],s=0,l=0;l<t;l++)if(l%4){var d=i[e.charCodeAt(l-1)]<<l%4*2,u=i[e.charCodeAt(l)]>>>6-l%4*2;a[s>>>2]|=(d|u)<<24-s%4*8,s++}for(var c=[],h=0;h<s;h++){var p=a[h>>>2]>>>24-h%4*8&255;c.push(String.fromCharCode(p))}return decodeURIComponent(escape(c.join("")))}catch(e){return""}}function Y(e){return e&&c?(0===e.indexOf("http:")&&(t=e.replace("http:","https:")),0!==e.indexOf("//")||c.get("secured_protocol")||(t="https:"+e),t||e):e;var t}function X(e){if(e.isResolved)return e;var t=!0,i=!1,r=!1,n=e.then((function(e){return r=!0,t=!1,e}),(function(e){throw i=!0,t=!1,e}));return n.isFulfilled=function(){return r},n.isPending=function(){return t},n.isRejected=function(){return i},n}function J(){var e=window;try{for(;e.document!==e.top.document;)e=e.top;return e}catch(e){return window}}function Z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t={};return e.substring(e.indexOf("?")+1).split("&").forEach((function(e){var i=e.split("=");i.length>0&&(t[i[0]]=i[1]||"")})),t}function $(e){var t=parseFloat(e);return!isNaN(t)}function ee(e){return null==e}function te(e,t){return t.split("/").reduce((function(e,t){return e[t]}),e)}function ie(e,t){return ee(e)?t:e}function re(e){return"string"==typeof e&&e.search(/px$/g)>-1?e:"".concat(e,"px")}function ne(e,t){window.cmTag&&window.cmTag.utils&&window.cmTag.utils.defer?window.cmTag.utils.defer(e,t||null):e.apply(t||null)}function oe(e){try{return new URL(e),!0}catch(e){return!1}}var ae=function(e){return ee(e)||isNaN(parseInt(e))},se=function(e){if(e){for(var t={},i=0,r=Object.entries(e);i<r.length;i++){var n=a(r[i],2),o=n[0],s=n[1];t[o]=s}return t}},le=function(e,t){return e?function(){clearTimeout(i);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];i=setTimeout(t.apply(undefined,r),i)}:t;var i},de=function(e,t){return Math.floor(parseFloat(e)*t)},ue=function(e,t){for(var i in t)t.hasOwnProperty(i)&&(t[i]instanceof Object&&e[i]instanceof Object&&!(t[i]instanceof Function)?e[i]=ue(e[i],t[i]):e[i]=t[i]);return e},ce=function(e){return e.get("shouldPlayInATFWithSC")||e.get("shouldPlayInATFWithoutSC")},he=function(e){return"function"==typeof e};var pe=function(e,t){var i=new Image;i.onerror=function(){he(t)&&t()},i.src=e};function fe(e){return e?e.currentTime:0}},8029:(e,t,i)=>{"use strict";i.d(t,{l:()=>r});var r={EXPIRATION_TIME:6e4,PREDICTORS:{ADX:27,IMMEDIATE_START:29},ITEM_TYPES:{IMA:27},ABOVE_THE_FEED:{MODES:["above-the-feed-premium-card-yh-delta","above-the-feed-premium-card-fp"]},PLATFORM_DETECTION:{PLATFORMS:{DESKTOP:"Desktop",MOBILE:"Mobile",TABLET:"Tablet"},OS_NAMES:{IOS:"ios",ANDROID:"android",WINDOWS:"windows",MACOS:"macos",LINUX:"linux",UNIX:"unix",CHROME_OS:"chrome os",UNKNOWN:"unknown"},DEFAULT_PLATFORM_INFO:{platform:"Desktop",isIOS:!1,isAndroid:!1,isAndroidWebView:!1,isMobile:!1,isTablet:!1,os:null,browser:null,device:null,formFactor:null},FORM_FACTOR_MAPPINGS:{smartphone:"Mobile","mobile phone":"Mobile",tablet:"Tablet",desktop:"Desktop",laptop:"Desktop",tv:"Desktop","smart tv":"Desktop","connected tv":"Desktop"},FORM_FACTOR_PATTERNS:{MOBILE:["phone","mobile"],TABLET:["tablet","pad"],DESKTOP:["desktop","pc","laptop"]},ANDROID_TABLET_PATTERNS:["tab","pad","kindle","fire"],IOS_DEVICE_PATTERNS:{TABLET:"ipad"},DESKTOP_OS_PATTERNS:["windows","macos","linux","unix","chrome os"],BROWSER_NAMES:{CHROME:"chrome",UNKNOWN:"unknown"},DEFAULT_VALUES:{UNKNOWN:"Unknown"},WEBVIEW_DETECTION:{FLAGS:["webview","is_webview","is_app_webview","is_embedded"],BROWSER_PATTERNS:["webview","android webview","wv"],ENGINE_PATTERNS:["webview"],ENGINE_NAMES:["engine_name","layout_engine","rendering_engine"],UA_PATTERNS:[/\bwv\b/,/\bVersion\/\d+\.\d+ Chrome\/\d+.*\bMobile\b/]},LEGACY_UA_PATTERNS:{IPAD:/iPad/,MOBILE:/iPhone|iPod|Android/i}}}},8312:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r={AdLoaded:"AdLoaded",AdStarted:"AdStarted",AdStopped:"AdStopped",AdSkipped:"AdSkipped",AdSkippableStateChange:"AdSkippableStateChange",AdSizeChange:"AdSizeChange",AdLinearChange:"AdLinearChange",AdDurationChange:"AdDurationChange",AdExpandedChange:"AdExpandedChange",AdVolumeChange:"AdVolumeChange",AdImpression:"AdImpression",AdVideoStart:"AdVideoStart",AdVideoFirstQuartile:"AdVideoFirstQuartile",AdVideoMidpoint:"AdVideoMidpoint",AdVideoThirdQuartile:"AdVideoThirdQuartile",AdVideoComplete:"AdVideoComplete",AdClickThru:"AdClickThru",AdInteraction:"AdInteraction",AdUserAcceptInvitation:"AdUserAcceptInvitation",AdUserMinimize:"AdUserMinimize",AdUserClose:"AdUserClose",AdPaused:"AdPaused",AdPlaying:"AdPlaying",AdLog:"AdLog",AdError:"AdError",SoundViolation:"SoundViolation",HijackAttempt:"HijackAttempt",Progress:"Progress",BlockingTagPassback:"BlockingTagPassback",SlowConnection:"SlowConnection",OmidSessionStart:"OmidSessionStart",OmidSessionFinish:"OmidSessionFinish",TagStarted:"tagStarted",VideoBlacklisted:"VideoBlacklisted"}},9054:(e,t,i)=>{"use strict";i.d(t,{A:()=>r});const r={schemaValidationError:101,timeout:304,mediaFileNotSupported:403,undefinedError:900,generalVpaidError:901,noAdsMatcher:"no_fill|no ad|no video|no vast|nofill",codesMatcher:"101|301|302|303|304|402|900|901"}},9312:(e,t,i)=>{"use strict";i.d(t,{FD:()=>r,R:()=>a,f:()=>n,ff:()=>s,yR:()=>o});var r={BID_WON:"bidWon",NO_BID:"noBid"},n={BID_AVAILABLE_MESSAGE:"Bid available"},o={USD:"USD"},a={OUTSTREAM:"outstream",INTEXT:"intext-roll",INSTREAM:"instream"},s={TYPE:"html5",EXPIRES:90,REFRESH:28800}},9738:e=>{!function(t){e.exports=t;var i="listeners",r={on:function(e,t){return a(this,e).push(t),this},once:function(e,t){var i=this;return r.originalListener=t,a(i,e).push(r),i;function r(){o.call(i,e,r),t.apply(this,arguments)}},off:o,emit:function(e,t){var i=this,r=a(i,e,!0);if(!r)return!1;var n=arguments.length;if(1===n)r.forEach((function(e){e.call(i)}));else if(2===n)r.forEach((function(e){e.call(i,t)}));else{var o=Array.prototype.slice.call(arguments,1);r.forEach((function(e){e.apply(i,o)}))}return!!r.length}};function n(e){for(var t in r)e[t]=r[t];return e}function o(e,t){var r,n=this;if(arguments.length){if(t){if(r=a(n,e,!0)){if(!(r=r.filter((function(e){return e!==t&&e.originalListener!==t}))).length)return o.call(n,e);n[i][e]=r}}else if((r=n[i])&&(delete r[e],!Object.keys(r).length))return o.call(n)}else delete n[i];return n}function a(e,t,r){if(!r||e[i]){var n=e[i]||(e[i]={});return n[t]||(n[t]=[])}}n(t.prototype),t.mixin=n}((function e(){if(!(this instanceof e))return new e}))},9789:(e,t,i)=>{"use strict";i.d(t,{MH:()=>A,NU:()=>k,J7:()=>T});const r={tagStarted:0,tagImpression:1,emptyVast:3,mediaFileNotSupported:4,adError:5,filterVastByRegex:6,playerClosed:7,vastError:8,adErrorBeforeLoad:10,adUnitLoadFailed:12,queueTrimmed:14,globalTimeout:15,adtoTimeout:16,adSkiped:17,adloadedTimeout:18,hijackAttempt:19,idleMode:20,videoFirstQuartile:21,videoMidpoint:22,videoThirdQuartile:23,videoComplete:24,newCompletion:25,replayAd:27,maxNetworkCalls:39,adPlaying:40,adLoaded:41,startAd:42,globalAdTimeout:53,adUnmuted:58,unloadPage:60,adDropped:61,unfriendlyVideo:83,firstImpression:99,soundOnHover:123,omidDetected:136,prebidNoBids:143,prebidBidWon:144,prebidBelowBid:147,prebidEmptyResponse:148,validPrebidResponse:149,prebidMissingPrice:169,earlyAdImpression:170,adImpressionTimeout:173,adStarted:187,adVideoStart:188,heavyFilesBlocked:192,pubVideoPreventing:197,unitFetcherWfDemand:202,liteUnitWfDemand:203,maxNumberOfWrappers:204,adxAdRequest:205,impressionPixelFired:206,prebidHandlerNotSupported:207,prebidAboveThreshold:208,prebidBlockedAdvReturned:211,stoppedAfterTermination:212,blockedVerticalDeamnd:213,wfSuccess:215,droppedByType:216,droppedOnAMP:217,droppedOniOSAutoplayRestriction:218,droppedOnLineItemIgnore:219,droppedOnBackfillDelay:220,droppedByLowDownlink:221,delayedItemByType:222,delayedItemByBackfill:223,createVpaidWrapper:224};var n=i(9054),o=i(2635),a=i(7886);function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function l(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,d(r.key),r)}}function d(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}var u,c,h=function(){return e=function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parameters=t,this.store=i,this._initOppsAggregator()},t=[{key:"_initOppsAggregator",value:function(){this.oppsAggregator=this.store.get("oppsula"),(0,a.Tn)(this.oppsAggregator.setSource)&&this.oppsAggregator.setSource("player",this.store)}},{key:"send",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(e&&!this.store.get("isFireOppBlocked")){r.mp=e.modifiedPlacement,r.su=this._getSubUnitType(e),r.ms=this._getIntentIQMatchingSource(e);var n={tagItem:e,playerDAST:i,extraData:r||{},playerParams:this.parameters};this.oppsAggregator.send("player",t,n)}}},{key:"_isStickyDisabled",value:function(){return 6!==this.store.get("subUnitType")||!this.store.get("enableStickyOnNonAllowSlider")}},{key:"_getIntentIQMatchingSource",value:function(e){return e.intentIQ?3:void 0}},{key:"_getSubUnitType",value:function(e){return 6===this.store.get("subUnitType")&&this._isStickyDisabled()||this.store.get("isSliderCutOff")&&!e.alwsldr?0:this.store.get("subUnitType")}},{key:"_addCmTagParams",value:function(e){var t=this.store.get("oppsQS")||{};Object.assign(e,t)}},{key:"_addDelayedParams",value:function(e,t){var i=this._delayedParams(t)||{};Object.assign(e,i)}},{key:"_addExtraParams",value:function(e,t){for(var i in e)"vidCurrentTime"!==i&&(t[i]=e[i])}},{key:"_isQuartileOpportunity",value:function(e){return e>=21&&e<=25}},{key:"_flattenParams",value:function(e){return e.map((function(e){return"".concat(e.key,"=").concat(e.value)}))}},{key:"_delayedParams",value:function(e){return{"auc-dast":this.store.get("auc_dast")||void 0,sts:this.parameters.STS,wp:this.parameters.WP,vpd:e.pubId||this.parameters.VPD,vptd:e.tagId||this.parameters.VPTD,vmt:(e.isRon?1:0)||this.parameters.VMT||0,pv:this.store.get("player_version")||999,pt:(0,a.QR)(this.store.get("ab_test")||999),w:(0,a.Xg)(this.store.get("width")).toString(),h:(0,a.Xg)(this.store.get("height")).toString(),rv:e.requiredViewability}}},{key:"destroy",value:function(){this.store=this.oppsAggregator=void 0}}],t&&l(e.prototype,t),i&&l(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}(),p=i(7628),f=i(8312);function v(e){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v(e)}function y(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return m(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?m(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function g(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function _(e,t,i){return(t=b(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function b(e){var t=function(e,t){if("object"!=v(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==v(t)?t:t+""}var A=(_(_(_(_(_(_(_(_(_(_(u={},f.A.TagStarted,f.A.TagStarted),f.A.AdImpression,f.A.AdImpression),f.A.AdLoaded,f.A.AdLoaded),f.A.AdVideoFirstQuartile,f.A.AdVideoFirstQuartile),f.A.AdVideoMidpoint,f.A.AdVideoMidpoint),f.A.AdVideoThirdQuartile,f.A.AdVideoThirdQuartile),f.A.AdVideoComplete,f.A.AdVideoComplete),"SOUND_ON_HOVER","soundOnHover"),"UNLOAD_PAGE","unloadPage"),"UNIT_FETCHER_DEMAND","unitFetcherDemand"),_(_(_(_(_(_(_(_(_(_(u,"LITE_UNIT_DEMAND","liteUnitDemand"),"ADX_REQUEST","adxRequest"),"START_AD","startAd"),"REPLAY_AD","replayAd"),"TB_COMPLETION","tbCompletion"),"AD_VIDEO_START","adVideoStart"),"AD_STARTED","adStarted"),"EARLY_AD_IMPRESSION","earlyAdImpression"),"NON_FRIENDLY_VIDEO","nonFriendlyVideo"),"AD_PLAYING","adPlaying"),_(_(_(_(_(_(_(_(_(_(u,"AD_UNMUTED","adUnmuted"),"OMID_DETECTED","OMIDDetected"),"FIRST_SESSION_IMPRESSION","firstSessionImpression"),"AD_IMPRESSION_TIMEOUT","adImpressionTimeout"),"PUB_VIDEO_PREVENTING","pubVideoPreventing"),"HIJACK_ATTEMPT","hijackAttempt"),"MAX_NETWORK_CALLS","maxNetworkCalls"),"AD_LOADED_TIMEOUT","adLoadedTimeout"),"AD_TIMEOUT","adTimeout"),"GLOBAL_TIMEOUT","globalTimeout"),_(_(_(_(_(_(_(_(_(_(u,"AD_UNIT_LOAD_FAILED","adUnitLoadFailed"),"GLOBAL_AD_TIMEOUT","globalAdTimeout"),f.A.AdError,f.A.AdError),"AD_ERROR_BEFORE_LOAD","adErrorBeforeLoad"),"AD_SKIPPED","adSkipped"),"MEDIA_FILE_NOT_SUPPORTED","mediaFileNotSupported"),"FILTER_VAST_BY_REGEX","filterVASTByRegex"),"MAX_WRAPPERS","maxWrappers"),"EMPTY_VAST","emptyVAST"),"HEAVY_ADS_BLOCK","heavyAdsBlock"),_(_(_(_(_(_(_(_(_(_(u,"VAST_WRAPPER_ERROR","VASTWrapperError"),"VAST_ERROR","VASTError"),"AD_DROPPED","adDropped"),"PLAYER_CLOSED","playerClosed"),"QUEUE_EXPIRED","queueExpired"),"QUEUE_TRIMMED","queueTrimmed"),"IMPRESSION_PIXEL_FIRED","impressionPixelFired"),"PREBID_NO_BID","prebidNoBid"),"PREBID_BID_WON","prebidBidWon"),"PREBID_EMPTY_RESPONSE","prebidEmptyResponse"),_(_(_(_(_(_(_(_(_(_(u,"PREBID_MISSING_PRICE","prebidMissingPrice"),"PREBID_HANDLER_NOT_SUPPORTED","prebidHandlerNotSupported"),"PREBID_CPM_BELOW_FLOOR","prebidCPMBelowFloor"),"PREBID_CPM_ABOVE_THRESHOLD","prebidCPMAboveThreshold"),"PREBID_BID_VALID","prebidValidResponse"),"PREBID_BLOCKED_ADV_RETURNED","prebidBlockedAdvertiserReturned"),"STOPPED_AFTER_TERMINATION","stoppedAfterTermination"),"WF_SUCCESS","wfSuccess"),"DROPPED_BY_TYPE","droppedByType"),"DROPPED_ON_AMP","droppedOnAMP"),_(_(_(_(_(_(_(_(u,"DROPPED_ON_IOS_AUTOPLAY_RESTRICTION","droppedOniOSAutoplayRestriction"),"DROPPED_ON_LINE_ITEM_IGNORE","droppedOnLineItemIgnore"),"DROPPED_ON_BACKFILL_DELAY","droppedOnBackfillDelay"),"DROPPED_BY_LOW_DOWNLINK","droppedByLowDownlink"),"DELAYED_ITEM_BY_TYPE","delayedItemByType"),"DELAYED_ITEM_BY_BACKFILL","delayedItemByBackfill"),"CREATE_VPAID_WRAPPER","createVpaidWrapper"),"BLOCKED_VERTICAL_DEMAND","blockedVerticalDemand")),E=(_(_(_(_(_(_(_(_(_(_(c={},f.A.TagStarted,{opp:r.tagStarted}),f.A.AdImpression,{opp:r.tagImpression}),f.A.AdLoaded,{opp:r.adLoaded}),f.A.AdVideoFirstQuartile,{opp:r.videoFirstQuartile,isQuartile:!0}),f.A.AdVideoMidpoint,{opp:r.videoMidpoint,isQuartile:!0}),f.A.AdVideoThirdQuartile,{opp:r.videoThirdQuartile,isQuartile:!0}),f.A.AdVideoComplete,{opp:r.videoComplete,isQuartile:!0}),A.SOUND_ON_HOVER,{opp:r.soundOnHover}),A.UNLOAD_PAGE,{opp:r.unloadPage}),A.UNIT_FETCHER_DEMAND,{opp:r.unitFetcherWfDemand}),_(_(_(_(_(_(_(_(_(_(c,A.LITE_UNIT_DEMAND,{opp:r.liteUnitWfDemand}),A.ADX_REQUEST,{opp:r.adxAdRequest}),A.START_AD,{opp:r.startAd}),A.REPLAY_AD,{opp:r.replayAd,sendOnce:!1}),A.TB_COMPLETION,{opp:r.newCompletion}),A.AD_VIDEO_START,{opp:r.adVideoStart}),A.AD_STARTED,{opp:r.adStarted}),A.EARLY_AD_IMPRESSION,{opp:r.earlyAdImpression}),A.NON_FRIENDLY_VIDEO,{opp:r.unfriendlyVideo}),A.AD_PLAYING,{opp:r.adPlaying}),_(_(_(_(_(_(_(_(_(_(c,A.AD_UNMUTED,{opp:r.adUnmuted,checkIsEnabled:!0}),A.OMID_DETECTED,{opp:r.omidDetected}),A.FIRST_SESSION_IMPRESSION,{opp:r.firstImpression}),A.AD_IMPRESSION_TIMEOUT,{opp:r.adImpressionTimeout}),A.PUB_VIDEO_PREVENTING,{opp:r.pubVideoPreventing}),A.HIJACK_ATTEMPT,{opp:r.hijackAttempt}),A.MAX_NETWORK_CALLS,{opp:r.maxNetworkCalls}),A.AD_LOADED_TIMEOUT,{opp:r.adloadedTimeout}),A.AD_TIMEOUT,{opp:r.adtoTimeout}),A.GLOBAL_TIMEOUT,{opp:r.globalTimeout}),_(_(_(_(_(_(_(_(_(_(c,A.AD_UNIT_LOAD_FAILED,{opp:r.adUnitLoadFailed}),A.GLOBAL_AD_TIMEOUT,{opp:r.globalAdTimeout}),f.A.AdError,{opp:r.adError}),A.AD_ERROR_BEFORE_LOAD,{opp:r.adErrorBeforeLoad}),A.AD_SKIPPED,{opp:r.adSkiped}),A.MEDIA_FILE_NOT_SUPPORTED,{opp:r.mediaFileNotSupported}),A.FILTER_VAST_BY_REGEX,{opp:r.filterVastByRegex}),A.MAX_WRAPPERS,{opp:r.maxNumberOfWrappers}),A.EMPTY_VAST,{opp:r.emptyVast}),A.HEAVY_ADS_BLOCK,{opp:r.heavyFilesBlocked}),_(_(_(_(_(_(_(_(_(_(c,A.VAST_WRAPPER_ERROR,{opp:r.vastWrapperError}),A.VAST_ERROR,{opp:r.vastError}),A.AD_DROPPED,{opp:r.adDropped}),A.PLAYER_CLOSED,{opp:r.playerClosed}),A.QUEUE_TRIMMED,{opp:r.queueTrimmed}),A.IMPRESSION_PIXEL_FIRED,{opp:r.impressionPixelFired}),A.PREBID_NO_BID,{opp:r.prebidNoBids}),A.PREBID_BID_WON,{opp:r.prebidBidWon}),A.PREBID_BID_VALID,{opp:r.validPrebidResponse}),A.PREBID_EMPTY_RESPONSE,{opp:r.prebidEmptyResponse}),_(_(_(_(_(_(_(_(_(_(c,A.PREBID_MISSING_PRICE,{opp:r.prebidMissingPrice}),A.PREBID_HANDLER_NOT_SUPPORTED,{opp:r.prebidHandlerNotSupported}),A.PREBID_CPM_BELOW_FLOOR,{opp:r.prebidBelowBid}),A.PREBID_CPM_ABOVE_THRESHOLD,{opp:r.prebidAboveThreshold}),A.PREBID_BLOCKED_ADV_RETURNED,{opp:r.prebidBlockedAdvReturned}),A.STOPPED_AFTER_TERMINATION,{opp:r.stoppedAfterTermination}),A.WF_SUCCESS,{opp:r.wfSuccess}),A.DROPPED_BY_TYPE,{opp:r.droppedByType}),A.DROPPED_ON_AMP,{opp:r.droppedOnAMP}),A.DROPPED_ON_IOS_AUTOPLAY_RESTRICTION,{opp:r.droppedOniOSAutoplayRestriction}),_(_(_(_(_(_(_(c,A.DROPPED_ON_LINE_ITEM_IGNORE,{opp:r.droppedOnLineItemIgnore}),A.DROPPED_ON_BACKFILL_DELAY,{opp:r.droppedOnBackfillDelay}),A.DROPPED_BY_LOW_DOWNLINK,{opp:r.droppedByLowDownlink}),A.DELAYED_ITEM_BY_TYPE,{opp:r.delayedItemByType}),A.DELAYED_ITEM_BY_BACKFILL,{opp:r.delayedItemByBackfill}),A.CREATE_VPAID_WRAPPER,{opp:r.createVpaidWrapper}),A.BLOCKED_VERTICAL_DEMAND,{opp:r.blockedVerticalDeamnd})),T={AD_IMPRESSION:"adImpression",SET_KEY:"setKey",ADD_WRAPPER:"addWrapper",GET_WRAPPER:"getWrapper"},k=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t.store,this.tag=t.tag,this.oppsManager=new h({CM_DOMAIN:t.creatives.CM_DOMAIN,AUC_DAST:t.creatives.AUC_DAST,sequenceId:this.tag.sequenceId,ST:t.creatives.ST,STS:t.creatives.STS,SDID:t.creatives.SDID,PT:t.creatives.PT,PV:t.creatives.PV,WP:t.creatives.WP,VPD:t.creatives.PUBID,VPTD:t.creatives.TAGID,VMT:t.creatives.VMT},this.store),this.addIABErrorCode=this.store.get("erronopp"),this.unitVersion=this.store.get("unit_version"),this.paused=!1,this.events=[],this.delayedQuartileEvents=[],this.externalDelayedEvents=this.store.get("externalDelayedEvents")||[],this.tracker=new o.A("AdEvents [VpaidWrapper ".concat(t.index,"]")),this.playerDAST=new p.A(this.store)},t=[{key:"destroy",value:function(){var e,t;this.stopped=this.paused=!0,null===(e=this.oppsManager)||void 0===e||e.destroy(),null===(t=this.playerDAST)||void 0===t||t.destroy(),this.store=this.tag=this.oppsManager=this.trackingPixelManager=this.events=this.delayedQuartileEvents=this.tracker=this.playerDAST=this.externalDelayedEvents=void 0}},{key:"onEvent",value:function(e,t){if(!this.stopped&&!this.paused&&E[e]){this._isAdErrorBeforeAdLoaded(e)&&(e=A.AD_ERROR_BEFORE_LOAD);var i=E[e],r=i.opp,n=i.sendOnce,o=void 0===n||n,s=i.isQuartile,l=void 0!==s&&s,d=i.checkIsEnabled,u=void 0!==d&&d;if((0,a.hX)(r))this.tracker.warn("Handling event ".concat(e," without opp id"));else{if(this.tracker.info("Handling event ".concat(e," with opp id '").concat(r)),this._shouldDelayQuartileEvent(l))return void this.delayedQuartileEvents.push(e);if(this._isOppDisabled(u,r))return;if(e===A.FIRST_SESSION_IMPRESSION){if(!this.store.get("isFirstImpression"))return;this.store.set("isFirstImpression",!1)}var c=this._getEventData(e,t);o?this._sendOppOnce(e,r,c):this._sendOpp(r,c)}this.events.push(e)}}},{key:"_isAdErrorBeforeAdLoaded",value:function(e){return e===f.A.AdError&&!this.isEventFired(f.A.AdLoaded)}},{key:"_shouldDelayQuartileEvent",value:function(e){return e&&!this.hadImpression}},{key:"_isOppDisabled",value:function(e,t){return e&&!this.store.get("enblopp.".concat(t))}},{key:"_sendOppOnce",value:function(e,t,i){this.isEventFired(e)||this._sendOpp(t,i)}},{key:"_sendOpp",value:function(e,t){this.oppsManager.send(this.tag,e,this.getFromPlayerDAST(),t)}},{key:"_getEventData",value:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={prdid:this.predictorId,vidCurrentTime:(0,a.vZ)(null===(t=i.adView)||void 0===t?void 0:t.videoTag),unv:this.unitVersion,uv:this.unitVersion,vdr:null==i?void 0:i.vdr};if(this.tag.modifiedPlacement&&(r.mp=this.tag.modifiedPlacement),this.tag.prebidPrice&&(r.cisbp=btoa(this.tag.prebidPrice),r.rp=this.tag.prebidPrice),this.tag.dspCreativeId&&(r.dspcrid=this.tag.dspCreativeId),this.addIABErrorCode)switch(e){case f.A.AdError:case A.AD_ERROR_BEFORE_LOAD:r.sdid=(0,a.Ok)(i);break;case A.AD_UNIT_LOAD_FAILED:case A.AD_LOADED_TIMEOUT:case A.AD_TIMEOUT:case A.GLOBAL_TIMEOUT:r.sdid=n.A.timeout;break;case A.EMPTY_VAST:r.sdid=n.A.schemaValidationError;break;case A.MEDIA_FILE_NOT_SUPPORTED:r.sdid=n.A.mediaFileNotSupported;break;case f.A.AdImpression:i.buffer>0&&(r.bis=i.buffer);break;case A.OMID_DETECTED:r.vendor=i.vendor}return r}},{key:"pause",value:function(){this.paused=!0}},{key:"resume",value:function(){this.paused=!1}},{key:"isEventFired",value:function(e){return this.events.indexOf(e)>-1}},{key:"sendDelayedQuartileOpps",value:function(){var e,t=y(this.delayedQuartileEvents);try{for(t.s();!(e=t.n()).done;){var i=e.value;this.onEvent(i)}}catch(e){t.e(e)}finally{t.f()}}},{key:"updatePlayerDAST",value:function(e,t){e===T.AD_IMPRESSION&&this.playerDAST.onImpression(t.videoUrl,t.videoEl),e===T.SET_KEY&&this.playerDAST.set(t),e===T.ADD_WRAPPER&&this.playerDAST.addWrapper(t)}},{key:"getFromPlayerDAST",value:function(e){return e===T.GET_WRAPPER?this.playerDAST.getWrappers():e?this.playerDAST.getByKey(e):this.playerDAST.get()}},{key:"firePixel",value:function(e,t,i){var r,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.stopped||this.paused)return!1;if(!n){if(this._isVideoCompletionInvalid(e)||this._isImpressionDuplicated(e))return!0;if(this.shouldDelayEvent(e,i))return!1;if(this._shouldDelayFirstPause(e,i))return this.ignoredFirstAdPausedPixel=!0,!0}return e===f.A.AdImpression&&this.onEvent(A.IMPRESSION_PIXEL_FIRED),null===(r=this.trackingPixelManager)||void 0===r?void 0:r.firePixel(e,t)}},{key:"_isVideoCompletionInvalid",value:function(e){return e===f.A.AdVideoComplete&&!this.hadImpression}},{key:"_isImpressionDuplicated",value:function(e){return e===f.A.AdImpression&&this.hadImpression}},{key:"shouldDelayEvent",value:function(e,t){return this.externalDelayedEvents.indexOf(e)>-1&&t}},{key:"_shouldDelayFirstPause",value:function(e,t){return e===f.A.AdPaused&&!this.ignoredFirstAdPausedPixel&&t}},{key:"oppsManager",get:function(){return this._oppsManager},set:function(e){this._oppsManager=e}},{key:"trackingPixelManager",get:function(){return this._trackingPixelManager},set:function(e){this._trackingPixelManager=e}},{key:"predictorId",get:function(){return this._predictorId},set:function(e){this._predictorId=e}},{key:"hadImpression",get:function(){return this._hadImpression},set:function(e){this._hadImpression=e}},{key:"playerDAST",get:function(){return this._playerDAST},set:function(e){this._playerDAST=e}}],t&&g(e.prototype,t),i&&g(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}()}},r={};function n(e){var t=r[e];if(void 0!==t)return t.exports;var o=r[e]={id:e,exports:{}};return i[e](o,o.exports,n),o.exports}n.m=i,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,i)=>(n.f[i](e,t),t)),[])),n.u=e=>({57:"TBcadent_aperture_mxPrebidHandler",124:"TBPrebidHookHandler",261:"TBbeachfrontPrebidHandler",281:"TBrubiconPrebidHandler",413:"TBopenxPrebidHandler",451:"TBPrebidHandler",466:"TBpulsepointPrebidHandler",480:"TBpubmaticPrebidHandler",564:"TBsmartPrebidHandler",586:"TBfreewheelsspPrebidHandler",611:"TBsonobiPrebidHandler",683:"TBamxPrebidHandler",748:"TBIIQPrebidHandler",904:"TBmedianetPrebidHandler",974:"TBunrulyPrebidHandler"}[e]+".js"),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),e={},t="DPlayer:",n.l=(i,r,o,a)=>{if(e[i])e[i].push(r);else{var s,l;if(void 0!==o)for(var d=document.getElementsByTagName("script"),u=0;u<d.length;u++){var c=d[u];if(c.getAttribute("src")==i||c.getAttribute("data-webpack")==t+o){s=c;break}}s||(l=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+o),s.src=i,0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous")),e[i]=[r];var h=(t,r)=>{s.onerror=s.onload=null,clearTimeout(p);var n=e[i];if(delete e[i],s.parentNode&&s.parentNode.removeChild(s),n&&n.forEach((e=>e(r))),t)return t(r)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),l&&document.head.appendChild(s)}},n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="https://vidstat.taboola.com/vpaid/vPlayer/player/v17.8.7/",(()=>{var e={152:0};n.f.j=(t,i)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var o=new Promise(((i,n)=>r=e[t]=[i,n]));i.push(r[2]=o);var a=n.p+n.u(t),s=new Error;n.l(a,(i=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,r[1](s)}}),"chunk-"+t,t)}};var t=(t,i)=>{var r,o,[a,s,l]=i,d=0;if(a.some((t=>0!==e[t]))){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(l)l(n)}for(t&&t(i);d<a.length;d++)o=a[d],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0},i=self.webpackJsonpCMPlayer=self.webpackJsonpCMPlayer||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})(),n.nc=void 0,(()=>{"use strict";var e={};n.r(e),n.d(e,{loadIIQPrebidHandler:()=>yn,loadPrebidHandler:()=>vn,loadPrebidHookHandler:()=>mn,loadamxPrebidHandler:()=>On,loadbeachfrontPrebidHandler:()=>kn,loadcadent_aperture_mxPrebidHandler:()=>Sn,loadfreewheelsspPrebidHandler:()=>Tn,loadmedianetPrebidHandler:()=>Pn,loadopenxPrebidHandler:()=>_n,loadpubmaticPrebidHandler:()=>En,loadpulsepointPrebidHandler:()=>In,loadrubiconPrebidHandler:()=>bn,loadsmartPrebidHandler:()=>An,loadsonobiPrebidHandler:()=>wn,loadunrulyPrebidHandler:()=>gn});var t=n(5072),i=n.n(t),r=n(7825),o=n.n(r),a=n(7659),s=n.n(a),l=n(5056),d=n.n(l),u=n(540),c=n.n(u),h=n(1113),p=n.n(h),f=n(4900),v={};v.styleTagTransform=p(),v.setAttributes=d(),v.insert=s().bind(null,"head"),v.domAPI=o(),v.insertStyleElement=c();i()(f.A,v);f.A&&f.A.locals&&f.A.locals;var y=n(2635),m=n(7886);function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function _(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,b(r.key),r)}}function b(e){var t=function(e,t){if("object"!=g(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==g(t)?t:t+""}var A=function(){return e=function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.id="".concat(Date.now(),"_").concat((0,m.DA)(20)),this.index=i,this.store=t,this.vpaidsCount=0,this.reportedVpaidsCount=0,this.success=0,this.fails=0,this.isSuccessed=!1},(t=[{key:"increaseVpaidsCount",value:function(){this.vpaidsCount++}},{key:"increaseSuccess",value:function(){this.success++,this._update()}},{key:"increaseFailure",value:function(){this.fails++,this._update()}},{key:"_update",value:function(){this.reportedVpaidsCount++,this.isSuccessed||(1===this.success?(this.store.incr("waterfallSuccessesInARow"),this.store.set("waterfallFailsInARow",0),this.isSuccessed=!0):this.reportedVpaidsCount===this.vpaidsCount&&(this.store.incr("waterfallFailsInARow"),this.store.set("waterfallSuccessesInARow",0)))}},{key:"getData",value:function(){return{id:this.id,index:this.index,allVpaidsReported:this.vpaidsCount===this.reportedVpaidsCount,wf_sr:this.store.get("waterfallSuccessesInARow"),wf_fr:this.store.get("waterfallFailsInARow")}}}])&&_(e.prototype,t),i&&_(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}(),E=n(4135);const T=3,k=4,w=5,S=6,P=7,I=8,O=13,D=14;var C=n(8029),V=n(9789);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function L(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,x(r.key),r)}}function M(e,t,i){return(t=x(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function x(e){var t=function(e,t){if("object"!=R(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=R(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==R(t)?t:t+""}var F="entire_session",N="adx_demand_in_queue",B="adx_demand_in_session",U=function(){return e=function e(t,i){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),M(this,"_isIMATag",(function(e){return e.t===C.l.ITEM_TYPES.IMA})),this.store=t,this.config=i,this.waterfallIndex=-1;var n=this.store.get("waterfallFailsInARow");this.store.multiSet({waterfallFailsInARow:n||0,waterfallSuccessesInARow:0,wfsrc:"player"}),this.encryptWaterfallResponse=this.store.get("encwfrs"),this.requiredViewabilityFactor=this.store.get("rvfctr"),this.defaultTagPrice=this.store.get("dftgprc"),this.fireWaterfallErrorPixels=(0,m.ri)(parseInt(this.store.get("frwferrpxls"))),this.updateCMPData=this.store.get("sndgdprprmswf")&&this.store.get("updtcmpbfrwf"),this.lastRun=this.store.get("ltuntwflstrn");var o=this.store.get("drpbletps")||[],a=this.store.get("adTypesToDrop")||[];this.adsToDrop={};for(var s=0;s<o.length;s++)this.adsToDrop[o[s]]=a.indexOf(o[s])>-1;this.creatives={},this.debugTracker=new y.A("WaterfallManager"),this.staticWf=this.store.get("static_schedule"),this.shouldRun=function(){return!r._isTbWfResponseExists()},this._runBindedWaterfallTicker=this._runWaterfallTicker.bind(this),this._roundTripAverageDuration=0,this._roundTripsCount=0,this._initDynamicWfsValues(),this.store.get("wf_manual")||this.startNextWfTimeout(),this.store.on("stop",this._stop.bind(this)),this.store.on("pausePlayer",this._stop.bind(this)),this.store.on("queueStatusChanged",this._onQueueStatusChanged.bind(this)),this.store.get("wf_dynmc_ps")&&(this.store.on("contentPaused",this._stop.bind(this)),this.store.on("contentResumed",this.startNextWfTimeout.bind(this))),this.isFirstRun=!0,this.lineitemMaxFails=this.store.get("mxlifls"),this._registerQueueEvent(),this.maxAllowedEmptyWaterfalls=this.store.get("mxemptwf");var l=this.store.get("emptyWaterfallsInARow");this.store.set("emptyWaterfallsInARow",l||0),this.store.on("startWf",(function(e){r.store.set("dlywf",!1),r.runWaterfall("startWf",e)})),this.store.on("stopWf",(function(){r.store.set("dlywf",!0)})),this.wfParamsFromUnit={},this.isWaitUntilContainerInView=this.store.get("wtuntlcntrinvw"),this.containerElement=this.isWaitUntilContainerInView&&this.store.get("cntrelm")&&document.querySelector(this.store.get("cntrelm")),this.pixelsBeforeEligibility=this.store.get("pixelsBeforeEligibility"),this._initAdxBlock()},t=[{key:"_initAdxBlock",value:function(){this.adxBlock=this.store.get("adxblck"),this.adxDemandSupported=this.store.get("shouldLoadAdxScript"),this.enableAdxBlocking=this.adxDemandSupported&&this.adxBlock.isActive&&this.adxBlock.advIds.length>0,this.gotAdxDemandInSession=!1}},{key:"handleLiteUnitWfResponse",value:function(){var e=this.store.get("ltuntWfRes");e&&this._handleWaterfallSuccess(e)}},{key:"_shouldDelayWaterfall",value:function(){return this.store.get("dlywf")}},{key:"_isContainerOutOfView",value:function(){if(this.isWaitUntilContainerInView&&this.containerElement){var e=this.containerElement.getBoundingClientRect();return e&&0===e.height&&0===e.width}return!1}},{key:"startNextWfTimeout",value:function(){var e=this;this.wfInterval&&clearTimeout(this.wfInterval),this._calcDynamicWfsValues(),this._delayBetweenWfs>0?this.wfInterval=setTimeout((function(){e._runBindedWaterfallTicker()}),this._delayBetweenWfs):this.store.emit("closePlayer")}},{key:"_initDynamicWfsValues",value:function(){this.maxTimeBetweenWaterfalls=this.store.get("mxtmbtwfs"),this.minTimeBetweenWaterfalls=this.store.get("mntmbtwfs"),this.defaultTimeBetweenWaterfalls=this.store.get("time_between_waterfall"),this.timeBetweenWfFunc=this.store.get("tmbtwfs"),(0,m.Tn)(this.timeBetweenWfFunc)||(this.timeBetweenWfFunc=void 0),this.minTimeBetweenWfFunc=this.store.get("mntmbtwfsf"),(0,m.Tn)(this.minTimeBetweenWfFunc)||(this.minTimeBetweenWfFunc=void 0),this.defaultMinTimeBetweenWf=this.store.get("mintimwf")||5e3,this.store.multiSet({"dynamicWf.lastDelayBetweenWfs":-1,"dynamicWf.currentDelayBetweenWfs":-1}),this._calcDynamicWfsValues()}},{key:"_calcDynamicWfsValues",value:function(){this._delayBetweenWfs=1e3*this._calcDelayBetweenWf(),this._delayBetweenWfs>0&&(this._minTimeBetweenWf=this._calcMinDelayBetweenWfs()),this._saveDynamicWfsValues()}},{key:"_calcDelayBetweenWf",value:function(){var e=-1;if(this.timeBetweenWfFunc)try{e=this.timeBetweenWfFunc(this.store.get("waterfallSuccessesInARow"),this.store.get("waterfallFailsInARow"),this.store,!document.hidden)}catch(t){e=this.defaultTimeBetweenWaterfalls}return e>this.maxTimeBetweenWaterfalls?e=-1:e<this.minTimeBetweenWaterfalls&&(e=this.minTimeBetweenWaterfalls),e}},{key:"_calcMinDelayBetweenWfs",value:function(){var e=this.defaultMinTimeBetweenWf;if(this.minTimeBetweenWfFunc)try{e=this.minTimeBetweenWfFunc(this.store.get("waterfallSuccessesInARow"),this.store.get("waterfallFailsInARow"),this.store,!document.hidden)}catch(t){e=this.defaultMinTimeBetweenWf}return e}},{key:"_saveDynamicWfsValues",value:function(){this.store.multiSet({"dynamicWf.lastDelayBetweenWfs":this.store.get("dynamicWf.currentDelayBetweenWfs"),"dynamicWf.currentDelayBetweenWfs":this._delayBetweenWfs})}},{key:"_registerQueueEvent",value:function(){var e=this;this.store.get("run_wf_when_empty")&&this.store.on("playFromEmptyQueue",(function(t){e.runWaterfall("queueEmpty",t)}))}},{key:"_isInIdleMode",value:function(){return this.store.get("isIdleMode")}},{key:"_runWaterfallTicker",value:function(){this.startNextWfTimeout(),this.runWaterfall("interval")}},{key:"init",value:function(e,t){this.creatives=e,this.store.set("creatives",e),this.adParams=t,this._loadWaterfallGenerator()}},{key:"_loadWaterfallGenerator",value:function(){var e=this._getWfGenerator();this.wfGenerator=new e(this.store,this.creatives),this.store.set("waterfallIndex",this.wfGenerator.getWfCounter()),this._shouldRunWaterfallOnInit()&&this.runWaterfall("run_wf_on_init")}},{key:"_getWfGenerator",value:function(){var e=this.store.get("auc_dast");if(window.TRC&&window.TRC["wf-generator"]&&window.TRC["wf-generator"].instances&&window.TRC["wf-generator"].instances[e])return window.TRC["wf-generator"].instances[e]}},{key:"_shouldRunWaterfallOnInit",value:function(){return this.store.get("run_wf_on_init")}},{key:"_serveStaticWf",value:function(){this._getRollType();var e=0;"mid-roll"==this.currentRollType?e=1:"post-roll"==this.currentRollType&&(e=2);var t=new Function("try { return "+this.staticWf[e].ad_parameters+";} catch(e){}")();this._handleWaterfallSuccess((0,m.As)(t.waterfall))}},{key:"runWaterfall",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(i&&(0,m.jr)((0,m.TF)(E.A.forceWf,this.store)),this.wfGenerator||this.staticWf){if(!i){if(this.passedMaxEmptyWaterfalls())return;if(this.store.get("first_look"))return;if((0,m.Tn)(this.shouldRun)&&!this.shouldRun())return;if(this._shouldDelayWaterfall())return;if(this._isInIdleMode())return;if(this._isContainerOutOfView())return}var r=this,n=(new Date).getTime();if(!((this.lastRun?n-this.lastRun:this._minTimeBetweenWf)<this._minTimeBetweenWf)||i)if(this.lastRun=n,this.staticWf)setTimeout((function(){t._serveStaticWf()}),20);else if(this._onTbWfResponseSuccess())(0,m.Q_)("player_waterfall","firstWfFromTb",{type:"debug",message:"firstWfFromTb",fullPageUrl:this.store.get("fullPageUrl"),player_id:this.store.get("player_id")},this.store);else{var o=!0===this.store.get("pstflrs");this.lastRun=n,this.waterfallIndex=this.wfGenerator.getWfCounter();var a=function(e,t){r._handleWaterfallError(e,t)},s=function(e,t,i){r._handleWaterfallSuccess(e,i)},l=this.wfGenerator.generateUrl({roll:this._getRollType(),pubid:this.pubid,tagid:this.tagid,isFirstRun:this.isFirstRun,unitWfParams:this.wfParamsFromUnit,ioovp:this._isOutOfViewPort(),distance:this.store.get("distancePixelPredictData.actualPredictionPoint")});if(l){if(this.adParams&&this.adParams.waterfall)window.setTimeout(this._handleWaterfallSuccess.bind(this,(0,m.As)(this.adParams.waterfall)),0);else{if(!o)return this.wfGenerator.send({wfUrl:l,postData:"",onSuccess:s,onFail:a,timeout:this.store.get("wfTimeout")}),this.wfGenerator.increaseWfCounter(),this.store.set("waterfallIndex",this.wfGenerator.getWfCounter()),void(this.isFirstRun&&(this.isFirstRun=!1));var d=(0,m.As)(this.wfGenerator.generatePOSTParams({queueStatus:this.queueStatus,droppedAdTypes:this._getAdTypesToDrop()}));this.wfGenerator.send({wfUrl:l,postData:d,onSuccess:s,onFail:a,timeout:this.store.get("wfTimeout")}),this.isFirstRun&&(this.isFirstRun=!1)}this._incrementWfCounter(),this.wfGenerator.changeWfBasePath()}}}}},{key:"_isOutOfViewPort",value:function(){return!(!this.store.get("isIdleMode")&&!document.hidden)||this.store.get("isOutOfViewPort")}},{key:"_getAdTypesToDrop",value:function(){var e=[];for(var t in this.adsToDrop)this.adsToDrop[t]&&e.push(t);return e}},{key:"passedMaxEmptyWaterfalls",value:function(){return!!this.maxAllowedEmptyWaterfalls&&this.store.get("emptyWaterfallsInARow")>this.maxAllowedEmptyWaterfalls}},{key:"_wfIndexCalculation",value:function(){return this.store.get("unitFetcherDemand")?0:this.waterfallIndex>-1?this.waterfallIndex:this.wfGenerator.getWfCounter()-1}},{key:"_handleWaterfallSuccess",value:function(e,t){if(this._addRoundTripDuration(),!e)return this.debugTracker.info("runWaterfall","Empty Waterfall!"),void this._updateWaterfallFailure("empty-response",t);this.encryptWaterfallResponse&&(e=this._decodeText(e));var i=new Function("try { return ".concat(e,";} catch(e){}"))(),r=i&&i.tags&&i.tags.length;if((this.store.get("overrideSessionDataOnEveryWfResponse")||r)&&i&&i.sd&&this.store.set("sessionData",i.sd),!r){var n=i&&i.tags?"Failed to decode empty server response":"No tags returned from waterfall response!";return this.debugTracker.warn("runWaterfall",n),void this._updateWaterfallFailure("no-tags",t)}this.store.set("emptyWaterfallsInARow",0),this.debugTracker.info("Waterfall number ".concat(this.waterfallIndex+1," received"),i.tags,{color:"#D15EFF"}),i&&i.pixel_piggies&&this._firePiggies(i.pixel_piggies);var o=[],a=i.cisid,s=void 0===a?null:a;for(var l in this.store.set("cisid",s),i.tags){var d=i.tags[l];if(d.url||d.vast){var u,c=d.lp&&d.lp.length>0&&d.lp[0]?d.lp[0]:"",h=void 0,p=void 0,f=void 0,v=void 0,y=void 0;d.cirid&&d.vidDast?(f=d.cirid,v=this.store.get("auc_dast"),y=d.vidDast):(p=this._getPixel(d.pixel)||"",f=(h=(0,m.JO)(p)).cirid,v=h.dast,y=h["vid-dast"]),d.getValueByKey=function(e,t){return this.dsm&&this.dsm.hasOwnProperty(t)?this.dsm[t]:e.get(t)}.bind(d,this.store);var g,_=d.advType===T||d.advType===k,b=this.store.get("cipid")||-1,E=this._wfIndexCalculation();if((d=Object.assign(d,M(M(M(M(M(M(M(M(M({score:-1,waterfallTagId:l,created:(new Date).getTime(),dp:c?c.replace(/http:\/\/|.com|https:\/\/|.com/g,""):"na",dpFull:c||"na",conversionPixels:d.conversionPixels||[],ts:Date.now(),wfIndex:E,sequenceId:E,url:d.url?(0,m.SI)((0,m.gM)(d.url,this.store)):"",vast:d.vast?(0,m.gM)(d.vast,this.store):"",pixel:p,eventTrackers:d.etrk?d.etrk:{},jsTrackers:d.jstrk?d.jstrk:[],brand:d.brand||"",dsm:d.dsm||{},rollType:this.currentRollType,pubId:this.pubid,tagId:this.tagid,isRon:this.isRon,cstmdl:d.cstmdl||-1,singleAd:1===d.sa},void 0!==this.defaultTagPrice&&"price",d.price||this.defaultTagPrice),f&&"cirid",f),"dast",v),"vidDast",y),"campaignId",b),"lineItem",(d.lineItemId||"").toString()),"isDirectDemand",_),"isDirectOrPMP",_||d.advType===w),"isRTB",d.advType===S||d.advType===I),this._overrideParamsByDemand(d),this._decodeItemParams(d))).adEvents=new V.NU({store:this.store,tag:Object.assign({},d),index:-1,creatives:this.config.creatives}),d.adEvents.onEvent(V.MH.WF_SUCCESS),null!==(u=d.eventTrackers)&&void 0!==u&&u.impression&&(null===(g=d.eventTrackers)||void 0===g||g.impression.forEach((function(e){e.isNurl=!0}))),d.advType===O)try{d.url=JSON.parse(d.url),d.isPrebid=!0,d.bidder=this._extractBidderName(d.url),this._extractBuyerUId(d)}catch(e){continue}if(this._shouldDropAd(d))continue;if(this.requiredViewabilityFactor>0&&!d.requiredViewability&&(d.requiredViewability=this._drawRequiredViewabilityByFactor(d)),this.enableAdxBlocking&&this._isIMATag(d)&&(this.gotAdxDemandInSession=!0),this._ignoreLineitem(d.lineItem)){d.adEvents.onEvent(V.MH.DROPPED_ON_LINE_ITEM_IGNORE);var P="".concat(d.lineItem,".failsRow");this.store.get(P)?this.store.incr(P):this.store.set(P,1)}else o.push(d);this.store.get(d.lineItem)||this.store.set(d.lineItem,{failsRow:0,tries:0,conversions:0,fails:0}),d.lineItemStats=(0,m.Go)(this.store.get(d.lineItem))}}o.length>0?(i.tags=o,i.data=new A(this.store,this.staticWf?1:this.wfGenerator.getWfCounter()),this.onWaterfallSuccess(i)):(this.debugTracker.error("runWaterfall","Failed to get any tags!"),this._handleWaterfallError("no-clean-tags",t))}},{key:"_extractBuyerUId",value:function(e){var t=this.store.get("prebid.userIdAsEidsMapping"),i=this.store.get("sessionData");if(i&&i.ep&&i.ep.length&&t&&t.hasOwnProperty(e.bidder)){var r=t[e.bidder];i.ep.forEach((function(t){r.includes(t.ei)&&t.ui&&(e.url.bidderRequest.user.buyeruid=t.ui)}))}}},{key:"_extractBidderName",value:function(e){var t=e.bidderRequest;if(t){var i=t.bids;if(i&&i.length>0)return i[0].bidder}}},{key:"_updateWaterfallFailure",value:function(e,t){this.store.incr("waterfallFailsInARow"),this.store.set("waterfallSuccessesInARow",0),this._handleWaterfallError(e,t)}},{key:"_shouldDropAd",value:function(e){for(var t in this.adsToDrop)if(this._shouldDropAdByType(e,t))return e.adEvents.onEvent(V.MH.DROPPED_BY_TYPE),!0;return this.store.get("isAmp")&&(e.getValueByKey("drponamp")||!e.requiredViewability&&this.store.get("dropRv0Amp"))?(e.adEvents.onEvent(V.MH.DROPPED_ON_AMP),!0):e.requiredViewability&&this.store.get("iosAutoPlayDisabled")?(e.adEvents.onEvent(V.MH.DROPPED_ON_IOS_AUTOPLAY_RESTRICTION),!0):!!(this.store.get("publisherVideoDetected")&&this._isIMATag(e)&&this.store.get("drpAdxOnPublisherVideoDetected"))||!(!this.enableAdxBlocking||!this._shouldForceAdxBlockOnItem(e))||!(!e.isPrebid||this.store.get("prebid.isActive"))}},{key:"_shouldForceAdxBlockOnItem",value:function(e){var t=parseInt(e.advId);return!!(this.adxBlock.advIds.indexOf(t)>-1)&&(this.adxBlock.mode===F||(this.adxBlock.mode===B?this.gotAdxDemandInSession:this.adxBlock.mode===N&&this.store.get("hasAdxInQueue")))}},{key:"_shouldDropAdByType",value:function(e,t){return this.adsToDrop[t]&&e.hasOwnProperty(t)&&e[t]}},{key:"_drawRequiredViewabilityByFactor",value:function(e){var t=[S,I,O,P],i=(0,m.hw)(0,100)<=this.requiredViewabilityFactor&&e&&t.includes(e.advType);return i&&(e.requiredViewabilityDrawn=!0),i}},{key:"_overrideParamsByDemand",value:function(e){return this.store.get("ovrtgbydc")?e.getValueByKey("ovrdtag"):{}}},{key:"_addRoundTripDuration",value:function(){var e=Date.now()-this.lastRun;this._roundTripAverageDuration=parseInt((this._roundTripAverageDuration*this._roundTripsCount+e)/(this._roundTripsCount+1)),this.store.multiSet({"waterfall_data.last_duration":e,"waterfall_data.average_duration":this._roundTripAverageDuration}),this._roundTripsCount++}},{key:"_ignoreLineitem",value:function(e){if(this.lineitemMaxFails>0){var t=this.store.get(e);return(t?t.failsRow:-1)>this.lineitemMaxFails}return!1}},{key:"_decodeItemParams",value:function(e){return Object.assign({rpox:this._decodeValue(e.rpox),alfrox:this._decodeValue(e.alfrox),frox:this._decodeValue(e.frox),itemType:e.t},e.ex&&{crId:e.ex.ecrid,stId:e.ex.s,cmpgnId:e.ex.ecid},e.ex&&e.ex.b&&{brand:this.encryptWaterfallResponse?e.ex.b:this._decodeText(e.ex.b)})}},{key:"_decodeValue",value:function(e){return this.encryptWaterfallResponse?e:(2530^e)/1e3}},{key:"_decodeText",value:function(e){for(var t,i=(0,m.Qv)(e),r="PlAyER",n="",o=0;o<i.length;o++){t=o%6;var a=i[o].charCodeAt(0).toString(10),s=r[t].charCodeAt(0).toString(10);n+=String.fromCharCode(a^s)}return n}},{key:"_firePiggies",value:function(e){if(this.store.get("fire_piggies")&&!(this.wfGenerator.getWfCounter()>=5))for(var t=0;t<e.length;t++){var i=e[t];if(i.url){var r=(0,m.s1)(i.url);try{Utils.fireImagePixel(r)}catch(e){this.debugTracker.error("_fireIframePig - Malformed url!",e)}}}}},{key:"_handleWaterfallError",value:function(e){this.store.incr("emptyWaterfallsInARow"),this.passedMaxEmptyWaterfalls()&&this._sendMaxEmptyWaterfallPixel(),this._addRoundTripDuration(),this.onWaterfallError(e)}},{key:"_sendMaxEmptyWaterfallPixel",value:function(){this.fireMaxEmptyWaterfallPixel&&(0,m.jr)((0,m.TF)(E.A.maxEmptyWfs,this.store))}},{key:"_getPixel",value:function(e){if(e){var t=new RegExp(/src=[\"|\']([^"]+)[\"|\']/).exec(e),i=t&&t.length>1&&t[1]?t[1]:e;return i.substring(i.indexOf("//"))}}},{key:"onWaterfallError",value:function(){}},{key:"onWaterfallSuccess",value:function(){}},{key:"SetWaterfallError",value:function(e){this.onWaterfallError=e}},{key:"SetWaterfallSuccess",value:function(e){this.onWaterfallSuccess=e}},{key:"SetShouldRun",value:function(e){this.shouldRun=e||function(){}}},{key:"_getRollType",value:function(){var e=this.store.get("contentSchedule")||{},t=null,i=Object.keys(e)||[];return this.staticWf||1===this.wfGenerator.getWfCounter()?t=e[i[0]]:i.length>0&&(t=e[i[1]]),this.currentRollType=t?t.roll_type:"",this.pubid=t?t.pubid:0,this.tagid=t?t.tagid:0,t}},{key:"_stop",value:function(){clearTimeout(this.wfInterval)}},{key:"start",value:function(){this.startNextWfTimeout()}},{key:"stop",value:function(){this._stop()}},{key:"_onQueueStatusChanged",value:function(e){var t=function(e){var t=Object.assign({},e);return t.aid=t.cstmdl=t.dp=t.pid=void 0,""===t.br&&(t.br=void 0),t};this.queueStatus={size:e.size,prevItems:e.previousQueue.map(t),items:e.items.map(t)}}},{key:"dropAds",value:function(e){this.adsToDrop.hasOwnProperty(e)&&!this.adsToDrop[e]&&(this.adsToDrop[e]=!0)}},{key:"addWfParameter",value:function(e,t){void 0!==t&&(this.wfParamsFromUnit[e]=encodeURIComponent(t))}},{key:"updateWfParameter",value:function(e,t){this.addWfParameter(e,t)}},{key:"removeWfParameter",value:function(e){this.wfParamsFromUnit[e]&&(this.wfParamsFromUnit[e]=void 0,delete this.wfParamsFromUnit[e])}},{key:"_incrementWfCounter",value:function(){this.wfGenerator.increaseWfCounter(),this.store.set("waterfallIndex",this.wfGenerator.getWfCounter())}},{key:"_isTbWfResponseExists",value:function(){return!!this.store.get("firstWfRes")}},{key:"_onTbWfResponseSuccess",value:function(){if(this._isTbWfResponseExists())try{return this._handleTbWfResponse(),!0}catch(e){this.debugTracker.error("tbWaterfallResponse",e)}return!1}},{key:"_handleTbWfResponse",value:function(){var e=this.wfGenerator.getWfCounter()-1;this.waterfallIndex=e,this._handleWaterfallSuccess(this.store.get("firstWfRes")),this.store.set("firstWfRes",void 0)}}],t&&L(e.prototype,t),i&&L(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function W(e){return/^\d+$/.test(e)?parseInt(e):/^true$|^false$/g.test(e)?"true"===e||!0===e:e}var j=n(9738);function H(e){return H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},H(e)}function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,o,a,s=[],l=!0,d=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(r=o.call(i)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){d=!0,n=e}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(d)throw n}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return q(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?q(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function q(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function z(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Q(r.key),r)}}function Q(e){var t=function(e,t){if("object"!=H(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=H(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==H(t)?t:t+""}var K,Y=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(0,j.mixin)(this),this._maxListeners=100,this.data={},Object.assign(this.data,t);var i="17.8.7";this.data.full_player_version=i,i=i.replace(/\./g,""),i=parseInt(i),this.data.debugLevels=t.debug?t.debug:"",this.data.debug=-1!=t.debug.indexOf("*"),this.data.playerVersion=this.data.player_version=i,this.data.isInApp=void 0!==window.taboolaMobile;var r="",n="",o="";try{n=t.unit_name,r=t.abTest,o=t.unit_main_version}catch(e){}this.data.ab_test=r,this.data.unit_type=n,this.data.unit_version=o,this.data.isFirstImpression=!0,this.data.session_started=Date.now(),this.data.secured_protocol="https:"===(window&&window.location&&window.location.protocol),window.cmTag&&window.cmTag.config&&window.cmTag.config.contentClickUrl&&(this.data.contentClickUrl=window.cmTag.config.contentClickUrl),(0,m.k3)(this)},(t=[{key:"incr",value:function(e){X.exists(e,this.data)||X.set(e,0,this.data);var t=X.get(e,!0,this.data)||0;if("number"==typeof t)return X.set(e,t+1,this.data),X.get(e,!1,this.data)}},{key:"decr",value:function(e){var t=X.get(e,!1,this.data);if("number"==typeof t)return X.set(e,t-1,this.data),X.get(e,!1,this.data)}},{key:"get",value:function(e){return-1===(e=e.toString()).indexOf(".")?this.data[e]:X.get(e,!1,this.data)}},{key:"getByTech",value:function(e,t){var i=this.get("dsm")||{};return i&&i.hasOwnProperty(t)&&i[t].hasOwnProperty(e)?i[t][e]:null}},{key:"getByAdInline",value:function(e,t){for(var i=this.get("dsm")||{},r=0;r<e.length;r++)for(var n=e[r],o=0,a=Object.entries(i);o<a.length;o++){var s=G(a[o],2),l=s[0],d=s[1],u=new RegExp(l,"ig");if(u.test(n.as)||u.test(n.at))return i[l];if(d.pvpdJs&&d.pvpdJsUrl&&t&&new RegExp(d.pvpdJsUrl,"i").test(t.textContent))return i[l]}return this.get("adstngs")}},{key:"getByDemandType",value:function(e){return(this.get("dts")||{})[e]}},{key:"set",value:function(e,t){e=e.toString(),X.set(e,t,this.data)}},{key:"multiSet",value:function(e){for(var t in e)this.set(t,e[t])}},{key:"getWfData",value:function(){var e=this.get("dsm")||{},t=[];for(var i in e)/^\d+$/.test(i)&&e[i]&&e[i].hasOwnProperty("ftchVst")&&t.push({id:i,fv:e[i].ftchVst});return t}}])&&z(e.prototype,t),i&&z(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}(),X=(K=function(e,t,i){for(var r,n=i||data,o=0;n&&(r=e[o]);o++)n=r in n?n[r]:t?n[r]={}:void 0;return n},{set:function(e,t,i){var r=e.split("."),n=r.pop(),o=K(r,!0,i);return o&&n?o[n]=t:void 0},get:function(e,t,i){return K(e.split("."),t,i)},exists:function(e,t){return void 0!==this.get(e,!1,t)}});function J(e){return J="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(e)}function Z(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=J(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=J(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==J(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var $={wirewax:{adtnlscrpts:[{src:"//edge-player.wirewax.com/ww4release/javascripts/wirewax-iframe-api.js",clbk:function(){try{for(var e in this.adUnit.unsubscribe(this.vpaidEvents.AdImpression,"*"),this.adUnit.unsubscribe(this.vpaidEvents.AdVideoComplete,"*"),this.adUnit._iframe.contentWindow.wirewax.events.listeners)this.adUnit._iframe.contentWindow.wirewax.addEventListener(this.adUnit._iframe.contentWindow.wirewax.events.listeners[e],this.onIframeEvent)}catch(e){}}}],ifrmevts:{playerReady:"AdImpression",videoEnd:"AdVideoComplete"},hdtrgt:!0,wtfradpsdbfrrsmad:!0,prvnterlyadimpopp:!0,onrsm:function(){this.adUnit._iframe.contentWindow.wirewax.playerId="wirewax-ad-iframe",this.adUnit._iframe.contentWindow.wirewax.triggerEvent(this.adUnit._iframe.contentWindow.wirewax.events.triggers.CLOSE_WIDGET)}},"the trade desk":{extwnprc:!0,wnprcfld:"wp",pvpdJs:!0},dbm:{extwnprc:!0,wnprcfld:"pr"},DCM:{forceOmidForVpaid:!0},FT:{forceOmidForVpaid:!0},Adform:{forceOmidForVpaid:!0}},ee={spprtvrtclvd:!1,strch:!1},te=Z(Z(Z(Z(Z(Z(Z({},k,ee),w,ee),S,ee),P,ee),I,ee),O,ee),D,ee);function ie(e,t,i,r,n,o){var a=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"application/x-www-form-urlencoded",l=!(!(arguments.length>9&&void 0!==arguments[9])||arguments[9]),d=[];function u(e,t,i,r,n,o,c){if(!e)return!1;t=t||"";var h=new XMLHttpRequest,p=t?"POST":"GET";return h.open(p,e,!0),h.withCredentials=!0,!1===o&&(h.withCredentials=!1),h.setRequestHeader("Content-type",s),h.async=null==n||n,h.callback=(0,m.Tn)(i)?i:function(){},h.fallback=(0,m.Tn)(r)?r:function(){},h.timeout=c,h.gotResponse=!1,h.addEventListener("error",(function(e){this.gotResponse||(this.gotResponse=!0,h.fallback())})),h.addEventListener("load",(function(e){this.gotResponse||(this.gotResponse=!0,h.fallback())})),h.addEventListener("abort",(function(e){this.gotResponse||(this.gotResponse=!0,h.fallback())})),h.addEventListener("timeout",(function(e){this.gotResponse||(this.gotResponse=!0,h.fallback())})),h.addEventListener("readystatechange",(function(o){if(4==this.readyState){if(this.gotResponse)return;switch(this.gotResponse=!0,this.status+""){case"200":case"204":case"460":this.callback(this.responseText,d,e);break;default:if(!l)return d.push(this.status),void function(e,t,i,r,n,o,s,d){l=!0,a&&(e+="".concat(e.indexOf("?")>-1?"&":"?","rt=1&prst=").concat(d||""));u(e,t,i,r,n,!1,s)}(e,t,i,r,n,0,c,this.status);d.push(this.status),this.fallback(d,e)}}})),h.send(t),!0}u(e,t,i,r,n,o,arguments.length>7&&void 0!==arguments[7]?arguments[7]:5e3)}function re(e){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},re(e)}function ne(e){return function(e){if(Array.isArray(e))return oe(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return oe(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?oe(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oe(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function ae(e,t,i){return(t=le(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function se(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,le(r.key),r)}}function le(e){var t=function(e,t){if("object"!=re(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=re(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==re(t)?t:t+""}var de=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t,this._loadDSM(),this._loadBlocklistFromCDN()},(t=[{key:"_loadDSM",value:function(){this.stopped||this.store.multiSet(ae(ae({},"dsm",$),"dts",te))}},{key:"_fireOldBlockListLoadedPixel",value:function(){(0,m.ri)(parseInt(this.store.get("fireOldBlockListLoaded")))&&(0,m.jr)((0,m.TF)(E.A.oldBlockListLoaded,this.store))}},{key:"_processBlocklistData",value:function(e){var t;if(e.custom||e.default){var i=this.store.get("taboolaNetworkId"),r=(null===(t=e.custom)||void 0===t?void 0:t.find((function(e){return e.publisherId===i})))||e.default,n=r.dynamicBlocklist,o=n&&n.length,a=o?"|".concat(n.join("|")):"",s=r.vastRegex+a,l=r.videoUrls+a,d=JSON.parse(r.vpaidNetworkCalls),u=o?[].concat(ne(d),ne(n)):d;this.store.multiSet({regx:s,hjkbldomsencdd:u,videoBlacklist:l})}}},{key:"_loadBlocklistFromCDN",value:function(){var e=this,t=this.store.get("blocklistFetchUrl");t?ie(t,void 0,(function(t){return e._updateBlocklistOnSuccess(t)}),void 0,void 0,!1,void 0,void 0,this.store.get("psthdrs")||"application/json"):this._fireOldBlockListLoadedPixel()}},{key:"_updateBlocklistOnSuccess",value:function(e){try{if(e){var t=atob(e),i=JSON.parse(t);return void this._processBlocklistData(i)}}catch(e){}this._fireOldBlockListLoadedPixel()}},{key:"destroy",value:function(){this.stopped||(this.stopped=!0,this.store=void 0)}}])&&se(e.prototype,t),i&&se(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function ce(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,he(r.key),r)}}function he(e){var t=function(e,t){if("object"!=ue(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=ue(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ue(t)?t:t+""}var pe=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t,this.fireLowNetworkDownlinkPixel=(0,m.ri)(parseInt(this.store.get("frdwnlnkpxls"))),this.effectiveTypes={"slow-2g":1,"2g":2,"3g":3,"4g":4},this.types={bluetooth:1,cellular:2,ethernet:3,none:4,wifi:5,wimax:6,other:7,unknown:8},this.navigatorConnection={},this._detectConnectionType()},(t=[{key:"_detectConnectionType",value:function(){var e=this,t=navigator.connection||navigator.mozConnection||navigator.webkitConnection;if(t){var i=function(){var t=navigator.connection||navigator.mozConnection||navigator.webkitConnection,i=t.effectiveType||"",r=t.type||"";e.navigatorConnection={browserSupport:!0,downlink:t.downlink||0,effectiveType:i,type:r,effectiveTypeId:e.effectiveTypes.hasOwnProperty(i)?e.effectiveTypes[i]:0,typeId:e.types.hasOwnProperty(r)?e.types[r]:0,rtt:t.rtt||0,saveData:t.saveData||!1},e.store.set("navigatorConnection",e.navigatorConnection),e.store.emit("navigatorConnectionChange",e.navigatorConnection),e._sendPixelIfDownlinkLow()};t.onchange=i,i()}else this.navigatorConnection={browserSupport:!1},this.store.set("navigatorConnection",this.navigatorConnection)}},{key:"_sendPixelIfDownlinkLow",value:function(){if(this.fireLowNetworkDownlinkPixel&&this.navigatorConnection){var e=this.navigatorConnection.downlink;void 0!==e&&e<this.store.get("dwnlnktrshld")&&(0,m.jr)((0,m.TF)(E.A.lowNetworkDownlink,this.store))}}}])&&ce(e.prototype,t),i&&ce(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();const fe={1:"dialup",2:"wired",3:"wifi",4:"mobile",5:"satellite"};function ve(e){return ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ve(e)}function ye(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=ve(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=ve(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ve(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var me="iOS",ge="Android",_e="Fire OS",be="Firefox",Ae="Safari",Ee="IE",Te=ye(ye(ye({},ge,ye(ye({"Chrome Mobile":53,Chromium:53,"Firefox Mobile":49,"Firefox Focus":49,Android:7,"Android Webkit":7,"Amazon Silk Browser":71,"Facebook on Android":void 0,"Opera Mobile":void 0,"Opera Mini":void 0,"MIUI Browser":void 0,"Yandex browser":void 0,"UC Browser":void 0,"Samsung Browser":void 0},"Edge",void 0),"Opera",void 0)),me,{"Firefox on iOS":7}),_e,{"Amazon Silk Browser":71}),ke=n(8312),we={VPAID:"vpaid",VIDEO:"video",ADX:"adx",UNKNOWN:"unknown"},Se={FLV:"flv",WMV:"wmv",MP4:"mp4",WEBM:"webm",OGG:"ogg",QUICKTIME:"mov",VPAID:"javascript",FLASH:"flash",UNKNOWN:"unknown"},Pe={unknown:{type:we.UNKNOWN,subType:Se.UNKNOWN},"video/x-flv":{type:we.VIDEO,subType:Se.FLV},"video/x-ms-wmv":{type:we.VIDEO,subType:Se.WMV},"video/mp4":{type:we.VIDEO,subType:Se.MP4},"video/webm":{type:we.VIDEO,subType:Se.WEBM},"video/ogg":{type:we.VIDEO,subType:Se.OGG},"video/quicktime":{type:we.VIDEO,subType:Se.QUICKTIME},"application/javascript":{type:we.VPAID,subType:Se.VPAID},"application/x-javascript":{type:we.VPAID,subType:Se.VPAID},"text/javascript":{type:we.VPAID,subType:Se.VPAID},"application/x-shockwave-flash":{type:we.VPAID,subType:Se.FLASH}},Ie=function(e,t){var i=e.sort((function(e,t){return e.score>t.score?1:-1})),r=t.get("sortByDurationAndCpm");if(i.length>0&&r){for(var n=.5*i[i.length-1].price,o=[],a=[],s=0;s<i.length;s++){var l=i[s],d=l.price;l.vdur<15&&d>n?o.push(l):a.push(l)}return o.sort((function(e,t){return e.price-t.price})),[].concat(a,o)}return i},Oe=function(e,t){var i=Ce(e.wfIndex),r=Ce(e.waterfallTagId),n=Ce(e.cpmFloor),o=Ce(e.fillrate),a=e.getValueByKey("scoreBoost")||0,s={wg:i,wi:r,fr:o,cf:n,mt:De(e.type)||1,advb:a,vdur:Ce(e.vdur)};e.scoreSummary=s;var l=1,d=t.get("qsrtscr");if(d&&(0,m.Tn)(d))try{l=d(s,e,t)}catch(e){l=999999}return e.score=l,l},De=function(e){return e===Se.FLASH?1:e===Se.VPAID?2:3},Ce=function(e){return parseInt(e||0)},Ve="mute",Re="unmute",Le="NewCompletion",Me="emitQueueStatus";function xe(e){return xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xe(e)}function Fe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,o,a,s=[],l=!0,d=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(r=o.call(i)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){d=!0,n=e}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(d)throw n}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ne(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Ne(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function Be(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ue(r.key),r)}}function Ue(e){var t=function(e,t){if("object"!=xe(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=xe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==xe(t)?t:t+""}var We="show",je="hide",He=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(0,j.mixin)(this),this.store=t.store,this.video=t.video,this.target=t.video.parentElement||t.target,this.disclosureText=this.store.get("disctxt"),this.defaultVolume=this.store.get("dfltvlm"),this.showAdMuteButton=this.store.get("shwadmtebtn"),this.hideProgressBar=this.store.get("hdprgrsbr"),this.canOptOut=this.store.get("can_opt_out"),this.showAdsPlayPauseButton=this.store.get("shwadsplypusbtn"),this.disableProgressBarClicks=this.store.get("disprgrbrclk"),this.initProgressBarBackground=!1,this.eventsToEmitOnce=[],this.state={};var i=Fe(t.controls,2);this.resumeAd=i[0],this.pauseAd=i[1],this._initElements(),this._setInitialState()},t=[{key:"_initElements",value:function(){}},{key:"_setInitialState",value:function(){var e={volume:0,adDuration:0,adCurrentTime:0,adLastTickTime:0,isMuted:0===this.store.get("volume")||this.isMobile,isPaused:!1,vidDuration:30,vidCurrentTime:0,isVisible:!1};this.setState(e)}},{key:"setState",value:function(e){!this.stopped&&e&&0!==Object.keys(e).length&&(this.state=Object.assign(this.state,e),this._render())}},{key:"getFromState",value:function(e){var t;return null!==(t=this.state[e])&&void 0!==t?t:void 0}},{key:"_stopPropagation",value:function(e){e.stopPropagation()}},{key:"_setSoundButtonDisplay",value:function(){var e=this;requestAnimationFrame((function(){e.stopped||((0,m.vy)(e.soundElement,je),(0,m.vy)(e.soundElement,We),(0,m.iQ)(e.soundElement,e.showAdMuteButton?We:je))}))}},{key:"_setPlayPauseButton",value:function(){var e=this;requestAnimationFrame((function(){e.stopped||e.showAdsPlayPauseButton!==We&&e.playPauseArea.classList.add(je)}))}},{key:"_render",value:function(){this._renderVolumeControls(),this._renderProgressBar(),this._renderControlsVisibility(),this._renderSoundButton(),this._renderPlayPause()}},{key:"_renderVolumeControls",value:function(){this._onVolumeChange(),this._triggerVolumeChangeOnVpaid(),this._onSoundChangeCallback&&this._onSoundChangeCallback()}},{key:"_onVolumeChange",value:function(){this.state.isMuted?this._mute():this._unmute()}},{key:"_mute",value:function(){this.state.volume=0}},{key:"_unmute",value:function(){this.state.volume=this.defaultVolume}},{key:"_triggerVolumeChangeOnVpaid",value:function(){this.emit(Ge.VOLUME_CHANGE,this.state.volume,!0)}},{key:"setOnSoundChangeCallback",value:function(e){this._onSoundChangeCallback=e}},{key:"_renderProgressBar",value:function(){this.state.preventAdTicker?this._emitOnce(Ge.TIMEUPDATE_REGISTER):(this.adStartTime=Date.now(),this.adTickerId||(this.adTickerId=setInterval(this._onAdTicks.bind(this),250))),this._advanceProgressBar()}},{key:"_emitOnce",value:function(e){this.eventsToEmitOnce.indexOf(e)>-1||(this.eventsToEmitOnce.push(e),this.emit(e))}},{key:"_onAdTicks",value:function(){if(!this.stopped){var e=Date.now(),t={};this.state.isPaused?0!=this.state.adLastTickTime&&(this.adStartTime+=e-this.state.adLastTickTime):(t.adCurrentTime=(e-this.adStartTime)/1e3,t.adCurrentTime>this.state.adDuration&&(t.adCurrentTime=this.adStartTime>0?this.state.adDuration:0),t.vidDuration=t.adDuration,t.vidCurrentTime=t.adCurrentTime),t.adLastTickTime=e,this.setState(t)}}},{key:"_advanceProgressBar",value:function(){var e=this;requestAnimationFrame((function(){if(!e.stopped){var t=100-(e.state.vidDuration-e.state.vidCurrentTime)/e.state.vidDuration*100,i="".concat(t,"%");e.progressBarPercentager.style.width!==i&&(e._initializeProgressBarIfNeeded(t),e.progressBarPercentager.style.width=i)}}))}},{key:"_initializeProgressBarIfNeeded",value:function(e){var t=parseInt(this.progressBarPercentager.style.width);isNaN(t)||parseInt(e)<t?this.initProgressBarBackground||(this.initProgressBarBackground=!0,(0,m.iQ)(this.progressBarPercentager,"init_bg")):this.initProgressBarBackground&&(this.initProgressBarBackground=!1,(0,m.vy)(this.progressBarPercentager,"init_bg"))}},{key:"_renderControlsVisibility",value:function(){var e=this;requestAnimationFrame((function(){var t,i;e.stopped||(e.state.isVisible?(t=je,i=We):(t=We,i=je),(0,m.vy)(e.element,t),(0,m.iQ)(e.element,i))}))}},{key:"_onPlayPauseClicked",value:function(e){if(this.video){var t=this.state.isPaused;t?this.resumeAd():this.pauseAd(),this.setState({isPaused:!t}),this._stopPropagation(e)}}},{key:"resetAdControls",value:function(){}},{key:"destroy",value:function(){}},{key:"_renderSoundButton",value:function(){}},{key:"_renderPlayPause",value:function(){}}],t&&Be(e.prototype,t),i&&Be(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}(),Ge={VOLUME_CHANGE:"volumeChange",TIMEUPDATE_REGISTER:"timeupdateRegister",RESET_CONTROLS:"resetControls"};function qe(e){return qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qe(e)}function ze(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Qe(r.key),r)}}function Qe(e){var t=function(e,t){if("object"!=qe(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=qe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==qe(t)?t:t+""}function Ke(e,t,i){return t=Xe(t),function(e,t){if(t&&("object"==qe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ye()?Reflect.construct(t,i||[],Xe(e).constructor):t.apply(e,i))}function Ye(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ye=function(){return!!e})()}function Xe(e){return Xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Xe(e)}function Je(e,t){return Je=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Je(e,t)}var Ze=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ke(this,t,[e])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Je(e,t)}(t,e),i=t,r=[{key:"_initElements",value:function(){this._renderElements(),this.mainArea=this.element.children[0],this.optOutElement=this.mainArea.children[0],this.progressBarArea=this.mainArea.children[1],this.progressBarBackground=this.progressBarArea.children[0],this.progressBarPercentager=this.progressBarArea.children[1],this.soundElement=this.mainArea.children[2],this.playPauseArea=this.mainArea.children[3],this.pauseBtn=this.playPauseArea.children[0],this.playBtn=this.playPauseArea.children[1],this._setProgressBarClickAbility(),this._setSoundButtonDisplay(),this._setPlayPauseButton(),this._addEventListeners(),this._hideProgressBarIfNeeded(),this._hideOptOutIfNeeded()}},{key:"_hideProgressBarIfNeeded",value:function(){this.hideProgressBar&&this.progressBarArea&&(this.progressBarArea.style.display="none")}},{key:"_hideOptOutIfNeeded",value:function(){this.canOptOut||(0,m.iQ)(this.optOutElement,"opt-out-hidden")}},{key:"_renderElements",value:function(){this.element=document.createElement("div"),this.element.className="video_controls hide",this.element.innerHTML="<div class='video_controls video_controls_main_area'>\n                <div class='title text'>".concat(this.disclosureText,"</div>\n                <div class='cm_video_controls_progressbar_area'>\n                    <div class='cm_video_controls_progressbar_bg white_bg'></div>\n                    <div class='cm_video_controls_progressbar blue_bg'></div>\n                </div>\n                <div class='cm_video_controls_mute interactive display_mute'></div>\n                <div class='cm_video_controls_playpause interactive'>\n                    <div class='pause hide'></div>\n                    <div class='play hide'></div>\n                </div>\n            </div>"),this.target.appendChild(this.element)}},{key:"_addEventListeners",value:function(){this.element.addEventListener("click",this._stopPropagation),this._bindedOnMuteClicked=this._onMuteClicked.bind(this),this.soundElement.addEventListener("click",this._bindedOnMuteClicked),this._bindedOnPlayPauseClicked=this._onPlayPauseClicked.bind(this),this.playBtn.addEventListener("click",this._bindedOnPlayPauseClicked),this.pauseBtn.addEventListener("click",this._bindedOnPlayPauseClicked)}},{key:"_onMuteClicked",value:function(e){if(this.showAdMuteButton){0===this.state.volume&&this.emit(Ge.VOLUME_CHANGE,this.defaultVolume,!0);var t={};this.store.set("forceMute",!this.state.isMuted),t.volume=this.state.isMuted?this.defaultVolume:0,t.isMuted=0===t.volume,this.setState(t),this._stopPropagation(e)}}},{key:"resetAdControls",value:function(){this.emit(Ge.RESET_CONTROLS)}},{key:"_renderSoundButton",value:function(){this.state.isMuted?((0,m.vy)(this.soundElement,"display_unmute"),(0,m.iQ)(this.soundElement,"display_mute")):((0,m.vy)(this.soundElement,"display_mute"),(0,m.iQ)(this.soundElement,"display_unmute"))}},{key:"_renderPlayPause",value:function(){var e=this.state.isPaused?this.playBtn:this.pauseBtn,t=this.state.isPaused?this.pauseBtn:this.playBtn;t.classList.remove(We),t.classList.add(je),e.classList.remove(je),e.classList.add(We)}},{key:"destroy",value:function(){this.stopped=!0,this.adTickerId=clearInterval(this.adTickerId),this.element.removeEventListener("click",this._stopPropagation),this.soundElement.removeEventListener("click",this._bindedOnMuteClicked),this._bindedOnMuteClicked=this.mainArea=this.optOutElement=this.progressBarArea=this.progressBarBackground=this.progressBarPercentager=this.soundElement=void 0}},{key:"_setProgressBarClickAbility",value:function(){this.disableProgressBarClicks&&this.progressBarArea.classList.add("interactive")}}],r&&ze(i.prototype,r),n&&ze(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,r,n}(He);function $e(e){return $e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$e(e)}function et(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,tt(r.key),r)}}function tt(e){var t=function(e,t){if("object"!=$e(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=$e(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$e(t)?t:t+""}function it(e,t,i){return t=nt(t),function(e,t){if(t&&("object"==$e(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,rt()?Reflect.construct(t,i||[],nt(e).constructor):t.apply(e,i))}function rt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(rt=function(){return!!e})()}function nt(e){return nt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},nt(e)}function ot(e,t){return ot=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ot(e,t)}var at=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),it(this,t,[e])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ot(e,t)}(t,e),i=t,r=[{key:"_initElements",value:function(){this._renderElements(),this.playPauseArea=this.element.children[0],this.soundElement=this.element.children[1],this.progressBarArea=this.element.children[2],this.progressBarBg=this.progressBarArea.children[0],this.progressBarPercentager=this.progressBarArea.children[1],this._setProgressBarClickAbility(),this._setSoundButtonDisplay(),this._setPlayPauseButton(),this._addEventListeners()}},{key:"_renderElements",value:function(){this.element=document.createElement("div"),this.element.className="video_controls_mobile",this.element.innerHTML='<div class="mc-pause" style="pointer-events: all;"></div>\n            <div class="speaker mute" style="pointer-events: all;"></div>\n            <div class="mc-progressbar_area">\n                <div class=\'mc-progressbar_bg white_bg\'></div>\n                <div class=\'mc-progressbar_bg blue_bg\'></div>\n            </div>\n            <div class="tbl-text">'.concat(this.disclosureText,"</div>"),this.target.appendChild(this.element)}},{key:"_addEventListeners",value:function(){this._bindedOnMuteClicked=this._onMuteClicked.bind(this),this.soundElement.addEventListener("click",this._bindedOnMuteClicked),this._bindedOnPlayPauseClicked=this._onPlayPauseClicked.bind(this),this.playPauseArea.addEventListener("click",this._bindedOnPlayPauseClicked)}},{key:"_onMuteClicked",value:function(e){this.showAdMuteButton&&(0===this.state.volume&&this.emit(Ge.VOLUME_CHANGE,this.defaultVolume,!0),this.video.muteButtonClicked&&this.video.muteButtonClicked(),this.setState({isMuted:!this.state.isMuted}),this._stopPropagation(e))}},{key:"_renderSoundButton",value:function(){var e=this;requestAnimationFrame((function(){e.stopped||(e.state.isMuted?(0,m.iQ)(e.soundElement,"mute"):(0,m.vy)(e.soundElement,"mute"))}))}},{key:"_renderPlayPause",value:function(){var e=this;requestAnimationFrame((function(){e.state.isPaused?((0,m.vy)(e.playPauseArea,"mc-pause"),(0,m.iQ)(e.playPauseArea,"mc-play")):((0,m.vy)(e.playPauseArea,"mc-play"),(0,m.iQ)(e.playPauseArea,"mc-pause"))}))}},{key:"destroy",value:function(){this.stopped=!0,this.adTickerId=clearInterval(this.adTickerId),this.soundElement.removeEventListener("click",this._bindedOnMuteClicked),this._bindedOnMuteClicked=this.soundElement=this.progressBarArea=this.progressBarBg=this.progressBarPercentager=void 0}},{key:"_setProgressBarClickAbility",value:function(){this.disableProgressBarClicks&&(this.progressBarArea.style="pointer-events: all;")}}],r&&et(i.prototype,r),n&&et(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,r,n}(He);const st=function(e,t){return e?new at(t):new Ze(t)};var lt=n(7628);function dt(e){return dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dt(e)}function ut(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ct(r.key),r)}}function ct(e){var t=function(e,t){if("object"!=dt(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=dt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==dt(t)?t:t+""}var ht={LEGACY:"legacy",SAFE:"safe",AUTO:"auto"},pt=0,ft=1,vt=3,yt=250,mt=function(){return e=function e(t,i){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=i,this.debugTracker=t.debugTracker,this.wrapperIndex=t.wrapperIndex,this.frameType=i.get("frameType"),this.maxDurationLimit=i.get("prftchmxlngth"),this.ua=i.get("wurfl"),this._deviceInfo=(0,m.uo)(this.store,!0),this.isIOS=i.get("isIOS")||this._deviceInfo.isIOS,this._isAndroidWebView=this._deviceInfo.isAndroidWebView,this._disposers=[],this.parentInstance=r,this.prefetchStrategy=this._validatePrefetchStrategy(this.store.get("prefetchStrategy")||ht.AUTO),this._legacyWarmPlayDisabled=!1,this._lastUserGestureAt=0,this._setupGestureTracking()},t=[{key:"_setupGestureTracking",value:function(){var e=this,t=function(){e._lastUserGestureAt=Date.now()};["pointerdown","keydown","touchstart"].forEach((function(i){e._addDisposableListener(document,i,t,{passive:!0})}))}},{key:"_validatePrefetchStrategy",value:function(e){return Object.values(ht).includes(e)?e:ht.AUTO}},{key:"_recentGesture",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3;return Date.now()-this._lastUserGestureAt<e}},{key:"_shouldUseLegacyWarmPlay",value:function(){return!(this.prefetchStrategy===ht.SAFE||this.prefetchStrategy!==ht.LEGACY&&(this._legacyWarmPlayDisabled||document.hidden||this._isAndroidWebView&&!this._recentGesture()))}},{key:"_addDisposableListener",value:function(e,t,i,r){e.addEventListener(t,i,r),this._disposers.push((function(){try{e.removeEventListener(t,i,r)}catch(e){}}))}},{key:"_onVisibilityOnce",value:function(e){var t=function(){document.removeEventListener("visibilitychange",t),e()};this._addDisposableListener(document,"visibilitychange",t)}},{key:"_disposeAll",value:function(){for(;this._disposers.length;){var e=this._disposers.pop();try{e()}catch(e){}}}},{key:"prefetchVideo",value:function(e,t,i){var r=this;if(e===Se.VPAID||e===we.VIDEO&&this.isIOS){var n=function(){i.removeEventListener("loadedmetadata",n),r._onPrefetchVideoMetaData(t,i)};i.addEventListener("loadedmetadata",n)}else{if(i.buffering=!0,i.preload="auto",i.setAttribute("playsinline",""),i.muted=!0,i.src=t,!this._shouldUseLegacyWarmPlay())return i.load(),this._addDisposableListener(i,"canplaythrough",(function(){var e;return null===(e=r.debugTracker)||void 0===e?void 0:e.info("Video prefetched (safe path)")}),{once:!0}),void this._onVisibilityOnce((function(){document.hidden||r._attemptWarmPlay(i)}));this._attemptWarmPlay(i)}}},{key:"_attemptWarmPlay",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.maxRetries,n=void 0===r?vt:r,o=i.retryDelay,a={tries:0,maxRetries:n,retryDelay:void 0===o?yt:o},s=function(){var i,r;if(!document.hidden){var n=e.play();n&&"function"==typeof n.catch&&(t.playPromise=null!==(i=null===m.ph||void 0===m.ph?void 0:(0,m.ph)(n))&&void 0!==i?i:n,null===(r=t.debugTracker)||void 0===r||r.info("VpaidPrefetching.video.play() prefetch warmup"),t.playPromise.then((function(){return t._handleWarmPlaySuccess(e)})).catch((function(i){return t._handleWarmPlayError(i,e,a,s)})))}};s()}},{key:"_handleWarmPlaySuccess",value:function(e){var t;e.pause(),e.buffering=!1,null===(t=this.debugTracker)||void 0===t||t.info("Prefetch warmup succeeded")}},{key:"_handleWarmPlayError",value:function(e,t,i,r){this.debugTracker&&("AbortError"===(null==e?void 0:e.name)?this._handleAbortError(t,i,r):"NotSupportedError"===(null==e?void 0:e.name)?this._handleNotSupportedError(e,t):this._handleGenericPlayError(e,t))}},{key:"_handleNotSupportedError",value:function(e,t){this.debugTracker.warn("Prefetch failed: video source not supported (".concat(e.message,"). Falling back to safe prefetch strategy.")),this._legacyWarmPlayDisabled=!0;try{t.load()}catch(e){this.debugTracker.warn("Safe fallback load() also failed:",(null==e?void 0:e.message)||e)}}},{key:"_handleGenericPlayError",value:function(e,t){this.debugTracker.warn("Prefetch warm play() failed: ".concat((null==e?void 0:e.name)||"Unknown"," - ").concat((null==e?void 0:e.message)||e));try{t.load()}catch(e){this.debugTracker.warn("Fallback load() failed:",(null==e?void 0:e.message)||e)}}},{key:"_handleAbortError",value:function(e,t,i){this._legacyWarmPlayDisabled=!0,this.debugTracker.info("Warm play aborted by background/energy saver; will retry on visibility (legacy disabled for session)"),this._onVisibilityOnce((function(){!document.hidden&&e.paused&&t.tries<t.maxRetries&&(t.tries++,setTimeout(i,t.retryDelay))}))}},{key:"_onPrefetchVideoMetaData",value:function(e,t){t.duration<this.maxDurationLimit&&this._prefetchOverTempVideo(e)}},{key:"_prefetchOverTempVideo",value:function(e){var t,i=this;if(null===(t=this.debugTracker)||void 0===t||t.info("VpaidPrefetching._prefetchOverTempVideo()"),this.frameType===pt||this.frameType===ft){var r=(0,m.sk)();if(r&&r.document&&r.document.body){this.parentInstance&&"function"==typeof this.parentInstance._createBufferingVideo?this.parentInstance._createBufferingVideo(r,e):this._createBufferingVideo(r,e);var n=this.bufferingVideo;if(!this._shouldUseLegacyWarmPlay())return n.load(),this._addDisposableListener(n,"canplaythrough",(function(){var e;return null===(e=i.debugTracker)||void 0===e?void 0:e.info("Temp video prefetched (safe path)")}),{once:!0}),void this._onVisibilityOnce((function(){document.hidden||i._attemptWarmPlay(n)}));var o=n.play();o&&(this.fakePlayPromise=(0,m.ph)(o),this.fakePlayPromise.then((function(){var e;return null===(e=i.debugTracker)||void 0===e?void 0:e.info("Temp video warm-play ok")})).catch((function(e){return i._handleTempVideoPlayError(e,n)})))}}}},{key:"_handleTempVideoPlayError",value:function(e,t){if(this.debugTracker)if("AbortError"===(null==e?void 0:e.name))this._legacyWarmPlayDisabled=!0,this.debugTracker.info("Temp warm-play aborted; switching to safe prefetch for session");else if("NotSupportedError"===(null==e?void 0:e.name)){this.debugTracker.warn("Temp video prefetch failed: source not supported (".concat(e.message,"). Disabling legacy warm play.")),this._legacyWarmPlayDisabled=!0;try{t.load()}catch(e){this.debugTracker.warn("Temp video safe fallback load() failed:",(null==e?void 0:e.message)||e)}}else{this.debugTracker.warn("Temp warm-play failed: ".concat((null==e?void 0:e.name)||"Unknown"," - ").concat((null==e?void 0:e.message)||e));try{t.load()}catch(e){this.debugTracker.warn("Temp video fallback load() failed:",(null==e?void 0:e.message)||e)}}}},{key:"_createBufferingVideo",value:function(e,t){var i;this.bufferingVideo=e.document.createElement("video"),this.bufferingVideo.id="prefetchWrapper".concat(this.wrapperIndex),this.bufferingVideo.src=t||(null===(i=this.playingMediaFile)||void 0===i?void 0:i.mediaUrl),this.bufferingVideo.muted=!0,this.bufferingVideo.setAttribute("muted",""),this.bufferingVideo.setAttribute("playsinline",""),(0,m.iQ)(this.bufferingVideo,"buff-vid"),this.bufferingVideo.style.top="".concat(1*this.wrapperIndex,"px"),e.document.body.appendChild(this.bufferingVideo)}},{key:"pausePrefetchVideo",value:function(){var e;this.bufferingVideo&&(this.bufferingVideo.pause(),null===(e=this.debugTracker)||void 0===e||e.info("VpaidPrefetching.pausePrefetchVideo()"))}},{key:"_destroyPrefetchVideo",value:function(){var e;this.bufferingVideo&&this.bufferingVideo.parentElement&&(this.bufferingVideo.pause(),this.bufferingVideo.removeAttribute("src"),this.bufferingVideo.load(),this.bufferingVideo.parentElement.removeChild(this.bufferingVideo),null===(e=this.debugTracker)||void 0===e||e.info("VpaidPrefetching._destroyPrefetchVideo()"))}},{key:"stopPrefetching",value:function(){var e;this.bufferingVideo&&(null===(e=this.debugTracker)||void 0===e||e.info("VpaidPrefetching -> stopPrefetching() -> _destroyPrefetchVideo()"),this._destroyPrefetchVideo()),this._disposeAll()}},{key:"setPlayingMediaFile",value:function(e){this.playingMediaFile=e}}],t&&ut(e.prototype,t),i&&ut(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function gt(e){return gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gt(e)}function _t(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,bt(r.key),r)}}function bt(e){var t=function(e,t){if("object"!=gt(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=gt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==gt(t)?t:t+""}var At=function(){return e=function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(0,j.mixin)(this),this.watchVideoInterval=r.get("wtchvdointrvl"),this.unitPredictorsInterval=r.get("rprtvidsttsintrvl"),this.newCompletionByVideoProgress=r.get("q5byprgrss"),this.isMobile=r.get("isMobile")||!1,this.timeoutLengthToAdCompletion=t.tag.getValueByKey("".concat(this.isMobile?"mbl":"dsk","tmouttoadcmpltn")),this.newCompletionByVideoProgressFired=!1,this.wrapperIndex=t.wrapperIndex,this.debugTracker=t.debugTracker,this.stopped=!1,this.viewabilityCalcFallbackEnabled=t.tag.getValueByKey("vwclcflbkenbld"),this.store=r,this.prefetching=new mt(t,r,this)},(t=[{key:"prefetchVideo",value:function(e,t){this.prefetching.setPlayingMediaFile(this.playingMediaFile),this.prefetching.prefetchVideo(e,t,this.video)}},{key:"pausePrefetchVideo",value:function(){this.prefetching.pausePrefetchVideo()}},{key:"_setIsIOS",value:function(e){this.prefetching.isIOS=e}},{key:"resumeAd",value:function(){this.stopped||(this.activeVideoElement&&this.watchVideoInterval&&this.activeVideoElement.duration?(this._emitCurrentTime((0,m.vZ)(this.activeVideoElement),this.activeVideoElement.duration),this.watchActiveVideoElement(),this._checkVideoProgress()):this._manuallyReportTimeProgress())}},{key:"_checkVideoProgress",value:function(){var e=this;setTimeout((function(){e.stopped||(e.activeVideoElement||0===(0,m.vZ)(e.activeVideoElement))&&(e.manualCurrentVideoTime||(e.manualCurrentVideoTime=.05,e._emitCurrentTime(e.manualCurrentVideoTime)),e._manuallyReportTimeProgress())}),50)}},{key:"_manuallyReportTimeProgress",value:function(){var e=this;this.stopped||!this.viewabilityCalcFallbackEnabled||this.manualTimeReportingInterval||(void 0===this.manualCurrentVideoTime&&(this.manualCurrentVideoTime=0,this._emitCurrentTime(this.manualCurrentVideoTime)),this.manualTimeReportingInterval=setInterval((function(){e.stopped||(e._emitCurrentTime(e.manualCurrentVideoTime),e.manualCurrentVideoTime+=.05)}),50))}},{key:"_emitCurrentTime",value:function(e,t){var i={currentTime:e.toFixed(3)};t&&(i.duration=t.toFixed(3)),this.emit("activeAdCurrentTime",i)}},{key:"pauseAd",value:function(){this.activeVideoElement&&this.watchVideoInterval?this.unwatchActiveVideoElement():this._stopManualTimeReportingInterval()}},{key:"stopAd",value:function(){this.stopped||(this.debugTracker.info("Vpaid -> stopAd()"),this.activeVideoElement&&this.watchVideoInterval&&this.unwatchActiveVideoElement(),this._stopManualTimeReportingInterval(),this.prefetching.stopPrefetching())}},{key:"_fireAdImpression",value:function(){this._onAdImpression()}},{key:"_onAdImpression",value:function(){this.stopped||(this.activeVideoElement=this.getActiveVideoElement())}},{key:"watchActiveVideoElement",value:function(){this._sampleVideoCurrentTimeIntervalId||(this._sampleVideoCurrentTimeIntervalId=setInterval(this._sampleVideoCurrentTimeHandler.bind(this),50))}},{key:"unwatchActiveVideoElement",value:function(){this._sampleVideoCurrentTimeIntervalId&&(clearInterval(this._sampleVideoCurrentTimeIntervalId),this._sampleVideoCurrentTimeIntervalId=void 0)}},{key:"_sampleVideoCurrentTimeHandler",value:function(){this.reportCurrentTimeToUnitPredictors(),this.testNewCompletion()}},{key:"reportCurrentTimeToUnitPredictors",value:function(){if(this.unitPredictorsInterval&&(0,m.vZ)(this.activeVideoElement)&&this.activeVideoElement.duration){var e=Math.floor(1e3*(0,m.vZ)(this.activeVideoElement)/this.unitPredictorsInterval);e&&this._currentIntervalMultiplier!==e&&(this._currentIntervalMultiplier=e,this._emitCurrentTime((0,m.vZ)(this.activeVideoElement),this.activeVideoElement.duration))}}},{key:"testNewCompletion",value:function(){this.newCompletionByVideoProgress&&!this.newCompletionByVideoProgressFired&&1e3*(0,m.vZ)(this.activeVideoElement)>this.timeoutLengthToAdCompletion&&(this.emit(Le),this.newCompletionByVideoProgressFired=!0)}},{key:"getActiveVideoElementDuration",value:function(){return this.activeVideoElement?this.activeVideoElement.duration:null}},{key:"onComplete",value:function(){this._stopManualTimeReportingInterval(),this.prefetching.stopPrefetching()}},{key:"_stopManualTimeReportingInterval",value:function(){this.manualTimeReportingInterval&&(this.manualTimeReportingInterval=clearInterval(this.manualTimeReportingInterval))}},{key:"getActiveVideoElement",value:function(){return this.activeVideoElement||this.video}}])&&_t(e.prototype,t),i&&_t(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function Et(e){return Et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Et(e)}function Tt(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,kt(r.key),r)}}function kt(e){var t=function(e,t){if("object"!=Et(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Et(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Et(t)?t:t+""}function wt(e,t,i){return t=Ot(t),function(e,t){if(t&&("object"==Et(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,St()?Reflect.construct(t,i||[],Ot(e).constructor):t.apply(e,i))}function St(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(St=function(){return!!e})()}function Pt(e,t,i,r){var n=It(Ot(1&r?e.prototype:e),t,i);return 2&r&&"function"==typeof n?function(e){return n.apply(i,e)}:n}function It(){return It="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Ot(e)););return e}(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}},It.apply(null,arguments)}function Ot(e){return Ot=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ot(e)}function Dt(e,t){return Dt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Dt(e,t)}var Ct="progress",Vt=function(e){function t(e,i,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=wt(this,t,[e,i,r])).adElasticLogger=i,n.store=r,n.target=e.slot,n.video=e.videoSlot,n.mediaFiles=e.vpaidFiles,n.mediaFile,n.mediaUrl,n.playerWidth=0,n.playerhHeight=0,n.adVolume=0,n.skipTime=60,n.eventsToFire={adLoaded:!1,adImpression:!1},n.adPaused=!0,n.playerReady=!1,n.videoLength=0,n.vpaidEvents=Object.assign({},ke.A),n._createBindedCallback(),n.playerDAST=e.playerDAST,n.tag=e.tag,e.trackingPixelManager.hasPixels(Ct)&&(n.progressEvents=e.trackingPixelManager.getPixels(Ct)),n.store.on("stop",(function(){n.stopAd()})),n.firstPauseAd=!0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dt(e,t)}(t,e),i=t,(r=[{key:"subscribe",value:function(e,t){this.vpaidEvents[t]&&this.on(t,e)}},{key:"unsubscribe",value:function(e,t){this.vpaidEvents[t]&&void 0!==e&&this.off(t,e)}},{key:"handshakeVersion",value:function(){return"1.1"}},{key:"initAd",value:function(e,t,i){this.stopped||(this.resizeAd(e,t,i),this._prepareVideoTag())}},{key:"resizeAd",value:function(e,t,i,r){this.stopped||(this.playerWidth=parseInt(e),this.playerhHeight=parseInt(t),this.video.style.width="".concat(this.playerWidth,"px"),this.target.style.width="".concat(this.playerWidth,"px"),this.video.style.height="".concat(this.playerhHeight,"px"),this.target.style.height="".concat(this.playerhHeight,"px"),this.video.setAttribute("width",this.playerWidth),this.target.setAttribute("width",this.playerWidth),this.video.setAttribute("height",this.playerhHeight),this.target.setAttribute("height",this.playerhHeight),this._resizeAd(this.playerWidth,this.playerhHeight,i,r))}},{key:"startAd",value:function(){this._bindedOnPlay(),this.startAdFired=!0}},{key:"_onStartAd",value:function(){this.debugTracker.info("VideoVpaid -> startAd()"),this._fireAdImpression(),this.debugTracker.info("VideoVpaid -> startad() -> _fireAdImpression()")}},{key:"pauseAd",value:function(){this.debugTracker.info("VideoVpaid -> pauseAd()"),Pt(t,"pauseAd",this,3)([]),this.stopped||(this.video.pause(),this.firstPauseAd&&(this.debugTracker.info("VideoVpaid -> pauseAd() - reset currentTime"),this.video.currentTime=0,this.firstPauseAd=!1,this.video.buffering=!1))}},{key:"resumeAd",value:function(){if(Pt(t,"resumeAd",this,3)([]),!this.stopped&&(this._sendAdPlayingOnProgress=!0,this.video.play(),!this.store.get("ads_started_fired"))){var e=new Event("AdResume");dispatchEvent(e),this.emit(this.vpaidEvents.AdVideoResume)}}},{key:"stopAd",value:function(){Pt(t,"stopAd",this,3)([]),this.stopped||(this.stopped=!0,this.video.destroy(),this._disconnectFromVideoTag(),this.adElasticLogger=this.store=this.mediaFiles=this.target=this.video=this._onError=this.isReplayable=this.eventsToFire=this.progressEvents=void 0,setTimeout(this.onAfterStop,50))}},{key:"restartAd",value:function(){}},{key:"skipAd",value:function(){this.stopped||(this.emit(this.vpaidEvents.AdSkipped),this.stopAd())}},{key:"expandAd",value:function(){}},{key:"collapseAd",value:function(){}},{key:"getAdVolume",value:function(e){e&&e(null,this.adVolume)}},{key:"getAdDuration",value:function(){return this.video&&this.video.duration||this.videoLength}},{key:"getAdRemainingTime",value:function(){return this.stopped?0:this.video.remainingTime}},{key:"getAdWidth",value:function(){return this.video.videoWidth}},{key:"getAdHeight",value:function(){return this.video.videoHeight}},{key:"getAdIcons",value:function(){return[]}},{key:"getAdCompanions",value:function(){return[]}},{key:"getAdExpanded",value:function(){return!0}},{key:"getAdLinear",value:function(){return!0}},{key:"setAdVolume",value:function(e){this.stopped||(this.video.volume=this.adVolume=parseFloat(e)<=1?e:parseInt(e)/100,this.video.muted=0==e)}},{key:"_connectToVideoTag",value:function(){this.stopped||(this.video.addEventListener("canplay",this._bindedOnCanPlay,!0),this.video.addEventListener("durationchange",this._bindedOnDurationChange,!0))}},{key:"_connectVideoEvents",value:function(){this.stopped||(this.video.addEventListener("play",this._bindedOnPlay,!0),this.video.addEventListener("playing",this._bindedOnPlaying,!0),this.video.addEventListener("pause",this._bindedOnPause,!0),this.video.addEventListener("ended",this._bindedOnComplete,!0),this.video.addEventListener("error",this._bindedOnPlayerError,!0),this.video.addEventListener("click",this._bindedOnClickThru,!0),this.video.addEventListener("volumechange",this._bindedOnVolumeChange,!0),this.video.addEventListener("timeupdate",this._bindedOnTimeUpdate,!0),this.video.addEventListener("firstQuartile",this._bindedOnProgress,!0),this.video.addEventListener("midpoint",this._bindedOnProgress,!0),this.video.addEventListener("thirdQuartile",this._bindedOnProgress,!0),this.video.addEventListener("timeProgress",this._bindedOnProgress,!0))}},{key:"_disconnectFromVideoTag",value:function(){this.video.removeEventListener("canplay",this._bindedOnCanPlay,!0),this.video.removeEventListener("play",this._bindedOnPlay,!0),this.video.removeEventListener("playing",this._bindedOnPlaying,!0),this.video.removeEventListener("pause",this._bindedOnPause,!0),this.video.removeEventListener("ended",this._bindedOnComplete,!0),this.video.removeEventListener("error",this._bindedOnPlayerError,!0),this.video.removeEventListener("click",this._bindedOnClickThru,!0),this.video.removeEventListener("volumechange",this._bindedOnVolumeChange,!0),this.video.removeEventListener("timeupdate",this._bindedOnTimeUpdate,!0),this.video.removeEventListener("firstQuartile",this._bindedOnProgress,!0),this.video.removeEventListener("midpoint",this._bindedOnProgress,!0),this.video.removeEventListener("thirdQuartile",this._bindedOnProgress,!0),this.video.removeEventListener("timeProgress",this._bindedOnProgress,!0),this.video.removeEventListener("durationchange",this._bindedOnDurationChange,!0),this._bindedOnCanPlay=this._bindedOnPlay=this._bindedOnPause=this._bindedOnComplete=this._bindedOnPlayerError=this._bindedOnVolumeChange=this._bindedOnTimeUpdate=this._bindedOnProgress=this._bindedOnDurationChange=this._bindedOnPlaying=this._bindedOnPlaying=this._bindedOnClickThru=void 0}},{key:"_loadVideoTagSources",value:function(){this.stopped||(this.playingMediaFile=this.video.appendVideoSources(this.mediaFiles),this.playingMediaFile&&(this.mediaUrl=this.playingMediaFile.mediaUrl,this.debugTracker.time("[VpaidWrapper".concat(this.wrapperIndex,"] video.src->onCanPlay")),this.playerDAST.set({vu:this.playingMediaFile.mediaUrl,vbr:this.playingMediaFile.bitrate,vwd:this.playingMediaFile.width,vht:this.playingMediaFile.height,ot:this.playingMediaFile.originalType,st:this.playingMediaFile.subType})))}},{key:"_createBindedCallback",value:function(){this._bindedOnCanPlay=this._onCanPlay.bind(this),this._bindedOnPause=this._onPause.bind(this),this._bindedOnComplete=this._onComplete.bind(this),this._bindedOnPlayerError=this._onPlayerError.bind(this),this._bindedOnVolumeChange=this._onVolumeChange.bind(this),this._bindedOnTimeUpdate=this._onTimeUpdate.bind(this),this._bindedOnProgress=this._onProgress.bind(this),this._bindedOnDurationChange=this._onDurationChange.bind(this),this._bindedOnPlay=this._onPlay.bind(this),this._bindedOnPlaying=this._onPlaying.bind(this),this._bindedOnClickThru=this._onClickThru.bind(this)}},{key:"_onCanPlay",value:function(){this.stopped||(this.videoLength=this.video.duration,this.adElasticLogger.logCanPlay(),this.logVideoBuffer("Canplay"),this.playerReady||(this.playerReady=!0,this.debugTracker.info("VideoVpaid -> onCanPlay() -> _fireAdLoaded()"),this._fireAdLoaded(),this.debugTracker.timeEnd("[VpaidWrapper".concat(this.wrapperIndex,"] video.src->onCanPlay")),this.adPaused||(this._fireAdImpression(),this.debugTracker.info("VideoVpaid -> onCanPlay() -> _fireAdImpression() because !adPaused"))))}},{key:"_onPlay",value:function(e,t){this.debugTracker.info("VideoVpaid -> onPlay()"),this.stopped||(this.adPaused?(this.adPaused=!1,e&&(this.debugTracker.info("VideoVpaid -> onPlay() -> before setTimeout(_fireAdImpression()) in ".concat(t," ms")),setTimeout(function(){this._fireAdImpression(),this.debugTracker.info("VideoVpaid -> onPlay() -> setTimeout(_fireAdImpression())")}.bind(this),t))):this._sendAdPlayingOnProgress=!0)}},{key:"_onPlaying",value:function(e){this._conditionalDispatchAdPlaying()}},{key:"_conditionalDispatchAdPlaying",value:function(){this._sendAdPlayingOnProgress&&(this.emit(this.vpaidEvents.AdPlaying),this._sendAdPlayingOnProgress=!1)}},{key:"_onPause",value:function(){this.stopped||(this.adPaused=!0,parseInt((0,m.vZ)(this.video))<parseInt(this.video.duration)&&this.emit(this.vpaidEvents.AdPaused))}},{key:"_onComplete",value:function(){this.stopped||(this.emit(this.vpaidEvents.AdVideoComplete),this.stayAlive||this.emit(this.vpaidEvents.AdStopped),Pt(t,"onComplete",this,3)([]))}},{key:"_onPlayerError",value:function(){this.stopped||--this.video.relevantSources>0||this.emit(this.vpaidEvents.AdError)}},{key:"_onVolumeChange",value:function(){this.stopped||this.emit(this.vpaidEvents.AdVolumeChange,{eventData:{volume:this.video.volume}})}},{key:"_onTimeUpdate",value:function(){this.stopped||(this.videoLength=this.getAdDuration(),this.videoLength&&this._conditionalDispatchAdPlaying())}},{key:"_onDurationChange",value:function(){this.stopped||this.emit(this.vpaidEvents.AdDurationChange)}},{key:"_onClickThru",value:function(e){e?(this._sendAdPlayingOnProgress=!0,this.video.play()):(this.emit(this.vpaidEvents.AdClickThru,{eventData:{playerHandles:!0}}),this.video.pause())}},{key:"_registerToProgressEvent",value:function(){this.progressEvents&&this.video.registerProgressEvents(this.progressEvents)}},{key:"_fireAdLoaded",value:function(){this.eventsToFire.adLoaded||this.emit(this.vpaidEvents.AdLoaded),this.eventsToFire.adLoaded=!0}},{key:"_fireAdImpression",value:function(){Pt(t,"_fireAdImpression",this,3)([]),this.stopped||this.eventsToFire.adImpression||(this.emit(this.vpaidEvents.AdVideoStart),this.emit(this.vpaidEvents.AdImpression),this.debugTracker.timeEnd("[VpaidWrapper".concat(this.wrapperIndex,"] startAd->impression")),this.eventsToFire&&(this.eventsToFire.adImpression=!0),this.adPaused=!1,this._registerToProgressEvent())}},{key:"_onProgress",value:function(e){"firstQuartile"===e.type?this.emit(this.vpaidEvents.AdVideoFirstQuartile):"midpoint"===e.type?this.emit(this.vpaidEvents.AdVideoMidpoint):"thirdQuartile"===e.type?this.emit(this.vpaidEvents.AdVideoThirdQuartile):"timeProgress"===e.type&&this._onTimeProgressEvent(e.data)}},{key:"_onTimeProgressEvent",value:function(e){for(var t=0;t<this.progressEvents.length;t++)this.progressEvents[t].fired||this.progressEvents[t].offset<=("time"===this.progressEvents[t].offsetType?e.time:e.pre)&&(this.progressEvents[t].fired=!0,this.emit(this.vpaidEvents.Progress,{eventData:this.progressEvents[t]}),this.progressEvents.splice(t,1))}},{key:"getDOMContainer",value:function(){return this.target}},{key:"getVideoUrl",value:function(){return this.stopped?"":this.video.getSrc()}},{key:"dontDie",value:function(){this.stayAlive=!0}},{key:"onAfterStop",value:function(){}},{key:"logVideoBuffer",value:function(e){this.adElasticLogger.logVideoBuffer(e,this.video.bufferSize)}},{key:"_prepareVideoTag",value:function(){}},{key:"_getMediaUrl",value:function(){return this.mediaUrl}},{key:"_resizeAd",value:function(e,t,i,r){}},{key:"getActiveVideoElement",value:function(){return this.video}},{key:"getMediaType",value:function(){return this.isOMID?6:1}},{key:"isOMID",get:function(){return this._isOMID},set:function(e){this._isOMID=e}}])&&Tt(i.prototype,r),n&&Tt(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,r,n}(At);function Rt(e){return Rt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rt(e)}function Lt(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Mt(r.key),r)}}function Mt(e){var t=function(e,t){if("object"!=Rt(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Rt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Rt(t)?t:t+""}function xt(e,t,i){return t=Ut(t),function(e,t){if(t&&("object"==Rt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ft()?Reflect.construct(t,i||[],Ut(e).constructor):t.apply(e,i))}function Ft(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ft=function(){return!!e})()}function Nt(e,t,i,r){var n=Bt(Ut(1&r?e.prototype:e),t,i);return 2&r&&"function"==typeof n?function(e){return n.apply(i,e)}:n}function Bt(){return Bt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Ut(e)););return e}(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}},Bt.apply(null,arguments)}function Ut(e){return Ut=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ut(e)}function Wt(e,t){return Wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Wt(e,t)}var jt=function(e){function t(e,i,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=xt(this,t,[e,i,r]),window.setTimeout(e.onReady,0),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wt(e,t)}(t,e),i=t,(r=[{key:"startAd",value:function(){this.video.play(),Nt(t,"startAd",this,3)([])}},{key:"_onCanPlay",value:function(){this.playerReady||this.video.pause(),Nt(t,"_onCanPlay",this,3)([])}},{key:"_onPlay",value:function(){this.startAdFired&&Nt(t,"_onPlay",this,3)([this.playerReady,200])}},{key:"_onClickThru",value:function(){this.stopped||(this.store.set("forcePause",!1),Nt(t,"_onClickThru",this,3)([this.adPaused]))}},{key:"_prepareVideoTag",value:function(){this.stopped||(this.debugTracker.info("VideoVpaidDesk -> _prepareVideoTag()"),this.video.removeAttribute("controls"),this._connectToVideoTag(),this._connectVideoEvents(),this._loadVideoTagSources())}},{key:"isReplayable",value:function(){return!0}},{key:"dontDie",value:function(){this.stayAlive=!0}}])&&Lt(i.prototype,r),n&&Lt(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,r,n}(Vt);function Ht(e){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ht(e)}function Gt(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,qt(r.key),r)}}function qt(e){var t=function(e,t){if("object"!=Ht(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Ht(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ht(t)?t:t+""}function zt(e,t,i){return t=Xt(t),function(e,t){if(t&&("object"==Ht(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Qt()?Reflect.construct(t,i||[],Xt(e).constructor):t.apply(e,i))}function Qt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Qt=function(){return!!e})()}function Kt(e,t,i,r){var n=Yt(Xt(1&r?e.prototype:e),t,i);return 2&r&&"function"==typeof n?function(e){return n.apply(i,e)}:n}function Yt(){return Yt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Xt(e)););return e}(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}},Yt.apply(null,arguments)}function Xt(e){return Xt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Xt(e)}function Jt(e,t){return Jt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Jt(e,t)}var Zt=function(e){function t(e,i,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=zt(this,t,[e,i,r])).firstResumeAd=!0,n._initVpaid(e),window.setTimeout(e.onReady,0),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Jt(e,t)}(t,e),i=t,r=[{key:"initAd",value:function(e,i,r){Kt(t,"initAd",this,3)([e,i,r])}},{key:"startAd",value:function(){this.debugTracker.info("VideoVpaidMob -> startAd()"),this.debugTracker.time("[VpaidWrapper".concat(this.wrapperIndex,"] startAd->impression")),this._onStartAd(this)}},{key:"resizeAd",value:function(e,i,r,n){Kt(t,"resizeAd",this,3)([e,i,r,n]),this.video.resize&&this.video.resize(e,i,n)}},{key:"stopAd",value:function(){this.stopped||(this.timeUpdateInterval=clearTimeout(this.timeUpdateInterval),Kt(t,"stopAd",this,3)([]))}},{key:"_createBindedCallback",value:function(){Kt(t,"_createBindedCallback",this,3)([]),this._bindedOnPlaying=this._onPlaying.bind(this)}},{key:"_prepareVideoTag",value:function(){this.stopped||(this.video.removeAttribute("controls"),this._connectToVideoTag(),this._loadVideoTagSources(),this.prefetchVideo("video",this.mediaUrl),this.video.muted=!0,this.video.setAttribute("playsinline",""),this.isIOS&&this.video.load())}},{key:"_connectToVideoTag",value:function(){this.stopped||(this.slowConnectionLength>0&&(this.slowConnectionTimeout=setTimeout(this._onSlowConnecionDetected.bind(this),1e3*this.slowConnectionLength)),Kt(t,"_connectToVideoTag",this,3)([]),this.video.addEventListener("playing",this._bindedOnPlaying,!0),this.isIOS&&this.clickableTarget&&this.clickableTarget.addEventListener("click",this._bindedOnClickThru,!0))}},{key:"_disconnectFromVideoTag",value:function(){this.video.removeEventListener("playing",this._bindedOnPlaying,!0),this.isIOS&&this.clickableTarget&&this.clickableTarget.removeEventListener("click",this._bindedOnClickThru,!0)}},{key:"_loadVideoTagSources",value:function(){this.stopped||(this._sortMediaFiles(),Kt(t,"_loadVideoTagSources",this,3)([]))}},{key:"_onPlaying",value:function(){this.stopped||(this.eventsToFire.adImpression&&(this.adPaused=!1),this.adElasticLogger.logVideoPlaying((0,m.vZ)(this.video)))}},{key:"_onPlay",value:function(){var e=this;if(!this.stopped){if(this.debugTracker.info("VideoVpaidMob -> onPlay()"),this.video.play(),this.startAdFired)return this.emit(this.vpaidEvents.AdPlaying),!0;this.emit(this.vpaidEvents.AdVideoStart),Kt(t,"_onPlay",this,3)([!0,2e3]),this.timeUpdateInterval=setInterval((function(){e.stopped||e._onTimeUpdate()}),250)}}},{key:"_onPlayerError",value:function(){Kt(t,"_onPlayerError",this,3)([])}},{key:"_onClickThru",value:function(e){if(e.preventDefault(),e.stopPropagation(),!this.stopped){if(this.isIOS){var i=(new Date).getTime();if(null!==this.lastClickTime&&i-this.lastClickTime<=100)return;this.lastClickTime=i}Kt(t,"_onClickThru",this,3)([this.adPaused])}}},{key:"_onCanPlay",value:function(){this.stopped||(this.slowConnectionTimeout=clearTimeout(this.slowConnectionTimeout),this._preventAdLoadIfVideoBufferTooShort()||Kt(t,"_onCanPlay",this,3)([]))}},{key:"isReplayable",value:function(){return!0}},{key:"_initVpaid",value:function(e){this.videoLength=e.extra.duration||30,this.clickableTarget=e.clickableTarget||null,this.tag=e.tag,this.lastClickTime=null,this.isIOS=this.store.get("wurfl.os.name")===me,this.isIOS&&(this.slowConnectionLength=this.store.get("slwcnctlngt")||0,this.minBufferSize=this.store.get("mnbfrsz")||1)}},{key:"_sortMediaFiles",value:function(){var e=this.playerWidth;this.mediaFiles.sort((function(t,i){return Math.abs(e-t.width)-Math.abs(e-i.width)})).sort((function(e,t){return e.bitRate-t.bitRate}))}},{key:"_resizeAd",value:function(e,t){this.newVidCreated&&this.newVid&&(this.newVid.style.width="".concat(e,"px"),this.newVid.style.height="".concat(t,"px"))}},{key:"resumeAd",value:function(){this.debugTracker.info("VideoVpaidMob -> resumeAd()"),this.firstResumeAd&&(this.debugTracker.info("VideoVpaidMob -> first resumeAd()"),this.isIOS?this._handleIOSFirstResumeAd():this._handleAndroidFirstResumeAd(),this._connectVideoEvents(),this.firstResumeAd=!1),Kt(t,"resumeAd",this,3)([])}},{key:"_handleIOSFirstResumeAd",value:function(){this.pausePrefetchVideo()}},{key:"_handleAndroidFirstResumeAd",value:function(){this.video.buffered&&this.video.buffered.length>0&&this.video.buffered.end(0)&&this.debugTracker.info("VideoVpaidMob -> startAd() - video currentTime:".concat((0,m.vZ)(this.video),"; buffered:").concat(this.video.buffered.end(0)," sec")),this.video.currentTime=0}},{key:"_onSlowConnecionDetected",value:function(){this.stopped||(this.slowConnectionDetected=!0,this.emit(this.vpaidEvents.SlowConnection),this.emit(this.vpaidEvents.AdStopped))}},{key:"_preventAdLoadIfVideoBufferTooShort",value:function(){return!!this._isBufferTooShort()&&(this._onSlowConnecionDetected(),!0)}},{key:"_isBufferTooShort",value:function(){var e=this.slowConnectionLength>0,t=this.video.buffered&&this.video.buffered.length>0;return e&&t&&this.video.buffered.end(0)<this.minBufferSize}}],r&&Gt(i.prototype,r),n&&Gt(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,r,n}(Vt);function $t(e){return $t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$t(e)}function ei(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ti(r.key),r)}}function ti(e){var t=function(e,t){if("object"!=$t(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=$t(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==$t(t)?t:t+""}var ii=function(){return e=function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(0,j.mixin)(this),this.iframe=t,this.channel=void 0,this.sid=void 0,this.store=i,this.protocol=this.store.get("httpsOverride")?"https:":window.location.protocol||"http:"},(t=[{key:"listenToMessages",value:function(){this.iframe.contentWindow.addEventListener("message",this.onmessage.bind(this))}},{key:"removeMessagesListener",value:function(){this.iframe.contentWindow.removeEventListener("message",this.onmessage.bind(this))}},{key:"onmessage",value:function(e){if(e){var t={};try{t=JSON.parse(e.data.replace("ima://",""))}catch(e){return}"initAd"===t.type&&this.emit("clickThruUrlFound",t.clickThroughUrl),"viewabilityMeasurement"!==t.type&&(void 0!==t.channel&&void 0===this.channel&&(this.channel=t.channel),void 0!==t.sid&&"*"!==t.sid&&void 0===this.sid&&(this.sid=t.sid)),void 0!==this.channel&&void 0!==this.sid&&this.removeMessagesListener()}}},{key:"callApi",value:function(e,t){if(this.channel&&this.sid&&this.iframe){var i={name:"adsManager",type:e.replace("Ad",""),sid:this.sid,channel:this.channel};"volume"==e&&(i.data={volume:t});var r="\n                    const ifrms = document.querySelectorAll('iframe');\n\n                    ifrms.forEach(ifrm => {\n                        if (ifrm.src.indexOf('imasdk.googleapis.com') > -1 && ifrm.src.indexOf('bridge') > -1 && (ifrm.src.indexOf('#".concat(this.sid,"') > -1 || ifrm.src.indexOf('#").concat(this.channel,"') > -1)) {\n                            ifrm.contentWindow.postMessage('ima://").concat((0,m.As)(i),"', '").concat(this.protocol,"//imasdk.googleapis.com');\n                        }\n                    });\n                ");(0,m._o)(this.iframe.contentWindow,r)}}}])&&ei(e.prototype,t),i&&ei(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function ri(e){return ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ri(e)}function ni(){}var oi={};function ai(e){var t=oi[e];t&&(clearTimeout(t),delete oi[e])}function si(e,t,i){var r=document.createElement("iframe");return r.src=t||"about:blank",r.className="cm-vpaid-iframe",r.marginWidth="0",r.marginHeight="0",r.frameBorder="0",r.width="100%",r.height="100%",i&&(r.style.zIndex=i),r.setAttribute("SCROLLING","NO"),e.innerHTML="",e.appendChild(r),r}function li(e,t){return Object.keys(t).forEach((function(i){var r=t[i];"object"===ri(r)&&(r=JSON.stringify(r)),e=e.replace(new RegExp("{{".concat(i,"}}"),"g"),r)})),e}function di(e,t){var i=e.contentWindow&&e.contentWindow.document;return!!i&&(i.write(t),!0)}const ui={noop:ni,validate:function(e,t){return e?null:new Error(t)},clearCallbackTimeout:ai,callbackTimeout:function(e,t,i){var r,n;return n=setTimeout((function(){t=ni,delete n[r],i()}),e),oi[r=function(){t.apply(this,arguments)&&ai(r)}]=n,r},createElementInEl:function(e,t,i){var r=document.createElement(t);return i&&(r.id=i),e.appendChild(r),r},createIframeWithContent:function(e,t,i){var r=si(e,null,i.zIndex);if(di(r,li(t,i)))return r},createIframe:si,setFullSizeStyle:function(e){e.style.position="absolute",e.style.left="0",e.style.top="0",e.style.margin="0px",e.style.padding="0px",e.style.border="none",e.style.width="100%",e.style.height="100%"},simpleTemplate:li,setIframeContent:di,extend:function(e,t){return Object.keys(t).forEach((function(i){e[i]=t[i]})),e},unique:function(e){var t=-1;return function(){return"".concat(e,"_").concat(++t)}}};var ci=["handshakeVersion","initAd","startAd","stopAd","skipAd","resizeAd","pauseAd","resumeAd","expandAd","collapseAd","subscribe","unsubscribe"];function hi(e,t,i){}hi.prototype.handshakeVersion=function(e,t){},hi.prototype.initAd=function(e,t,i,r,n,o,a){},hi.prototype.startAd=function(e){},hi.prototype.stopAd=function(e){},hi.prototype.skipAd=function(e){},hi.prototype.resizeAd=function(e,t,i,r){},hi.prototype.pauseAd=function(e){},hi.prototype.resumeAd=function(e){},hi.prototype.expandAd=function(e){},hi.prototype.collapseAd=function(e){},hi.prototype.subscribe=function(e,t,i){},hi.prototype.unsubscribe=function(e,t){},hi.prototype.getAdLinear=function(e){},hi.prototype.getAdWidth=function(e){},hi.prototype.getAdHeight=function(e){},hi.prototype.getAdExpanded=function(e){},hi.prototype.getAdSkippableState=function(e){},hi.prototype.getAdRemainingTime=function(e){},hi.prototype.getAdDuration=function(e){},hi.prototype.getAdVolume=function(e){},hi.prototype.getAdCompanions=function(e){},hi.prototype.getAdIcons=function(e){},hi.prototype.setAdVolume=function(e,t){},vi(hi,"METHODS",ci),vi(hi,"GETTERS",["getAdLinear","getAdWidth","getAdHeight","getAdExpanded","getAdSkippableState","getAdRemainingTime","getAdDuration","getAdVolume","getAdCompanions","getAdIcons"]),vi(hi,"SETTERS",["setAdVolume"]),vi(hi,"EVENTS",["AdLoaded","AdStarted","AdStopped","AdSkipped","AdSkippableStateChange","AdSizeChange","AdLinearChange","AdDurationChange","AdExpandedChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError"]);var pi=ci.filter((function(e){return-1===["skipAd"].indexOf(e)}));vi(hi,"checkVPAIDInterface",(function(e){return pi.every((function(t){return"function"==typeof e[t]}))}));const fi=hi;function vi(e,t,i){Object.defineProperty(e,t,{writable:!1,configurable:!1,value:i})}function yi(){this._subscribers={}}function mi(e,t){e.handler.call(e.context,t)}yi.prototype.subscribe=function(e,t,i){this.isHandlerAttached(e,t)||this.get(t).push({handler:e,context:i,eventName:t})},yi.prototype.unsubscribe=function(e,t){this._subscribers[t]=this.get(t).filter((function(t){return"*"!==e&&e!==t.handler}))},yi.prototype.unsubscribeAll=function(){this._subscribers={}},yi.prototype.trigger=function(e,t){for(var i=this.get(e),r=0;r<i.length;r++)mi(i[r],t)},yi.prototype.triggerSync=function(e,t){this.get(e).forEach((function(e){e.handler.call(e.context,t)}))},yi.prototype.get=function(e){return this._subscribers[e]||(this._subscribers[e]=[]),this._subscribers[e]||[]},yi.prototype.isHandlerAttached=function(e,t){return this.get(t).some((function(t){return e===t.handler}))};const gi=yi;fi.METHODS;var _i="AdClickThru",bi=fi.EVENTS.filter((function(e){return e!=_i}));function Ai(e,t,i,r){this._isValid=fi.checkVPAIDInterface(e),this._isValid&&(this._creative=e,this._el=t,this._videoEl=i,this._iframe=r,this._subscribers=new gi,ui.setFullSizeStyle(t),Ei.call(this))}function Ei(){if(bi.forEach(function(e){this._creative.subscribe(ki.bind(this,e),e)}.bind(this)),this._creative.subscribe(Ti.bind(this),_i),this._videoEl){var e=this._iframe.contentDocument.documentElement,t=this._videoEl;e.addEventListener("click",(function(i){i.target===e&&t.click()}))}}function Ti(e,t,i){this._subscribers.triggerSync(_i,{url:e,id:t,playerHandles:i})}function ki(e){this._subscribers.trigger(e,Array.prototype.slice.call(arguments).slice(1))}function wi(e,t,i,r){e?e(i,r):i&&t.trigger("AdError",i)}Ai.prototype=Object.create(fi.prototype),Ai.prototype.isValidVPAIDAd=function(){return this._isValid},fi.METHODS.forEach((function(e){-1===["subscribe","unsubscribe","initAd"].indexOf(e)&&(Ai.prototype[e]=function(){var t,i=fi.prototype[e].length,r=Array.prototype.slice.call(arguments),n=i===r.length?r.pop():void 0,o=null;try{t=this._creative[e].apply(this._creative,r)}catch(e){o=e}wi(n,this._subscribers,o,t)})})),Ai.prototype.initAd=function(e,t,i,r,n,o,a){var s;n=n||{},o=ui.extend({slot:this._el,videoSlot:this._videoEl},o||{});try{this._creative.initAd(e,t,i,r,n,o)}catch(e){s=e}wi(a,this._subscribers,s)},Ai.prototype.subscribe=function(e,t,i){this._subscribers.subscribe(t,e,i)},Ai.prototype.unsubscribe=function(e,t){this._subscribers.unsubscribe(t,e)},Ai.prototype.on=Ai.prototype.subscribe,Ai.prototype.off=Ai.prototype.unsubscribe,fi.GETTERS.forEach((function(e){Ai.prototype[e]=function(t){var i,r=null;try{i=this._creative[e]()}catch(e){r=e}wi(t,this._subscribers,r,i)}})),Ai.prototype.setAdVolume=function(e,t){var i;try{this._creative.setAdVolume(e),i=this._creative.getAdVolume()}catch(e){}wi(t,this._subscribers,null,i)},Ai.prototype._destroy=function(){this.stopAd(),this._subscribers.unsubscribeAll()};const Si=Ai;var Pi=ui.unique("vpaidIframe");function Ii(e,t,i,r,n){if(i=i||{},this._id=Pi(),this._destroyed=!1,this.store=n,e.classList.contains("_cm-yahoo-widget")){var o=document.querySelector("#_cm-iframes-wrapper");this._frameContainer=ui.createElementInEl(o,"div"),this._frameContainer.id="".concat(n.get("target_id"),"-vpaid-iframe-").concat(this._id)}else this._frameContainer=ui.createElementInEl(e,"div");this._frameContainer.style.position="initial",this._videoEl=t,this._vpaidOptions=r||{timeout:1e4},this._templateConfig={template:i.template||'<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"></head><body style="margin:0;padding:0"><div class="ad-element"></div><script type="text/javascript" src="{{iframeURL_JS}}"><\/script><script type="text/javascript">window.parent.postMessage(\'{"event": "ready", "id": "{{iframeID}}"}\', \'{{origin}}\');setTimeout(function () {try { if (window.top.onTaboolaVpaidJSVpaidIframeLoaded) { window.top.onTaboolaVpaidJSVpaidIframeLoaded(\'{"data":{"event": "ready", "id": "{{iframeID}}"}, "origin": "{{origin}}"}\'); } } catch (e) {}}, 100);<\/script></body></html>',extraOptions:i.extraOptions||{}}}function Oi(e){var t=this[e];t&&(t.remove&&t.remove(),delete this[e])}function Di(){Vi.call(this),delete this._adUnit}function Ci(){Vi.call(this),Li.call(this)}function Vi(){Oi.call(this,"_frame"),Ri.call(this)}function Ri(){this._onLoad&&(window.removeEventListener("message",this._onLoad),ui.clearCallbackTimeout(this._onLoad),delete this._onLoad)}function Li(){this._adUnit&&(this._adUnit.stopAd(),delete this._adUnit)}function Mi(){if(this._destroyed)throw new Error("VPAIDHTML5Client already destroyed!")}function xi(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}Ii.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,Ci.call(this))},Ii.prototype.isDestroyed=function(){return this._destroyed},Ii.prototype.loadAdUnit=function(e,t){Mi.call(this),Ci.call(this);var i=this,r=ui.createIframeWithContent(this._frameContainer,this._templateConfig.template,ui.extend({iframeURL_JS:e,iframeID:this.getID(),origin:xi()},this._templateConfig.extraOptions));if(this.store.get("msnifrmsrchk"))try{r._src=r.src,Object.defineProperty(r,"src",{get:function(){return r._src},set:function(e){}})}catch(e){}this._frame=r,this._onLoad=ui.callbackTimeout(this._vpaidOptions.timeout,function(e){if(e.origin!==xi())return;var r,n,o,a;try{r=JSON.parse(e.data)}catch(e){r={}}if(r.id!==i.getID())return;i._frame.contentWindow?(a=i._frame.contentWindow.getVPAIDAd,o=ui.validate("function"==typeof a,"the ad didn't return a function to create an ad")):o="the iframe is not anymore in the DOM tree";if(!o){var s=i._frame.contentWindow.document.querySelector(".ad-element");(n=new Si(a(),s,i._videoEl,i._frame)).subscribe("AdStopped",Di.bind(i)),o=ui.validate(n.isValidVPAIDAd(),"the add is not fully complaint with VPAID specification")}return i._adUnit=n,Ri.call(i),t(o,o?null:n),!0}.bind(this),function(){t("timeout",null)}.bind(this)),window.addEventListener("message",this._onLoad)},Ii.prototype.unloadAdUnit=function(){Ci.call(this)},Ii.prototype.getID=function(){return this._id};const Fi=Ii;function Ni(e){return Ni="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ni(e)}function Bi(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ui(r.key),r)}}function Ui(e){var t=function(e,t){if("object"!=Ni(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Ni(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ni(t)?t:t+""}function Wi(e,t,i){return t=qi(t),function(e,t){if(t&&("object"==Ni(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ji()?Reflect.construct(t,i||[],qi(e).constructor):t.apply(e,i))}function ji(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ji=function(){return!!e})()}function Hi(e,t,i,r){var n=Gi(qi(1&r?e.prototype:e),t,i);return 2&r&&"function"==typeof n?function(e){return n.apply(i,e)}:n}function Gi(){return Gi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=qi(e)););return e}(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}},Gi.apply(null,arguments)}function qi(e){return qi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},qi(e)}function zi(e,t){return zi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},zi(e,t)}var Qi=function(e){function t(e,i,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Wi(this,t,[e,i,r])).adElasticLogger=i,n.store=r,n.stopped=!1,n.target=e.slot,n.video=e.videoSlot,n.mediaFiles=e.vpaidFiles,n.mediaUrl,n.baseUrl=n.store.get("base_url"),n._onError=e.onError,n.vpaidEvents=Object.assign({},ke.A),n.volume=0,n.isMuted=!0,n.pauseVideoProtection=n.store.get("pusvidprtctn"),n.vpaidResourcesHandler=e.vpaidResourcesHandler,n.playerDAST=e.playerDAST,n.adSettings=e.adSettings,n.vpaidInit={},n.secureMediaFile=(0,m.VT)(r),n.tag=e.tag,n.store.on("stop",(function(){n.stopAd()})),n.minValidVideoDuration=n.store.get("mnvlddrtn"),n.adImpressionEvent=n.tag.getValueByKey("adimpevt"),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zi(e,t)}(t,e),i=t,r=[{key:"initAd",value:function(e,t,i,r,n,o){var a=this.mediaFiles[0];this.secureMediaFile&&(this.adElasticLogger.logShouldSecureUrl(a.url.indexOf("http:")>-1),a.url=a.url.replace("http:","https:")),this.playerDAST.set({vbr:a.bitrate,vwd:a.width,vht:a.height,ot:a.originalType,st:a.subType,vpu:a.url}),this.mediaUrl=a.url,this.debugTracker.info("Loading","Iframe was loaded!"),this._shouldHideTarget()&&(this.target.style.display="none");var s=this.tag.getValueByKey("aduntladtmt")||1e4,l=new Fi(this.target,this.video,{extraOptions:{zIndex:"1"}},{timeout:s},this.store);this.vpaid=l,this.vpaidInit={width:e,height:t,viewMode:i,bitRate:r,creativeData:n,environmentVars:o},l.loadAdUnit(this.mediaUrl,this._onLoadAdUnit.bind(this))}},{key:"handshakeVersion",value:function(e){return"2.0"}},{key:"resizeAd",value:function(e,t,i,r){this.stopped||(this.target.style.width="".concat(e,"px"),this.target.style.height="".concat(t,"px"),this.target.setAttribute("width",e),this.target.setAttribute("height",t),this._safeCall("resizeAd",[e,t,i]),this._resizeAd([e,t,r]))}},{key:"stopAd",value:function(){this._safeCall("stopAd",[]),window.setTimeout(this._stopAd.bind(this),1)}},{key:"pauseAd",value:function(){var e=this;Hi(t,"pauseAd",this,3)([]);var i=function(){};(this.pauseVideoProtection||this.adRestarted)&&(i=function(){!e.stopped&&e.video&&(e.adElasticLogger.logPauseProtection(e.video.paused,e.adRestarted),e.video.paused||e.video.pause())}),this.video.resumeInvoked=!1,this._safeCall("pauseAd",[i])}},{key:"resumeAd",value:function(e){var i=this;Hi(t,"resumeAd",this,3)([]);var r=function(){};e&&(r=function(){i.video.play()}),this.adSettings&&this.adSettings.hasOwnProperty("onrsm")&&this.adSettings.onrsm&&(r=this.adSettings.onrsm.bind(this)),this.video.resumeInvoked=!0,this._safeCall("resumeAd",[r])}},{key:"skipAd",value:function(){this._safeCall("skipAd",[])}},{key:"startAd",value:function(){this._safeCall("startAd",[])}},{key:"expandAd",value:function(){this._safeCall("expandAd",[])}},{key:"collapseAd",value:function(){this._safeCall("collapseAd",[])}},{key:"restartAd",value:function(e,t){if(!this.stopped)if(this.clickThruUrl=t,""===this._getVideoSrc(this.video)){if(!e)return;this.video.src=e,this._bindedOnRestartVideoLoad=this._onRestartVideoLoad.bind(this),this.video.addEventListener("canplay",this._bindedOnRestartVideoLoad),this.video.load()}else this._onRestartVideoLoad()}},{key:"subscribe",value:function(e,t){this.vpaidEvents[t]&&e&&this.on(t,e)}},{key:"unsubscribe",value:function(e,t){this.vpaidEvents[t]&&e&&this.off(t,e)}},{key:"getAdWidth",value:function(){return this._activeVideoElement?this._activeVideoElement.videoWidth:this._safeCall("getAdWidth",[])}},{key:"getAdHeight",value:function(){return this._activeVideoElement?this._activeVideoElement.videoHeight:this._safeCall("getAdHeight",[])}},{key:"getAdSkippableRemainingTime",value:function(){return this._safeCall("getAdSkippableRemainingTime",[])}},{key:"getAdRemainingTime",value:function(e){return this._safeCall("getAdRemainingTime",[e])}},{key:"getAdDuration",value:function(e){return this._safeCall("getAdDuration",[e])}},{key:"getAdSkippableState",value:function(){return this._safeCall("getAdSkippableState",[])}},{key:"getAdVolume",value:function(e){return this._safeCall("getAdVolume",[e])}},{key:"getAdIcons",value:function(e){this._safeCall("getAdIcons",[e])}},{key:"getAdCompanions",value:function(){return this._safeCall("getAdCompanions",[])}},{key:"getAdExpanded",value:function(){return this._safeCall("getAdExpanded",[])}},{key:"getAdLinear",value:function(){return this._safeCall("getAdLinear",[])}},{key:"setAdVolume",value:function(e){var t=this;this.volume=e,this.video.muted=this.isMuted=0===this.volume,this._safeCall("setAdVolume",[e,function(){t.adRestarted&&(t.video.volume=e,t.video.muted=0===e)}])}},{key:"isReplayable",value:function(){return this.video&&""!==this._getVideoSrc(this.video)}},{key:"getDOMContainer",value:function(){return this.target}},{key:"checkUnfriendlyIframe",value:function(){var e=(0,m.$e)(this.target);try{return e&&e.contentDocument,!1}catch(t){return src=e.src,this.adElasticLogger.logUnfriendlyIframeSource(src),!0}}},{key:"getVideoUrl",value:function(){if(this.stopped)return"";var e=this.getActiveVideoElement();return e?this._getVideoSrc(e):""}},{key:"getVPAIDVideoElement",value:function(){return this._activeVideoElement||null}},{key:"logVideoUrl",value:function(){var e=this.getVideoUrl();e&&(this.adElasticLogger.logVpaidVideoUrl(e),this.adElasticLogger.vpaidLog.friendlyVideoUrl=!0)}},{key:"toggleIframeContentDisplay",value:function(e){try{var t="none";"hide"===e?t="hidden":"show"===e&&(t="visible"),this.adUnit._iframe.contentWindow.document.body.style.visibility=t}catch(e){}}},{key:"setCompletionOnAdStoppedTimeout",value:function(){var e=this,t=this.tag.getValueByKey("cmpltonstpdms");t>0&&(this.completionOnAdStoppedTimeout||(this.completionOnAdStoppedTimeout=setTimeout((function(){e.stopped||e.emit(e.vpaidEvents.AdStopped)}),t)))}},{key:"onAfterStop",value:function(){}},{key:"_onLoadAdUnit",value:function(e,t){try{if(this.stopped)return;if(e)return void this._onLoadAdUnitError(e);this.adElasticLogger.logLoadAdUnit(),this.adUnit=t,(this.store.get("imapihok")||this.tag.nas)&&this._hookIMA(),this._bindIframe(t),this._bindAdUnitEvents(t),t.handshakeVersion("2.0",this._onHandshake.bind(this)),this._handleCompleteOnAdStopped()}catch(e){this.adElasticLogger.logLoadAdUnitErrorMessage(e.message)}}},{key:"_hookIMA",value:function(){var e=this;this.imaApi=new ii(this.adUnit._iframe,this.store),this.imaApi.on("clickThruUrlFound",(function(t){e.emit("clickThruUrlFound",t)})),this.imaApi.listenToMessages(),this.callIMAApi=this.imaApi.callApi.bind(this.imaApi)}},{key:"_onLoadAdUnitError",value:function(e){this.adElasticLogger.logLoadAdUnitError(),this.store&&this.store.get("aduntldflbfruntld")?this._onError(e,"adUnitLoadFailed"):this._onError()}},{key:"_onHandshake",value:function(){this.adUnit.initAd(this.vpaidInit.width,this.vpaidInit.height,this.vpaidInit.viewMode,-1,this.vpaidInit.creativeData,{})}},{key:"_handleCompleteOnAdStopped",value:function(){var e=this.store.get("cmpltonstpddmn");e&&e.length>0&&-1!=this.mediaUrl.search(new RegExp(e.join("|"),"i"))&&(this.completeOnAdStop=!0)}},{key:"_bindIframe",value:function(e){var t=e._iframe;this.vpaidResourcesHandler.inject(t,this),this._onBindIframe(t),this._loadAdditionalScripts()}},{key:"_bindAdUnitEvents",value:function(e){var t=this;for(var i in this.vpaidEvents)!function(i){e.subscribe(i,(function(e){t._allEventsHandler(i,e)}))}(i)}},{key:"_allEventsHandler",value:function(e,t){if(!this.stopped){if(this._shouldHideTarget()&&"block"!==this.target.style.display&&(this.target.style.display="block"),this.adImpressionEvent){if(e===this.vpaidEvents.AdImpression)return;e===this.adImpressionEvent&&(this.adImpressionEvent=void 0,this._allEventsHandler(this.vpaidEvents.AdImpression))}if(e===this.vpaidEvents.AdStopped)this.completionOnAdStoppedTimeout=clearTimeout(this.completionOnAdStoppedTimeout),this.onComplete();else if(e===this.vpaidEvents.AdLoaded)this.adLoaded=!0;else if(e===this.vpaidEvents.AdImpression)this._onAdImpression();else if(e===this.vpaidEvents.AdError)this._onAdError();else if(e===this.vpaidEvents.AdStarted){var i=this._isVideoBlacklisted();if(i&&i.length>0)return void this.emit(this.vpaidEvents.VideoBlacklisted,{match:i[0],regex:this.regex})}this.emit(e,{eventData:t})}}},{key:"_onAdImpression",value:function(){Hi(t,"_onAdImpression",this,3)([]),this.logVideoUrl(this.video.src),this.pauseVideoProtection&&this.video&&this.video.protectPause()}},{key:"_dispatchAdImpression",value:function(){return!0}},{key:"_safeCall",value:function(e,t){if(!this.stopped&&this.adUnit){"resizeAd"===e&&this._resizeAd(t);try{return this.adUnit[e].apply(this.adUnit,t)}catch(i){return this.adElasticLogger.logInitAdError(i.message,e,t,i.stack),this._onSafeCallAdError(i),!1}}}},{key:"_resizeAd",value:function(e,t,i,r){}},{key:"_onSafeCallAdError",value:function(e){}},{key:"_getVideoSrc",value:function(e){if(!this.stopped)return e.getSrc?e.getSrc():e.src||e.currentSrc||""}},{key:"_stopAd",value:function(){Hi(t,"stopAd",this,3)([]),this.stopped||(this.adUnit&&this._destroyAdUnit(),this.stopped=!0,this.completionOnAdStoppedTimeout=clearTimeout(this.completionOnAdStoppedTimeout),this.iframe=this.vpaid=this.imaApi=this.callIMAApi=this.adUnit=this.mediaFiles=this.video=this.vpaidEvents=this.target=this.adElasticLogger=this.store=this.tag=this.registerAnalyticsToVpaidLog=void 0,this.onAfterStop())}},{key:"_destroyAdUnit",value:function(){if(this.adElasticLogger.vpaidLog.saveToDbWithoutReport(),this.vpaidResourcesHandler.destroy(this.adUnit._iframe),this.adUnit._iframe&&this.adUnit._iframe.contentWindow&&this.additionalScripts&&this.additionalScripts.length>0)try{for(var e=0;e<this.additionalScripts.length;e++)this.adUnit._iframe.contentDocument.head.removeChild(this.additionalScripts[e]);this.onIframeEvent=void 0}catch(e){}this.adUnit._destroy()}},{key:"_onRestartVideoLoad",value:function(){var e=this;if(!this.stopped){this.adRestarted=!0,this._bindedOnRestartVideoLoad&&(this.video.removeEventListener("canplay",this._bindedOnRestartVideoLoad),this._bindedOnRestartVideoLoad=void 0),this.video.currentTime=0,this._resizeVideotoParentSize(),this.video.play();var t=function(){e.clickThruUrl&&e.emit(e.vpaidEvents.AdClickThru,{eventData:{url:e.clickThruUrl,playerHandles:!0}})},i=function(){e.video.removeEventListener("ended",i),e.video.removeEventListener("click",t),e._allEventsHandler(e.vpaidEvents.AdStopped,{}),e._allEventsHandler(e.vpaidEvents.AdVideoComplete,{})};this.video.addEventListener("ended",i),this.video.addEventListener("click",t)}}},{key:"_resizeVideotoParentSize",value:function(){this.video.style.width=this.target.style.width,this.video.style.height=this.target.style.height}},{key:"_getMediaUrl",value:function(){return this.mediaUrl}},{key:"_getActiveVideoInIframes",value:function(e){var t=this,i=null;if(!e||0===e.length)return i;try{(0,m.vn)(e[0],"iframe",(function(e){e.forEach((function(e){i||(t.minValidVideoDuration?e.duration&&e.duration>t.minValidVideoDuration&&(i=e):i=e)}))}),"video",this.store.get("debug"))}catch(e){}return i}},{key:"_loadAdditionalScripts",value:function(){if(this.adSettings&&this.adSettings.hasOwnProperty("adtnlscrpts")&&this.adSettings.adtnlscrpts){this.additionalScripts=[],this.onIframeEvent=this._onIframeEvent.bind(this);try{for(var e=0;e<this.adSettings.adtnlscrpts.length;e++){var t=this.adUnit._iframe.contentDocument.createElement("script");t.src=this.adSettings.adtnlscrpts[e].src,t.type="text/javascript",t.onload=this.adSettings.adtnlscrpts[e].clbk.bind(this),this.adUnit._iframe.contentDocument.head.appendChild(t),this.additionalScripts.push(t)}}catch(e){}}}},{key:"_onIframeEvent",value:function(e){if(!this.stopped&&this._shouldListenToIframeEvents()){if(!this.adSettings.ifrmevts.hasOwnProperty(e.name)||!this.vpaidEvents.hasOwnProperty(this.adSettings.ifrmevts[e.name]))return;this._allEventsHandler(this.adSettings.ifrmevts[e.name],{})}}},{key:"_shouldListenToIframeEvents",value:function(){return this.adSettings&&this.adSettings.hasOwnProperty("ifrmevts")&&this.adSettings.ifrmevts}},{key:"_onAdError",value:function(){}},{key:"_shouldHideTarget",value:function(){return this.adSettings.hasOwnProperty("hdtrgt")&&this.adSettings.hdtrgt}},{key:"getActiveVideoElement",value:function(){if(!this.stopped)return this._activeVideoElement?this._activeVideoElement:this._getVideoSrc(this.video)?(this._activeVideoElement=this.video,this.adElasticLogger.logVpaidVideoType("local"),this._activeVideoElement):(this._activeVideoElement=this._getActiveVideoInIframes(this.target.querySelectorAll("iframe")),this.adElasticLogger.logVpaidVideoType(this._activeVideoElement?"friendlyIframe":"unfriendlyIframe"),this._activeVideoElement)}},{key:"getMediaType",value:function(){return this.isOMID?7:2}},{key:"_isVideoBlacklisted",value:function(){var e=this.store.get("videoBlacklist"),t=this.getVideoUrl();return!(!e||!t)&&(this.regex=new RegExp(e,"ig"),this.regex.exec(t))}},{key:"isOMID",get:function(){return this._isOMID},set:function(e){this._isOMID=e}}],r&&Bi(i.prototype,r),n&&Bi(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,r,n}(At);function Ki(e){return Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ki(e)}function Yi(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Xi(r.key),r)}}function Xi(e){var t=function(e,t){if("object"!=Ki(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Ki(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ki(t)?t:t+""}function Ji(e,t,i){return t=tr(t),function(e,t){if(t&&("object"==Ki(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Zi()?Reflect.construct(t,i||[],tr(e).constructor):t.apply(e,i))}function Zi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Zi=function(){return!!e})()}function $i(e,t,i,r){var n=er(tr(1&r?e.prototype:e),t,i);return 2&r&&"function"==typeof n?function(e){return n.apply(i,e)}:n}function er(){return er="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=tr(e)););return e}(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}},er.apply(null,arguments)}function tr(e){return tr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},tr(e)}function ir(e,t){return ir=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ir(e,t)}var rr=function(e){function t(e,i,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ji(this,t,[e,i,r]))._initVpaid(e),setTimeout(e.onReady,2),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ir(e,t)}(t,e),i=t,(r=[{key:"resumeAd",value:function(){$i(t,"resumeAd",this,3)([this.adRestarted])}},{key:"setAdVolume",value:function(e){this.stopped||(this.store.get("frcvlm")&&(this.video.volume=e,this.emit(this.vpaidEvents.AdVolumeChange,{eventData:{dispatcher:this}})),$i(t,"setAdVolume",this,3)([e]))}},{key:"onMuteChanged",value:function(e){this.isMuted=e}},{key:"_initVpaid",value:function(){this.pauseVideoProtection=this.store.get("pusvidprtctn"),this.adLoaded=!1}},{key:"_onBindIframe",value:function(e){this._soundProtection(this.video),this._blockDOMObjectInWin(e.contentWindow)}},{key:"_soundProtection",value:function(e){var t=this;e.addEventListener("volumechange",(function(){t.adLoaded&&t.isMuted&&0!=e.volume&&t.emit(t.vpaidEvents.SoundViolation,{eventData:{vol:e.volume}}),e.volume!==t.volume&&(t.adElasticLogger.logSoundProtection(t.volume,e.volume),e.volume=t.volume)}))}},{key:"_blockDOMObjectInWin",value:function(e){var t="\n        ".concat(this.store.get("jsnoflshdtct")?'window.navigator.__defineGetter__("plugins", function () { return []; });':"",'\n\n        Object.defineProperty(\n            HTMLObjectElement.prototype,\n            "_data",\n            Object.getOwnPropertyDescriptor(\n                HTMLObjectElement.prototype,\n                "data"\n            )\n        );\n\n        Object.defineProperty(\n            HTMLObjectElement.prototype,\n            "data", {\n                set : function(val){\n                    console.log(\'HTMLObjectElement block\');\n                    return;\n                }\n            }\n        );');try{(0,m._o)(e,t)}catch(e){}}},{key:"_onSafeCallAdError",value:function(e){this._onAdError(e)}}])&&Yi(i.prototype,r),n&&Yi(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,r,n}(Qi);function nr(e){return nr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nr(e)}function or(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ar(r.key),r)}}function ar(e){var t=function(e,t){if("object"!=nr(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=nr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==nr(t)?t:t+""}function sr(e,t,i){return t=cr(t),function(e,t){if(t&&("object"==nr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,lr()?Reflect.construct(t,i||[],cr(e).constructor):t.apply(e,i))}function lr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(lr=function(){return!!e})()}function dr(e,t,i,r){var n=ur(cr(1&r?e.prototype:e),t,i);return 2&r&&"function"==typeof n?function(e){return n.apply(i,e)}:n}function ur(){return ur="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=cr(e)););return e}(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}},ur.apply(null,arguments)}function cr(e){return cr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cr(e)}function hr(e,t){return hr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hr(e,t)}var pr=function(e){function t(e,i,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=sr(this,t,[e,i,r]))._initVpaid(e),setTimeout(e.onReady,2),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hr(e,t)}(t,e),i=t,(r=[{key:"initAd",value:function(e,i,r,n,o,a){this.isIOS&&this.slowConnectionLength&&(this.slowConnectionTimeout=setTimeout(this._onSlowConnecionDetected.bind(this),1e3*this.slowConnectionLength)),dr(t,"initAd",this,3)([e,i,r,n,o,a])}},{key:"resumeAd",value:function(){dr(t,"resumeAd",this,3)([this.video.useResumeCallback&&this.video.useResumeCallback()||this.adRestarted])}},{key:"startAd",value:function(){this.video.emitStartAd&&this.video.emitStartAd(),this.pausePrefetchVideo(),dr(t,"startAd",this,3)([])}},{key:"setAdVolume",value:function(e,i){this.stopped||(this.video.mutedChangeByUserGesture=i,dr(t,"setAdVolume",this,3)([e]))}},{key:"isReplayable",value:function(){return this.video&&""!==this._getVideoSrc(this.video)}},{key:"_initVpaid",value:function(){this.pauseVideoProtection=this.store.get("pusvidprtctn"),this.isIOS=this.store.get("wurfl.os.name")===me,this.store.get("sprssviderr")&&this.video.supressErrorEvents(),this.isIOS&&(this.slowConnectionLength=this.store.get("slwcnctlngt")||0,this.minBufferSize=this.store.get("mnbfrsz")||1)}},{key:"_onBindIframe",value:function(e){this._unmuteHook()}},{key:"_unmuteHook",value:function(){this.store.get("mtdhkactv")&&this.video.hookMutedProperty()}},{key:"_resizeAd",value:function(e){this.stopped||this.video.resize&&this.video.resize(e)}},{key:"_stopAd",value:function(){this.stopped||(this.video.destroy(),this.onComplete(),dr(t,"_stopAd",this,3)([]))}},{key:"prefetchVideo",value:function(e,i){this.debugTracker.info("JsVpaidMob -> prefetchVideo() -> super.prefetchVideo();"),dr(t,"prefetchVideo",this,3)([e,i])}},{key:"_onSlowConnecionDetected",value:function(){this.stopped||(this.slowConnectionDetected=!0,this.emit(this.vpaidEvents.SlowConnection),this.emit(this.vpaidEvents.AdStopped))}},{key:"_allEventsHandler",value:function(e,i){this.stopped||e===this.vpaidEvents.AdLoaded&&(this.slowConnectionTimeout=clearTimeout(this.slowConnectionTimeout),this._preventAdLoadIfVideoBufferTooShort())||dr(t,"_allEventsHandler",this,3)([e,i])}},{key:"_preventAdLoadIfVideoBufferTooShort",value:function(){return!!this._isBufferTooShort()&&(this._onSlowConnecionDetected(),!0)}},{key:"_isBufferTooShort",value:function(){var e=this.slowConnectionLength>0,t=this.video&&this.video.getSrc(),i=this.video.buffered&&this.video.buffered.length>0;return e&&t&&i&&this.video.buffered.end(0)<this.minBufferSize}}])&&or(i.prototype,r),n&&or(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,r,n}(Qi);const fr={AdStopped:"AdStopped",adsManagerLoaded:"adsManagerLoaded",complete:"AdVideoComplete",loaded:"AdLoaded",adError:"AdError",start:"AdImpression",firstQuartile:"AdVideoFirstQuartile",midpoint:"AdVideoMidpoint",thirdQuartile:"AdVideoThirdQuartile",click:"AdClickThru",userClose:"AdUserClose",skip:"AdSkipped",durationChange:"AdDurationChange",pause:"AdPaused",resume:"AdPlaying",volumeChange:"AdVolumeChange",mute:"AdVolumeChange",skippableStateChanged:"AdSkippableStateChange",linearChanged:"AdLinearChange",interaction:"AdInteraction",adProgress:"Progress"};function vr(e){return vr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vr(e)}function yr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,o,a,s=[],l=!0,d=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(r=o.call(i)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){d=!0,n=e}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(d)throw n}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return mr(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?mr(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function gr(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_r(r.key),r)}}function _r(e){var t=function(e,t){if("object"!=vr(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=vr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==vr(t)?t:t+""}function br(e,t,i){return t=kr(t),function(e,t){if(t&&("object"==vr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ar()?Reflect.construct(t,i||[],kr(e).constructor):t.apply(e,i))}function Ar(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Ar=function(){return!!e})()}function Er(e,t,i,r){var n=Tr(kr(1&r?e.prototype:e),t,i);return 2&r&&"function"==typeof n?function(e){return n.apply(i,e)}:n}function Tr(){return Tr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var r=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=kr(e)););return e}(e,t);if(r){var n=Object.getOwnPropertyDescriptor(r,t);return n.get?n.get.call(arguments.length<3?e:i):n.value}},Tr.apply(null,arguments)}function kr(e){return kr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},kr(e)}function wr(e,t){return wr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},wr(e,t)}var Sr,Pr=function(e){function t(e,i,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=br(this,t,[e,i,r])).adContainer=e.slot,n.videoElement=document.querySelector("._cm-content-video")||e.videoSlot,n.videoElement.style.pointerEvents="none",n.tag=e.tag,n.vpaidEvents=Object.assign({},ke.A),n.imaEvents=Object.assign({},fr),n.onReadyEvent=e.onReady,n.adElasticLogger=i,n.store=r,n._initializeIMA(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wr(e,t)}(t,e),i=t,(r=[{key:"_initializeIMA",value:function(){this.store.get("adxScript.loading.isComplete")?this._loadIMAComponents():(this._loadIMAComponentsOnLoadingComplete(),this.store.get("adxScript.loading.inProgress")||this.store.emit("adxScript.loadScript"))}},{key:"_loadIMAComponentsOnLoadingComplete",value:function(){var e=this;this.store.on("adxScript.loading.complete",(function(){e._loadIMAComponents()}))}},{key:"_loadIMAComponents",value:function(){setTimeout(this.onReadyEvent,0)}},{key:"_bindImaVpaidLoadEvents",value:function(){var e=this;this.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,(function(t){e._allEventsHandler(t)}),!1),this.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,(function(t){e._allEventsHandler(t)}),!1)}},{key:"initAd",value:function(e,t,i,r,n,o){this.adDisplayContainer=new google.ima.AdDisplayContainer(this.adContainer,this.videoElement),this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer),this.adsLoader.getSettings().setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED),this._bindImaVpaidLoadEvents(),this.adsRequest=new google.ima.AdsRequest,this._setAdsRequestSettings(e,t),this.adsLoader.requestAds(this.adsRequest)}},{key:"_setAdsRequestSettings",value:function(e,t){this.tag.url?this.adsRequest.adTagUrl=this.tag.url:this.adsRequest.adsResponse=this.tag.vast,this.adsRequest.linearAdSlotWidth=e,this.adsRequest.linearAdSlotHeight=t,this.adsRequest.nonLinearAdSlotWidth=e,this.adsRequest.nonLinearAdSlotHeight=t,this.adsRequest.vastLoadTimeout=1e4,this.adsRequest.setAdWillAutoPlay(!0),this.adsRequest.setAdWillPlayMuted(!0)}},{key:"startAd",value:function(){if(!this.adStarted){this.adStarted=!0,this.width=this.adContainer.width||this.adContainer.getClientRects()[0].width,this.height=this.adContainer.height||this.adContainer.getClientRects()[0].height;try{this.adsManager.init(this.width,this.height,google.ima.ViewMode.NORMAL),this.adDisplayContainer.initialize(),this.adContainer.style.height="".concat(this.height,"px"),this.adsManager.start()}catch(t){var e=this.imaEvents.adError;this.emit(e,{eventData:t})}}}},{key:"_allEventsHandler",value:function(e){var t=e.type,i=this.imaEvents[t];if(i){if(i===this.imaEvents.adsManagerLoaded)this.adsManager=e.getAdsManager({currentTime:0,previousTime:0,seeking:!1,duration:0},new google.ima.AdsRenderingSettings),this._bindAdManagerEvents(),i=this.imaEvents.loaded;else if(i===this.imaEvents.adError)this.stopAd();else{if(i===this.imaEvents.loaded)return void(this.ad=e.getAd());i===this.imaEvents.click&&(this.clickThroughUrl=this._getAdProp("clickThroughUrl"),e.url=this.clickThroughUrl,e.playerHandles=!0)}var r="adError"===e.type?this._findErrorData(e):e;this.emit(i,{eventData:r})}}},{key:"_findErrorData",value:function(e){for(var t="",i=0,r=Object.entries(e);i<r.length;i++){var n=yr(r[i],2),o=(n[0],n[1]);o&&o.stack&&(t=o)}return t}},{key:"subscribe",value:function(e,t){this.vpaidEvents[t]&&e&&this.on(t,e)}},{key:"unsubscribe",value:function(e,t){this.vpaidEvents[t]&&e&&this.off(t,e)}},{key:"handshakeVersion",value:function(){return"2.0"}},{key:"resizeAd",value:function(e,t,i,r){this.stopped||this.adsManager&&(this.height=t,this.width=e,this.adsManager.resize(e,t,google.ima.ViewMode.NORMAL))}},{key:"pauseAd",value:function(){this.adsManager.pause()}},{key:"resumeAd",value:function(e){this.adsManager.resume()}},{key:"stopAd",value:function(){this.adsManager&&this.adsManager.stop(),window.setTimeout(this._stopAd.bind(this),1)}},{key:"onComplete",value:function(){this.stopped||(this.emit(this.imaEvents.complete),Er(t,"onComplete",this,3)([]))}},{key:"_bindAdManagerEvents",value:function(){var e=[google.ima.AdErrorEvent.Type.AD_ERROR,google.ima.AdEvent.Type.CLICK,google.ima.AdEvent.Type.COMPLETE,google.ima.AdEvent.Type.FIRST_QUARTILE,google.ima.AdEvent.Type.LOADED,google.ima.AdEvent.Type.MIDPOINT,google.ima.AdEvent.Type.PAUSED,google.ima.AdEvent.Type.STARTED,google.ima.AdEvent.Type.THIRD_QUARTILE,google.ima.AdEvent.Type.USER_CLOSE,google.ima.AdEvent.Type.SKIPPED,google.ima.AdEvent.Type.DURATION_CHANGE,google.ima.AdEvent.Type.RESUMED,google.ima.AdEvent.Type.VOLUME_CHANGED,google.ima.AdEvent.Type.VOLUME_MUTED,google.ima.AdEvent.Type.SKIPPABLE_STATE_CHANGED,google.ima.AdEvent.Type.LINEAR_CHANGED,google.ima.AdEvent.Type.INTERACTION,google.ima.AdEvent.Type.AD_PROGRESS];for(var t in e)this.adsManager.addEventListener(e[t],this._allEventsHandler,!1,this)}},{key:"_getAdProp",value:function(e){for(var t in this.ad){var i=this.ad[t][e];if(null!=i)return i}return null}},{key:"_getMediaUrl",value:function(){if(this.ad)return this.ad.getMediaUrl()}},{key:"isReplayable",value:function(){return!1}},{key:"getAdWidth",value:function(){if(this.ad)return this.ad.getWidth()}},{key:"getAdHeight",value:function(){if(this.ad)return this.ad.getHeight()}},{key:"getAdRemainingTime",value:function(){return this.adsManager.getRemainingTime()}},{key:"getAdDuration",value:function(e){if(this.ad)return e.apply(this.ad,[null,this.ad.getDuration()])}},{key:"getAdSkippableState",value:function(){return this.adsManager.getAdSkippableState()}},{key:"getAdVolume",value:function(){return this.adsManager.getVolume()}},{key:"getAdCompanions",value:function(){this.ad&&this.ad.getCompanionAds(this.width,this.height)}},{key:"getAdExpanded",value:function(){this.ad&&this.ad.expand()}},{key:"getAdLinear",value:function(){if(this.ad)return this.ad.isLinear()}},{key:"getAdSkippableRemainingTime",value:function(){this.ad&&this.ad.getSkipTimeOffset()}},{key:"getDOMContainer",value:function(){return this.adContainer}},{key:"setAdVolume",value:function(e){var t;null===(t=this.adsManager)||void 0===t||t.setVolume(e)}},{key:"skipAd",value:function(){this.stopped||this.ad&&this.ad.isSkippable()&&(this.emit(this.imaEvents.skip),this.adsManager.skip(),this.stopAd())}},{key:"collapseAd",value:function(){this.adsManager.collapse()}},{key:"expandAd",value:function(){this.adsManager.expand()}},{key:"checkUnfriendlyIframe",value:function(){return!0}},{key:"_stopAd",value:function(){Er(t,"stopAd",this,3)([]),this.stopped||(this.stopped=!0,this.iframe=this.vpaid=this.callIMAApi=this.video=this.vpaidEvents=this.target=this.adElasticLogger=this.store=this.tag=void 0,this.adsManager&&this.adsManager.destroy(),this.adsLoader&&this.adsLoader.destroy(),this.adDisplayContainer&&this.adDisplayContainer.destroy(),this.emit(this.imaEvents.AdStopped),this.onAfterStop())}},{key:"onAfterStop",value:function(){}},{key:"restartAd",value:function(e,t){}},{key:"setCompletionOnAdStoppedTimeout",value:function(){}},{key:"toggleIframeContentDisplay",value:function(){}},{key:"getMediaType",value:function(){return 5}}])&&gr(i.prototype,r),n&&gr(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,r,n}(At);function Ir(e){return Ir="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ir(e)}function Or(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Dr(r.key),r)}}function Dr(e){var t=function(e,t){if("object"!=Ir(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Ir(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ir(t)?t:t+""}var Cr,Vr=function(){return e=function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t,this.omidElements=i.omid,this.target=i.slot,this.adElasticLogger=r,this.video=i.videoSlot,this.debugTracker=i.debugTracker,this.eventsQueue=[],this.stopped=!1,this.omidAdSession=Sr},(t=[{key:"getOmidResources",value:function(){return this.omidElements.map((function(e){return{viewabilityTag:e.scriptUrl,vendor:e.vendor,params:e.verificationParameters}}))}},{key:"setOmidSessionStarted",value:function(e){this.omidSessionStarted=!0,this.omidAdSessionId=e,Sr=this.omidAdSession,this._fireDelayedEvents(),this.adElasticLogger.logOMIDEvent("sessionStart")}},{key:"onOmidSessionError",value:function(){this.adElasticLogger.logOMIDEvent("sessionFinish"),this.omidSessionStarted=!1,this.omidAdSession=void 0}},{key:"setOmidSessionFinish",value:function(){this.adElasticLogger.logOMIDEvent("sessionFinish"),this.omidSessionStarted=!1,this.omidAdSession=void 0}},{key:"_fireDelayedEvents",value:function(){var e=this;this.eventsQueue.length&&this.eventsQueue.forEach((function(t){e._fireOmidEvents(t)}))}},{key:"getActiveVideoElement",value:function(){return this.video}},{key:"_fireOmidEvents",value:function(e){}},{key:"_handleOmidStop",value:function(){}},{key:"dispose",value:function(){this.stopped||(this.stopped=!0,this._handleOmidStop(),this.events=this.options=this.omidSessionStarted=void 0)}},{key:"dispatch",value:function(e){}}])&&Or(e.prototype,t),i&&Or(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}(),Rr=function(e){var t=e.get("omddsbldbrwsrs");if(!t||!Array.isArray(t)||0===t.length)return!1;var i=e.get("wurfl.browser.name");return!(!i||!t.includes(i))};function Lr(e){return Lr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Lr(e)}function Mr(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=Lr(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Lr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Lr(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var xr={VIDEO_EVENT:Mr(Mr(Mr(Mr(Mr(Mr(Mr({INIT:"videoOmsdkInit"},ke.A.AdLoaded,"videoAdEvent"),ke.A.AdVideoStart,"AdVideoStart"),ke.A.AdImpression,"videoAdEvent"),"PLAYBACK_PROGRESS","playbackProgressEvent"),"INIT_ACK","OmsdkInitAck"),"INIT_FAIL","OmsdkInitFailure"),"SESSION_NOT_VALID","sessionIsNotValid"),EVENT_TYPE:(Cr={SESSION_START:"sessionStart",SESSION_ERROR:"sessionError",SESSION_FINISH:"sessionFinish"},Mr(Mr(Mr(Mr(Mr(Mr(Mr(Mr(Mr(Mr(Cr,ke.A.AdImpression,"impression"),ke.A.AdLoaded,"loaded"),ke.A.AdVideoStart,"start"),ke.A.AdVideoFirstQuartile,"firstQuartile"),ke.A.AdVideoMidpoint,"midpoint"),ke.A.AdVideoThirdQuartile,"thirdQuartile"),ke.A.AdVideoComplete,"complete"),ke.A.AdPaused,"pause"),ke.A.AdPlaying,"resume"),ke.A.AdSkipped,"skipped"),Mr(Mr(Cr,ke.A.AdVolumeChange,"volumeChange"),ke.A.AdClickThru,"adUserInteraction"))};function Fr(e){return Fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fr(e)}function Nr(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Br(r.key),r)}}function Br(e){var t=function(e,t){if("object"!=Fr(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Fr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Fr(t)?t:t+""}function Ur(e,t,i){return t=jr(t),function(e,t){if(t&&("object"==Fr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Wr()?Reflect.construct(t,i||[],jr(e).constructor):t.apply(e,i))}function Wr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Wr=function(){return!!e})()}function jr(e){return jr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},jr(e)}function Hr(e,t){return Hr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Hr(e,t)}var Gr=function(e){function t(e,i,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=Ur(this,t,[e,i,r]))._startOmsdkSession(),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Hr(e,t)}(t,e),i=t,(r=[{key:"_startOmsdkSession",value:function(){this._emitSdkEvent(xr.VIDEO_EVENT.INIT,{selectorPattern:"#".concat(this.target.id," .cm-ad-player"),measurementResources:this.getOmidResources()}),this._bindSessionEvents()}},{key:"_bindSessionEvents",value:function(){window.taboolaBridge.on(xr.VIDEO_EVENT.INIT_ACK,this.setOmidSessionStarted.bind(this)),window.taboolaBridge.on(xr.VIDEO_EVENT.INIT_FAIL,this.onOmidSessionError.bind(this)),window.taboolaBridge.on(xr.VIDEO_EVENT.SESSION_NOT_VALID,this.onOmidSessionError.bind(this)),window.taboolaBridge.on(xr.EVENT_TYPE.SESSION_FINISH,this._handleOmidStop.bind(this))}},{key:"fireEvent",value:function(e){var t=e.type;switch(e.type=xr.VIDEO_EVENT[t],t){case"AdVideoStart":this._emitSdkEvent(xr.VIDEO_EVENT.PLAYBACK_PROGRESS,{sessionId:this.omidAdSessionId,type:xr.EVENT_TYPE[t],params:{duration:e.duration?e.duration:this.video.duration,adVolume:e.adVolume}});break;case"AdLoaded":case"AdImpression":this._emitSdkEvent(xr.VIDEO_EVENT[t],{sessionId:this.omidAdSessionId,type:xr.EVENT_TYPE[t]});break;case"AdVolumeChange":this._emitSdkEvent(xr.VIDEO_EVENT.PLAYBACK_PROGRESS,{sessionId:this.omidAdSessionId,type:xr.EVENT_TYPE[t],params:{adVolume:e.adVolume}});break;default:this._emitSdkEvent(xr.VIDEO_EVENT.PLAYBACK_PROGRESS,{sessionId:this.omidAdSessionId,type:xr.EVENT_TYPE[t]})}}},{key:"_emitSdkEvent",value:function(e,t){window.taboolaBridge.emit(e,t)}},{key:"_fireOmidEvents",value:function(e){this.fireEvent(e),this.debugTracker.info("OMID fired event:".concat(xr.EVENT_TYPE[e.type],", sessionID:").concat(this.omidAdSessionId),e)}},{key:"dispatch",value:function(e){xr.EVENT_TYPE[e.type]&&(this.omidSessionStarted?this._fireOmidEvents(e):this.eventsQueue.push(e))}},{key:"_handleOmidStop",value:function(){this.omidAdSession&&this._emitSdkEvent(xr.EVENT_TYPE.SESSION_FINISH)}}])&&Nr(i.prototype,r),n&&Nr(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,r,n}(Vr),qr=function(e,t,i,r){return function(){window.reportResourceEvent||(window.reportResourceEvent=function(e){try{window.parent.postMessage({type:"resourceEvent",eventData:e},"*")}catch(e){}});!function(e){var t,i,r="__BLACKLIST__",n=new RegExp(r.map((function(e){try{return atob(e)}catch(t){return e}})).join("|"),"i"),o=function(e){return n.test(e)},a=function(e,t){e?window.reportResourceEvent({event:"maliciousUrl",url:t.url,isEarly:t.isEarly}):window.reportResourceEvent({event:"maliciousAction",action:t.action})},s=function(e){if(e.src)return e.src;if(e.childNodes.length)for(var t=0;t<e.childNodes.length;t++)if(e.childNodes[t]&&e.childNodes[t].src)return e.childNodes[t].src;return e.outerHTML};function l(e){var t=this;this.report={scripts:[],XHRUrls:[],iframes:[],firstCount:0,totalRequests:[],totalRequestsCounter:0,latencies:[],averageLatency:0,averageIntLatency:0},this.networkCallCounter=0,this.analyticsOptions=e,this.networkCallsLimitExceeded=!1,this.isVideoUrlPublic=void 0,this.requestId=0,this.requestStartTimes={},this.getReport=function(){if(t.stopped)return{};var e={};for(var i in t.report)Array.isArray(t.report[i])?e[i]=t.report[i].slice():e[i]=t.report[i];e.totalRequests=e.totalRequests.concat(e.scripts),e.totalRequests=e.totalRequests.concat(e.XHRUrls),e.totalRequests=e.totalRequests.concat(e.iframes),e.totalRequestsCounter=e.totalRequests.length;var r=e.latencies.reduce((function(e,t){return e+t}),0);return e.averageLatency=e.latencies.length?r/e.latencies.length:0,e.averageIntLatency=parseInt(e.averageLatency),e}}l.prototype.pushUrl=function(e,t,i){this.report[e].push(t),i._id=this.requestId++,this.requestStartTimes[i._id]=Date.now();var r=this,n=function(){r.requestStartTimes.hasOwnProperty(this._id)&&(r.report.latencies.push(Date.now()-r.requestStartTimes[this._id]),delete r.requestStartTimes[this._id]),this.removeEventListener("load",n)};i.addEventListener("load",n),"iframes"!==e||void 0===this.isVideoUrlPublic?this.networkCallCounter++:this.networkCallCounter+=this.getIframeWeight(t),this.isMaxNetworkCallsLimitExceeded()&&this.onNetworkCallsLimitExceeded()},l.prototype.getIframeWeight=function(e){return e.indexOf("imasdk")>-1?this.analyticsOptions.iframesWeights.ggl:this.isVideoUrlPublic?this.analyticsOptions.iframesWeights.pxls:this.analyticsOptions.iframesWeights.gen},l.prototype.isMaxNetworkCallsLimitExceeded=function(){return this.networkCallsLimitExceeded||this.analyticsOptions.maxNetworkCalls&&this.networkCallCounter>=this.analyticsOptions.maxNetworkCalls},l.prototype.onNetworkCallsLimitExceeded=function(){this.networkCallsLimitExceeded||this.stopped||(this.networkCallsLimitExceeded=!0,window.reportResourceEvent({event:"maxNetworkCalls"}))},l.prototype.unhook=function(){var e=Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,"_src"),t=Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype,"_src");e&&(Object.defineProperty(HTMLIFrameElement.prototype,"src",e),HTMLIFrameElement.prototype.setAttribute=HTMLIFrameElement.prototype._setAttribute),t&&(Object.defineProperty(HTMLIFrameElement.prototype,"src",t),HTMLScriptElement.prototype.setAttribute=HTMLScriptElement.prototype._setAttribute),window.XMLHttpRequest.prototype._open&&(window.XMLHttpRequest.prototype.open=window.XMLHttpRequest.prototype._open)},l.prototype.destroy=function(){this.stopped||(this.unhook(),this.stopped=!0,this.report=this.analyticsOptions=this.requestStartTimes=this.getReport=window.analyticsReporter=void 0)},window.destroyCrawler=function(){window.reportResourceEvent=window.vpaidCrawlerFunc=void 0};try{window.analyticsReporter=window.analyticsReporter||new l("__OPTIONS__"),function(){for(var e=document.scripts||[],t="",i=0;i<e.length;i++)window.analyticsReporter.report.scripts.push(e[i].src),e[i].src&&o(e[i].src)&&(t=e[i].src);for(var r=document.querySelectorAll("iframe")||[],n=0;n<r.length;n++)window.analyticsReporter.report.iframes.push(r[n].src),r[n].src&&o(r[n].src)&&(t=r[n].src);window.analyticsReporter.report.firstCount=window.analyticsReporter.report.scripts.length+window.analyticsReporter.report.iframes.length,t&&a(!0,{url:t,isEarly:!0})}(),i=function(e){o(e)?a(!0,{url:e,isEarly:!1}):(window.analyticsReporter.analyticsOptions.withIframes&&window.analyticsReporter.pushUrl("iframes",e,this),e&&"undefined"===e.substr(0,9)&&window.reportResourceEvent({event:"undefinedIframeSrc",url:e}),function(e){if(window.vpaidCrawlerFunc){var t=function(){try{e.removeEventListener("load",t);var i=e.contentWindow.document.createElement("script");i.type="text/javascript",e.contentWindow.vpaidCrawlerFunc=i.innerHTML=window.vpaidCrawlerFunc,e.contentWindow.analyticsReporter=window.analyticsReporter,e.contentWindow.reportResourceEvent=window.reportResourceEvent,e.contentWindow.document.head.appendChild(i)}catch(e){}};e.addEventListener("load",t)}}(this))},HTMLIFrameElement.prototype.hasOwnProperty("_src")||(Object.defineProperty(HTMLIFrameElement.prototype,"_src",Object.getOwnPropertyDescriptor(HTMLIFrameElement.prototype,"src")),Object.defineProperty(HTMLIFrameElement.prototype,"src",{get:function(){return this._src},set:function(e){i.call(this,e),this._src=e}})),HTMLIFrameElement.prototype.hasOwnProperty("_setAttribute")||(HTMLIFrameElement.prototype._setAttribute=HTMLIFrameElement.prototype.setAttribute,HTMLIFrameElement.prototype.setAttribute=function(e,t){"src"==e.toLowerCase()&&i.call(this,t),this._setAttribute(e,t)}),HTMLElement.prototype.hasOwnProperty("_insertBefore")||(HTMLElement.prototype._insertBefore=HTMLElement.prototype.insertBefore,HTMLElement.prototype.insertBefore=function(e,t){if(!o(e.outerHTML))return this._insertBefore(e,t);a(!0,{url:s(e),isEarly:!1})}),HTMLElement.prototype.hasOwnProperty("_appendChild")||(HTMLElement.prototype._appendChild=HTMLElement.prototype.appendChild,HTMLElement.prototype.appendChild=function(e){if(!o(e.outerHTML))return this._appendChild(e);a(!0,{url:s(e),isEarly:!1})}),t=function(e){o(e)?a(!0,{url:e,isEarly:!1}):window.analyticsReporter.analyticsOptions.withScripts&&window.analyticsReporter.pushUrl("scripts",e,this)},HTMLScriptElement.prototype.hasOwnProperty("_src")||(Object.defineProperty(HTMLScriptElement.prototype,"_src",Object.getOwnPropertyDescriptor(HTMLScriptElement.prototype,"src")),Object.defineProperty(HTMLScriptElement.prototype,"src",{get:function(){return this._src},set:function(e){t.call(this,e),this._src=e}})),HTMLScriptElement.prototype.hasOwnProperty("_setAttribute")||(HTMLScriptElement.prototype._setAttribute=HTMLScriptElement.prototype.setAttribute,HTMLScriptElement.prototype.setAttribute=function(e,i){"src"==e.toLowerCase()&&t.call(this,i),this._setAttribute(e,i)}),HTMLObjectElement.prototype._scrollIntoView=HTMLObjectElement.prototype.scrollIntoView,HTMLObjectElement.prototype.scrollIntoView=function(){return a(!1,{action:"scrollIntoView-object"}),!1},HTMLDivElement.prototype._scrollIntoView=HTMLDivElement.prototype.scrollIntoView,HTMLDivElement.prototype.scrollIntoView=function(){return a(!1,{action:"scrollIntoView-div"}),!1},XMLHttpRequest.prototype.hasOwnProperty("_open")||(XMLHttpRequest.prototype._open=XMLHttpRequest.prototype.open,XMLHttpRequest.prototype.open=function(e,t,i,r,n){o(t)?a(!0,{url:t,isEarly:!1}):(window.analyticsReporter.analyticsOptions.withXHR&&window.analyticsReporter.pushUrl("XHRUrls",t,this),this._open.apply(this,arguments))}),HTMLElement.prototype._click=HTMLElement.prototype.click,HTMLElement.prototype.click=function(){this.hasAttribute("download")?a(!1,{action:"download"}):this._click()},history.pushState=function(e,t,i){a(!1,{action:"pushState"})},e||(window.onerror=function(e){return!0}),function(){if(!e){console=console||{};for(var t=function(){},i=["debug","error","info","log","warn"],r=0;r<i.length;r++)console[i[r]]&&(console[i[r]]=t)}}()}catch(e){}}("__DEBUG__")}.toString().replace('"__IS_OMID__"',r).replace('"__DEBUG__"',e).replace('"__BLACKLIST__"',(0,m.As)(t)).replace('"__OPTIONS__"',(0,m.As)(i))};const zr=function(){return"(".concat(qr(arguments.length>0&&void 0!==arguments[0]&&arguments[0],arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},arguments.length>3&&void 0!==arguments[3]&&arguments[3]),")();")};function Qr(e){return Qr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qr(e)}function Kr(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Yr(r.key),r)}}function Yr(e){var t=function(e,t){if("object"!=Qr(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Qr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Qr(t)?t:t+""}var Xr,Jr,Zr,$r,en,tn,rn,nn=function(){return e=function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(0,j.mixin)(this),this.store=t,this.tag=i,this.adElasticLogger=r,this.vpaidCrawler=zr,this.onVpaidResourceEvent=this._onVpaidResourceEvent.bind(this)},(t=[{key:"inject",value:function(e){e&&this._injectVpaidCrawler(e)}},{key:"_injectVpaidCrawler",value:function(e){this._getVpaidAnalyticsOptions().deepIframes&&(e.contentWindow.vpaidCrawlerFunc=this.vpaidCrawler),this.onResourceMessage=this._onResourceMessage.bind(this),window.addEventListener("message",this.onResourceMessage),(0,m._o)(e.contentWindow,this.vpaidCrawler(this.store.get("debug"),this._getBlacklistDomains(),this._getVpaidAnalyticsOptions(),this.tag.isOMID)),this.adElasticLogger.vpaidLog.getVpaidAnalyticsReport=e.contentWindow.analyticsReporter.getReport,this.setVpaidAnalyticsIsVideoUrlPublic=function(t){e.contentWindow.analyticsReporter.isVideoUrlPublic=t}}},{key:"_getBlacklistDomains",value:function(){if(!this.stopped)return this.store.get("hjkbldomsencdd")}},{key:"_onResourceMessage",value:function(e){if(!this.stopped&&e.data&&"resourceEvent"===e.data.type){var t=e.data.eventData;this.adElasticLogger.logVpaidResourceEvent(t);var i=t.event;i.indexOf("malicious")>-1?this._onCrawlerHijackAttempt(i,t):"undefinedIframeSrc"===i?this._onUndefinedRelativeIframeSrcError(t.url):"maxNetworkCalls"===i&&this._onNetworkCallsLimitExceeded()}}},{key:"_getVpaidAnalyticsOptions",value:function(){var e=this.store.get("anltcsOptions"),t=this.tag.getValueByKey("mxntwrkclls")||0,i=this.store.get("ifrmswghts");return t&&(e.maxNetworkCalls=t),i&&(e.iframesWeights=i),e}},{key:"_onVpaidResourceEvent",value:function(e,t){this.emit("vpaidResourceEvent",{event:e,data:t})}},{key:"_onCrawlerHijackAttempt",value:function(e,t){this._onVpaidResourceEvent("hijackAttempt",{type:e,data:t})}},{key:"_onUndefinedRelativeIframeSrcError",value:function(e){this._onVpaidResourceEvent("undefinedIframeSrc",{url:e})}},{key:"_onNetworkCallsLimitExceeded",value:function(){this._onVpaidResourceEvent("maxNetworkCalls",{maxNetworkCalls:this.tag.getValueByKey("mxntwrkclls")})}},{key:"destroy",value:function(e){this.stopped||(this.stopped=!0,e&&e.contentWindow&&this._destroyVpaidCrawler(e))}},{key:"_destroyVpaidCrawler",value:function(e){window.removeEventListener("message",this.onResourceMessage),e.contentWindow.analyticsReporter.destroy(),e.contentWindow.destroyCrawler(),this.adElasticLogger.vpaidLog.getVpaidAnalyticsReport=null}}])&&Kr(e.prototype,t),i&&Kr(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function on(e){return on="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},on(e)}function an(e,t,i){return(t=ln(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function sn(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ln(r.key),r)}}function ln(e){var t=function(e,t){if("object"!=on(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=on(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==on(t)?t:t+""}function dn(e,t,i){return t=cn(t),function(e,t){if(t&&("object"==on(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,un()?Reflect.construct(t,i||[],cn(e).constructor):t.apply(e,i))}function un(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(un=function(){return!!e})()}function cn(e){return cn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},cn(e)}function hn(e,t){return hn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hn(e,t)}var pn={LIMITED:"limited",FULL:"full"},fn=function(e){function t(e,i,r){var n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=dn(this,t,[e,i,r])).tag=i.tag,o.events=(an(an(an(an(an(an(an(an(an(an(n={},ke.A.AdLoaded,"loaded"),ke.A.AdVideoStart,"start"),ke.A.AdImpression,"impressionOccured"),ke.A.AdClickThru,"adUserInteraction"),ke.A.AdPaused,"pause"),ke.A.AdPlaying,"resume"),ke.A.AdSkipped,"skipped"),ke.A.AdVideoFirstQuartile,"firstQuartile"),ke.A.AdVideoMidpoint,"midpoint"),ke.A.AdVideoThirdQuartile,"thirdQuartile"),an(an(n,ke.A.AdVideoComplete,"complete"),ke.A.AdVolumeChange,"volumeChange")),o._init(),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hn(e,t)}(t,e),i=t,(r=[{key:"_init",value:function(){this.store.get("omidScriptsInjected")?this._handleOmidLoaded():this._loadOmidScripts()}},{key:"_loadScript",value:function(e){var t=this;return new Promise((function(i,r){var n=document.createElement("script");n.type="text/javascript",n.src=e,n.async=!0,n.onload=function(){i()},n.onerror=function(){r(e)},t.target.appendChild(n)}))}},{key:"_loadOmidScripts",value:function(){var e=this,t=[];[this.store.get("omidWebUrl"),this.store.get("omidSessionUrl")].forEach((function(i){t.push(e._loadScript(i))})),Promise.all(t).then((function(){e.store.set("omidScriptsInjected",!0),e._handleOmidLoaded()})).catch((function(t){e.debugTracker&&e.debugTracker.error("Error loading OMID script ".concat(t))}))}},{key:"_handleOmidLoaded",value:function(){if(this._loadOmidSessionClient()){var e=this._createOmidPartner(),t=this._createOmidContext(e);t&&this._createAdSession(t)}}},{key:"_loadOmidSessionClient",value:function(){if(this.omidSesiontLoaded||Xr)return!0;var e;try{e=window.OmidSessionClient&&window.OmidSessionClient[this.store.get("omidVerificationScriptVersion")]}catch(e){return this.adElasticLogger.logOMIDEvent("sessionError"),!1}return e?(this.omidSesiontLoaded=!0,this._ObtainSessionClientClasses(e),!0):(this.adElasticLogger.logOMIDEvent("sessionError"),!1)}},{key:"_ObtainSessionClientClasses",value:function(e){Xr=e.AdSession,Jr=e.Partner,Zr=e.Context,$r=e.VerificationScriptResource,en=e.AdEvents,tn=e.MediaEvents,rn=e.VastProperties}},{key:"_createOmidPartner",value:function(){var e=this.store.get("omidVerificationScriptVersion"),t=this.store.get("omidPartnerName");return new Jr(t,e)}},{key:"_createOmidContext",value:function(e){var t;try{t=window.top}catch(e){return this.adElasticLogger.logOMIDEvent("sessionError"),!1}var i=this.store.get("domain"),r=this._getOmidAccessMode(),n=this.omidElements.map((function(e){return new $r(e.scriptUrl,e.vendor,e.verificationParameters,r)}));this.debugTracker.info("OMID accessMode",r);var o=new Zr(e,n,i);return o.setServiceWindow(t),o.setVideoElement(this.getActiveVideoElement()),o}},{key:"_getOmidAccessMode",value:function(){var e=this.store.get("omidaccsmd");return pn.hasOwnProperty(e)?pn[e]:pn.FULL}},{key:"_createAdSession",value:function(e){var t=this;this.omidAdSession||(this.omidAdSession=new Xr(e),this._trackOmidEvents(),this.omidAdSession.setCreativeType("video"),this.omidAdSession.setImpressionType("beginToRender"),this.omidAdSession.registerSessionObserver((function(e){switch(t.debugTracker.info("OMID fired event:".concat(e.type),e),e.type){case"sessionStart":t.setOmidSessionStarted(e.adSessionId),t._injectVPAIDCrawler();break;case"sessionError":t.onOmidSessionError();break;case"sessionFinish":t.setOmidSessionFinish();break;default:t.adElasticLogger.logOMIDEvent("unknownEventType")}})),this.omidAdSession.start(),this.debugTracker.info("OMID session started"))}},{key:"_injectVPAIDCrawler",value:function(){var e=this;this.tag.isOMID=!0;var t=new nn(this.store,this.tag,this.adElasticLogger);t.on("vpaidResourceEvent",(function(t){"hijackAttempt"===t.event&&e.adElasticLogger.logMaliciousActions(t.data.data)})),t.inject(this._getOMIDIframe())}},{key:"_getOMIDIframe",value:function(){var e=this;return Array.from(document.getElementsByTagName("iframe")||[]).find((function(t){var i;return(null==t||null===(i=t.srcdoc)||void 0===i?void 0:i.indexOf(e.omidElements[0].scriptUrl))>-1}))}},{key:"_trackOmidEvents",value:function(){this.sessionAdEvents=new en(this.omidAdSession),this.mediaEvents=new tn(this.omidAdSession)}},{key:"fireEvent",value:function(e){switch(e.type){case"AdLoaded":this.sessionAdEvents.loaded(new rn(!1,void 0,!0));break;case"AdVideoStart":this.mediaEvents.start(e.duration,e.adVolume);break;case"AdImpression":this.sessionAdEvents.impressionOccurred();break;case"AdClickThru":this.mediaEvents.adUserInteraction("click");break;case"AdVolumeChange":this.mediaEvents.volumeChange(e.adVolume);break;case"AdPlaying":this.mediaEvents.resume();break;default:this.mediaEvents[this.events[e.type]]()}}},{key:"_handleOmidStop",value:function(){var e;null===(e=this.omidAdSession)||void 0===e||e.finish()}},{key:"_fireOmidEvents",value:function(e){this.fireEvent(e),this.debugTracker.info("OMID fired event:".concat(this.events[e.type],", sessionID:").concat(this.omidAdSessionId),e)}},{key:"dispatch",value:function(e){this.omidAdSession||this._handleOmidLoaded(),this.events[e.type]&&(this.sessionAdEvents&&this.omidSessionStarted?this._fireOmidEvents(e):this.eventsQueue.push(e))}}])&&sn(i.prototype,r),n&&sn(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,r,n}(Vr),vn=function(){return n.e(451).then(n.bind(n,6419))},yn=function(){return n.e(748).then(n.bind(n,6265))},mn=function(){return n.e(124).then(n.bind(n,6894))},gn=function(){return n.e(974).then(n.bind(n,3203))},_n=function(){return n.e(413).then(n.bind(n,2936))},bn=function(){return n.e(281).then(n.bind(n,4361))},An=function(){return n.e(564).then(n.bind(n,4283))},En=function(){return n.e(480).then(n.bind(n,9921))},Tn=function(){return n.e(586).then(n.bind(n,6166))},kn=function(){return n.e(261).then(n.bind(n,664))},wn=function(){return n.e(611).then(n.bind(n,1818))},Sn=function(){return n.e(57).then(n.bind(n,3886))},Pn=function(){return n.e(904).then(n.bind(n,3233))},In=function(){return n.e(466).then(n.bind(n,1431))},On=function(){return n.e(683).then(n.bind(n,538))};function Dn(e){return Dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Dn(e)}function Cn(){Cn=function(){return t};var e,t={},i=Object.prototype,r=i.hasOwnProperty,n=Object.defineProperty||function(e,t,i){e[t]=i.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function d(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,i){return e[t]=i}}function u(e,t,i,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new D(r||[]);return n(a,"_invoke",{value:S(e,i,s)}),a}function c(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",p="suspendedYield",f="executing",v="completed",y={};function m(){}function g(){}function _(){}var b={};d(b,a,(function(){return this}));var A=Object.getPrototypeOf,E=A&&A(A(C([])));E&&E!==i&&r.call(E,a)&&(b=E);var T=_.prototype=m.prototype=Object.create(b);function k(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(n,o,a,s){var l=c(e[n],e,o);if("throw"!==l.type){var d=l.arg,u=d.value;return u&&"object"==Dn(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){d.value=e,a(d)}),(function(e){return i("throw",e,a,s)}))}s(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){i(e,r,t,n)}))}return o=o?o.then(n,n):n()}})}function S(t,i,r){var n=h;return function(o,a){if(n===f)throw Error("Generator is already running");if(n===v){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var l=P(s,r);if(l){if(l===y)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=f;var d=c(t,i,r);if("normal"===d.type){if(n=r.done?v:p,d.arg===y)continue;return{value:d.arg,done:r.done}}"throw"===d.type&&(n=v,r.method="throw",r.arg=d.arg)}}}function P(t,i){var r=i.method,n=t.iterator[r];if(n===e)return i.delegate=null,"throw"===r&&t.iterator.return&&(i.method="return",i.arg=e,P(t,i),"throw"===i.method)||"return"!==r&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=c(n,t.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,y;var a=o.arg;return a?a.done?(i[t.resultName]=a.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,y):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,y)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var i=t[a];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function i(){for(;++n<t.length;)if(r.call(t,n))return i.value=t[n],i.done=!1,i;return i.value=e,i.done=!0,i};return o.next=o}}throw new TypeError(Dn(t)+" is not iterable")}return g.prototype=_,n(T,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:g,configurable:!0}),g.displayName=d(_,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,d(e,l,"GeneratorFunction")),e.prototype=Object.create(T),e},t.awrap=function(e){return{__await:e}},k(w.prototype),d(w.prototype,s,(function(){return this})),t.AsyncIterator=w,t.async=function(e,i,r,n,o){void 0===o&&(o=Promise);var a=new w(u(e,i,r,n),o);return t.isGeneratorFunction(i)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(T),d(T,l,"Generator"),d(T,a,(function(){return this})),d(T,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),i=[];for(var r in t)i.push(r);return i.reverse(),function e(){for(;i.length;){var r=i.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=C,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function n(r,n){return s.type="throw",s.arg=t,i.next=r,n&&(i.method="next",i.arg=e),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),d=r.call(a,"finallyLoc");if(l&&d){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!d)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),O(i),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var n=r.arg;O(i)}return n}}throw Error("illegal catch attempt")},delegateYield:function(t,i,r){return this.delegate={iterator:C(t),resultName:i,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function Vn(e,t,i,r,n,o,a){try{var s=e[o](a),l=s.value}catch(e){return void i(e)}s.done?t(l):Promise.resolve(l).then(r,n)}function Rn(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ln(r.key),r)}}function Ln(e){var t=function(e,t){if("object"!=Dn(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Dn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Dn(t)?t:t+""}var Mn,xn=function(){return t=function t(i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.adElasticLogger=i,this.store=r,this.isMobile=this.store.get("isMobile"),this.isInApp=this.store.get("isInApp"),this.handlers={video:{handlerType:"VideoVpaid".concat(this.isMobile?"Mobile":""),handler:this.isMobile?Zt:jt,filterVpaidFiles:function(e){return e.vpaidFiles[we.VIDEO]}},javascript:{handlerType:"JsVpaid".concat(this.isMobile?"Mobile":""),handler:this.isMobile?pr:rr,filterVpaidFiles:function(e){return e.vpaidFiles[Se.VPAID]}},ima:{handlerType:"adx",handler:Pr},OMID:{handlerType:"OMID",handler:this.isInApp&&window.taboolaBridge?Gr:fn},prebid:new Map(Object.entries(e))}},i=[{key:"create",value:function(e,t){if(!this.stopped){if(!this.handlers.hasOwnProperty(e))return this.adElasticLogger.logCreatingVpaidHandler(e,!1),null;var i=this.handlers[e].handler;return this.handlers[e].hasOwnProperty("filterVpaidFiles")&&(t.vpaidFiles=this.handlers[e].filterVpaidFiles(t)),this.adElasticLogger.logCreatingVpaidHandler(this.handlers[e].handlerType,!0),new i(t,this.adElasticLogger,this.store)}}},{key:"createOMIDHandler",value:function(e){if(!this.stopped)return new(0,this.handlers.OMID.handler)(this.store,e,this.adElasticLogger)}},{key:"createPrebidHandler",value:(n=Cn().mark((function e(t,i,r){var n,o,a;return Cn().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.stopped){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,mn();case 4:if(e.sent.hook.ready(),this.store.get("prebid.iiq.isActive")&&!this.store.get("prebid.iiq.excludedPartners").includes(t)){e.next=14;break}return e.next=10,vn();case 10:o=e.sent,n=o.PrebidHandler,e.next=18;break;case 14:return e.next=16,yn();case 16:a=e.sent,n=a.IIQPrebidHandler;case 18:return e.prev=18,e.next=21,this.handlers.prebid.get("load".concat(t,"PrebidHandler"))();case 21:return e.abrupt("return",new n(this.store,i,this.adElasticLogger,r));case 24:return e.prev=24,e.t0=e.catch(18),e.abrupt("return",null);case 27:case"end":return e.stop()}}),e,this,[[18,24]])})),o=function(){var e=this,t=arguments;return new Promise((function(i,r){var o=n.apply(e,t);function a(e){Vn(o,i,r,a,s,"next",e)}function s(e){Vn(o,i,r,a,s,"throw",e)}a(void 0)}))},function(e,t,i){return o.apply(this,arguments)})},{key:"destroy",value:function(){this.stopped=!0,this.adElasticLogger=this.store=this.handlers=void 0}}],i&&Rn(t.prototype,i),r&&Rn(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,r,n,o}();function Fn(e){return Fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fn(e)}function Nn(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Bn(r.key),r)}}function Bn(e){var t=function(e,t){if("object"!=Fn(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Fn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Fn(t)?t:t+""}var Un=function(){return e=function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Mn)return Mn;this.debugTracker=new y.A("ClickThroughHandler"),this.store=t,this.isMultiAdsActive=this.store.get("mltads"),Mn=this},(t=[{key:"invokeClick",value:function(e){this.isMultiAdsActive||this.store.set("forcePause",!1),e&&e.url&&(this.store.emit(ke.A.AdClickThru,e.url),e.playerHandles&&e.url&&this._openClickThroughUrl(e.url))}},{key:"_openClickThroughUrl",value:function(e){this.debugTracker.info("Opening Url","Opening url: ".concat(e)),e=(0,m.gM)(e,this.store),this.store.get("isInApp")&&window.taboolaMobile&&window.taboolaMobile.getSupportedFeatures&&window.taboolaMobile.getSupportedFeatures().VideoClick?window.taboolaBridge.emit("videoClick",e):window.open(e)}}])&&Nn(e.prototype,t),i&&Nn(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}(),Wn=n(9054);const jn="ad",Hn="content";function Gn(e){return Gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gn(e)}function qn(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return zn(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?zn(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function zn(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function Qn(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Kn(r.key),r)}}function Kn(e){var t=function(e,t){if("object"!=Gn(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Gn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Gn(t)?t:t+""}var Yn={VAST:"vast",PRICE:"price",PRICING:"pricing",ICONS:{ICON:"icon",ICON_CLICKS:"iconclicks",ICON_CLICK_THROUGH:"iconclickthrough",STATIC_RESOURCE:"staticresource",HTML_RESOURCE:"htmlresource",ICON_VIEW_TRACKING:"iconviewtracking",ICON_CLICK_TRACKING:"iconclicktracking"},CREATIVE_EXTENSION:"creativeextension",OMID:{VERIFICATION:"verification",JAVASCRIPT_RESOURCE:"javascriptresource",VERIFICATION_PARAMETERS:"verificationparameters"},DURATION:"duration",MEDIA_FILES:{MEDIA_FILES:"mediafiles",MEDIA_FILE:"mediafile"},AD_INLINE:{AD_TITLE:"adtitle",AD_SYSTEM:"adsystem"},TRACKING:{URL:"url",TRACKING_EVENTS:"trackingevents",TRACKING:"tracking",CUSTOM_TRACKING:"customtracking"},AD_PARAMETERS:"adparameters",AD_WRAPPER:{WRAPPER:"wrapper",VAST_AD_TAG_URL:"vastadtagurl",VAST_AD_TAG_URI:"vastadtaguri"},AD:"ad",LANDING_PAGE:["adclickthrough","clickthrough","adclickthru","clickthru"]},Xn="version",Jn="width",Zn="height",$n={API_FRAMEWORK:"apiFramework",VENDOR:"vendor"},eo=function(){return e=function e(t,i,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rawXml=t,this.store=i,this.vpaidLog=r.vpaidLog,this.vastTags={},this._parseXML(),this._extractVastTags()},t=[{key:"_parseXML",value:function(){if(window.DOMParser)try{this.vastXml=(new DOMParser).parseFromString(this.rawXml,"text/xml")}catch(e){this.vastXml=void 0}}},{key:"_extractVastTags",value:function(){this.vastXml&&this._extractNode(this.vastXml.children[0])}},{key:"_extractNode",value:function(e){var t=this._parseNode(e);this.vastTags[t.tagName]=this.vastTags[t.tagName]||[],this.vastTags[t.tagName].push(t);var i,r=qn(e.children);try{for(r.s();!(i=r.n()).done;){var n=i.value;this._extractNode(n)}}catch(e){r.e(e)}finally{r.f()}}},{key:"_parseNode",value:function(e){return{tagName:e.tagName.toLowerCase(),attributes:this._parseAttributes(e.attributes),content:e.textContent,node:e}}},{key:"_parseAttributes",value:function(e){var t,i={},r=qn(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;n.value&&(i[n.name.toLowerCase()]=n.value)}}catch(e){r.e(e)}finally{r.f()}return i}},{key:"destroy",value:function(){this.stopped||(this.stopped=!0,this.vastTags=this.icons=this.store=this.vastXml=this.vpaidLog=void 0)}},{key:"isInlineVast",value:function(){return this.vastTags.hasOwnProperty(Yn.MEDIA_FILES.MEDIA_FILES)}},{key:"isWrapperVast",value:function(){return this.vastTags.hasOwnProperty(Yn.AD_WRAPPER.WRAPPER)}},{key:"didParsingFailed",value:function(){return void 0===this.vastXml||this.vastTags.hasOwnProperty("parsererror")}},{key:"getRawXML",value:function(){return this.rawXml}},{key:"_getTagAttribute",value:function(e,t){var i=[];return this.vastTags[e]&&(i=this.vastTags[e].map((function(e){return e.attributes[t]})).filter((function(e){return e}))),i}},{key:"_getTagContent",value:function(e){var t=[];return this.vastTags[e]&&(t=this.vastTags[e].map((function(e){return e.content})).filter((function(e){return e}))),t}},{key:"_getTags",value:function(e){var t=[];return this.vastTags[e]&&(t=this.vastTags[e]),t}},{key:"extractVastVersion",value:function(){var e=this._getTagAttribute(Yn.VAST,Xn)[0]||"1.1";return(0,m.Hj)(this.vpaidLog,"vastVersion",{version:e},!1,!1),e}},{key:"extractPrice",value:function(){var e=this._getTagContent(Yn.PRICE)[0]||this._getTagContent(Yn.PRICING)[0];if(!e)return 0;try{return isNaN(Number(e))&&e.indexOf("DATA")>-1&&(e=e.replace(/[^0-9.]/g,"")),e=(e=Number(e)).toFixed(3),e=Number(e)}catch(e){return 0}}},{key:"extractIcons",value:function(){var e=this;return this.icons||(this.icons=[],this._getTags(Yn.ICONS.ICON).map((function(t){var i=e._getInnerTag(t,Yn.ICONS.ICON_CLICKS),r=void 0!==i,n=r?e._getInnerTag(i,Yn.ICONS.ICON_CLICK_THROUGH):void 0,o=r?e._getTagContent(Yn.ICONS.ICON_CLICK_TRACKING):[],a=e._getInnerTag(t,Yn.ICONS.STATIC_RESOURCE),s=e._getInnerTag(t,Yn.ICONS.HTML_RESOURCE),l=e._getTagContent(Yn.ICONS.ICON_VIEW_TRACKING),d={isClickable:r,clickThroughUrl:e._getHTMLTagContent(n),staticresource:e._getHTMLTagContent(a),htmlresource:e._getHTMLTagContent(s),attributes:e._parseIconAttributes(t.attributes),iconViewTracking:l,clickTracking:o};e._isIconValid(d)&&e.icons.push(d)}))),this.icons}},{key:"_parseIconAttributes",value:function(e){for(var t in e)e[t]=t===Jn||t===Zn?"".concat(e[t],"px"):e[t].toLowerCase();return e}},{key:"_getHTMLTagContent",value:function(e){return e?e.textContent.trim():""}},{key:"_isIconValid",value:function(e){return!(e.isClickable&&!e.clickThroughUrl||!e.staticresource&&!e.htmlresource)}},{key:"_getInnerTag",value:function(e,t){for(var i=(e.node?e.node:e).children,r=0;r<i.length;r++)if(i[r].tagName.toLowerCase()===t)return i[r]}},{key:"extractOMIDElements",value:function(){var e=this;return this._getTags(Yn.OMID.VERIFICATION).map((function(t){var i=e._getInnerTag(t,Yn.OMID.JAVASCRIPT_RESOURCE);if(e._isOMIDFramework(i)){e.hasOmid=!0;var r=e._getHTMLTagAttribute(t.node,$n.VENDOR);if((0,m.Hj)(e.vpaidLog,"OMID",{vendor:r}),e.omidVendor||(e.omidVendor=r),e._isValidOMIDVendor(r)){var n,o,a,s=e._getInnerTag(t,Yn.OMID.VERIFICATION_PARAMETERS);return n={scriptUrl:e._getHTMLTagContent(i),vendor:r},o=s&&"verificationParameters",a=e._getHTMLTagContent(s),(o=Kn(o))in n?Object.defineProperty(n,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):n[o]=a,n}}})).filter((function(e){return e}))}},{key:"_isOMIDFramework",value:function(e){return"omid"===this._getHTMLTagAttribute(e,$n.API_FRAMEWORK)}},{key:"_getHTMLTagAttribute",value:function(e,t){var i=e.attributes.getNamedItem(t);return i?i.value:""}},{key:"_isValidOMIDVendor",value:function(e){var t=this.store.get("omidExcludedVendors"),i=new RegExp(e,"gi");return!t||!t.some((function(e){return i.test(e)}))}},{key:"hasOMID",value:function(){return this.hasOmid}},{key:"getOMIDVendor",value:function(){return this.omidVendor}},{key:"extractDuration",value:function(){var e=this._getTags(Yn.DURATION);return e.length>0&&e[0].content?parseInt(e[0].content.replace("00:00:","")):30}},{key:"extractMediaFiles",value:function(){return this._getTags(Yn.MEDIA_FILES.MEDIA_FILE)}},{key:"extractAdInline",value:function(){return{as:this._getTagContent(Yn.AD_INLINE.AD_SYSTEM)[0],at:this._getTagContent(Yn.AD_INLINE.AD_TITLE)[0]}}},{key:"extractPixels",value:function(e){var t=this,i=this._getTags(e);return i=i.map((function(e){return t.extractURLFromTag(e)}))}},{key:"extractURLFromTag",value:function(e){var t=this._getInnerTag(e,"url");return t?t.textContent:e.content}},{key:"hasTrackingPixels",value:function(){return this.vastTags.hasOwnProperty(Yn.TRACKING.TRACKING_EVENTS)}},{key:"extractTrackingPixels",value:function(){return this._getTags(Yn.TRACKING.TRACKING)}},{key:"extractAdParameters",value:function(){return this._getTagContent(Yn.AD_PARAMETERS)[0]||""}},{key:"extractWrapperUrl",value:function(){var e="",t=this._getTags(Yn.AD_WRAPPER.VAST_AD_TAG_URL),i=this._getTags(Yn.AD_WRAPPER.VAST_AD_TAG_URI);return t.length>0?e=this.extractURLFromTag(t[0]):i.length>0&&(e=this.extractURLFromTag(i[0])),e}},{key:"extractAd",value:function(){return this._getTags(Yn.AD)[0]}},{key:"extractLandingPageUrl",value:function(){var e=this;return this.landingPageUrl||(this.landingPageUrl=Yn.LANDING_PAGE.map((function(t){return e._extractLandingPageUrl(t)})).find((function(e){return e}))),this.landingPageUrl}},{key:"_extractLandingPageUrl",value:function(e){var t=this._getTags(e)[0];if(t)return this.extractURLFromTag(t)}},{key:"hasCustomTrackingPixels",value:function(){return this.vastTags.hasOwnProperty(Yn.TRACKING.CUSTOM_TRACKING)}},{key:"extractPixelsByType",value:function(e){return this.extractTrackingPixels().filter((function(t){return t.attributes.event===e}))}}],t&&Qn(e.prototype,t),i&&Qn(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function to(e){return to="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},to(e)}function io(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,o,a,s=[],l=!0,d=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(r=o.call(i)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){d=!0,n=e}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(d)throw n}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ro(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ro(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ro(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function no(e,t,i){return(t=ao(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function oo(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ao(r.key),r)}}function ao(e){var t=function(e,t){if("object"!=to(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=to(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==to(t)?t:t+""}var so=function(){return e=function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t,this.tag=i.tag,this.bitrate=i.bitrate,this.width=i.width,this.height=i.height,this.vpaidLog=i.vpaidLog,this.mediaFiles=no(no({},we.VIDEO,[]),Se.VPAID,[]),this.isOmidActive=this._isOMIDActive(),this.isMobile=this.store.get("isMobile"),this.fileSizeConfiguration=this.store.get("fileSizeConfiguration")},t=[{key:"_isOMIDActive",value:function(){return!(!this.tag.getValueByKey("enblomid")&&!this.store.get("omid.isActive"))&&(!(window.taboolaMobile&&window.taboolaMobile.isSupportOMSDK&&(0,m.Tn)(window.taboolaMobile.isSupportOMSDK))||window.taboolaMobile.isSupportOMSDK())}},{key:"destroy",value:function(){this.stopped||(this.stopped=!0,this.mediaFiles=this.fileSizeConfiguration=this.store=this.tag=this.vpaidLog=void 0)}},{key:"setHasOMID",value:function(e){this.hasOmid=e}},{key:"isEmpty",value:function(){for(var e=0,t=Object.entries(this.mediaFiles);e<t.length;e++){var i=io(t[e],2);if(i[0],i[1].length>0)return!1}return!0}},{key:"isBlockedForHeavyAds",value:function(){return this.blockedForHeavyAds}},{key:"pushMediaFiles",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;if(!this.stopped&&e&&0!==e.length){var r=e.length;this._setPreferedMediaFileType(e[0],t);var n=this._parseMediaFiles(e,i),o=n.urls,a=n.fallback,s=n.invalid;if(0!==o.length){(0,m.Hj)(this.vpaidLog,"vastMediaFiles",{urls:o},!1,!1);var l=this._chooseBestVideoMediaFile()||a;l&&(this.mediaFiles[we.VIDEO]=[l])}else this.blockedForHeavyAds=s===r}}},{key:"_setPreferedMediaFileType",value:function(e,t){e={textContent:e.content},this.preferedType=this._getDefaultPreferedType(),this.hasOmid?this.isOmidActive||(this.preferedType=Se.VPAID):(this.store.getByAdInline(t,e)||{}).pvpdJs&&(this.preferedType=Se.VPAID)}},{key:"_getDefaultPreferedType",value:function(){var e=this.tag.getValueByKey("prfrmdfl");return Object.values(we).includes(e)||Object.values(Se).includes(e)?e:we.VIDEO}},{key:"_parseMediaFiles",value:function(e,t){var i,r=this,n=[],o=this._shouldValidateFileSize(),a=0;return e.forEach((function(e){var s=r._parseMediaFile(e);if(!o||r._isFileSizeValid(s,t)){s.url&&n.push(s.url);var l=r._extractMediaFileType(s.type,s.subType);l&&(r._setSelectedMediaFileType(l),l!==we.VIDEO||i||(i=s),r.mediaFiles[l].push(s))}else a++})),{urls:n,fallback:i,invalid:a}}},{key:"_extractMediaFileType",value:function(e,t){return this.mediaFiles[e]?e:this.mediaFiles[t]?t:void 0}},{key:"_setSelectedMediaFileType",value:function(e){this.selectedMediaFileType?this.selectedMediaFileType!==e&&(this.hasMixedFileTypes=!0):this.selectedMediaFileType=e}},{key:"_shouldValidateFileSize",value:function(){return!(!this.fileSizeConfiguration||!this.fileSizeConfiguration.enabled||!this.fileSizeConfiguration.frameTypes||this.fileSizeConfiguration.frameTypes.indexOf(this.store.get("frameType"))<0||"number"!=typeof this.fileSizeConfiguration.threshold)}},{key:"_parseMediaFile",value:function(e){var t={url:e.content,bitrate:e.attributes.bitrate||0,width:e.attributes.width||0,height:e.attributes.height||0,originalType:e.attributes.type};t.url&&(t.url=t.url.trim()),"video/quicktime"===t.originalType&&this.store.get("wurfl.browser.name").indexOf(Ae)<0&&(t.originalType="video/mp4");var i,r=(i=t.originalType,Pe[i]||Pe.unknown),n=r.type,o=r.subType;return t.type=n,t.subType=o,t.ratio=t.width&&t.height?t.height/t.width:"1:1",t}},{key:"_chooseBestVideoMediaFile",value:function(){var e,t=this,i=this._getInitialCandidatesForBestVideoMediaFile();i=this._getFitToPlacementCandidates(i);var r=99999999;return i.forEach((function(i){var n=100*t._getRatioFactor(i.ratio)+t._getSizeFactor(i.width,i.height)+t._getBitrateFactor(i.bitrate);n<r&&(r=n,e=i)})),e}},{key:"_getInitialCandidatesForBestVideoMediaFile",value:function(){var e=[];return this.isMobile&&this.tag.isDirectDemand&&this.store.get("mblmdiadrctdmnd")&&(e=this.mediaFiles[we.VIDEO].filter((function(e){return e.url.indexOf("MOBILE")>-1}))),e.length>0?e:this.mediaFiles[we.VIDEO]}},{key:"_getFitToPlacementCandidates",value:function(e){var t=this,i=this.width>=this.height?"width":"height",r=e.filter((function(e){return e[i]>=t[i]}));return r.length>0?r:e}},{key:"_getRatioFactor",value:function(e){return Math.abs(this.height/this.width-e)}},{key:"_getSizeFactor",value:function(e,t){return Math.abs(this.width-e+(this.height-t))}},{key:"_getBitrateFactor",value:function(e){return Math.abs(this.bitrate-e)}},{key:"_isFileSizeValid",value:function(e,t){return!(!isNaN(t)&&!isNaN(e.bitrate)&&e.bitrate/8/1e3*t<this.fileSizeConfiguration.threshold)}},{key:"_hasPreferedMediaFiles",value:function(){var e=this.mediaFiles[this.preferedType];return e&&e.length>0}},{key:"getSelectedMediaFileType",value:function(){return this.hasMixedFileTypes&&this._hasPreferedMediaFiles()?this.preferedType:this.selectedMediaFileType}},{key:"getMediaFiles",value:function(){return this.stopped?{}:this.mediaFiles}}],t&&oo(e.prototype,t),i&&oo(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function lo(e){return lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lo(e)}function uo(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,co(r.key),r)}}function co(e){var t=function(e,t){if("object"!=lo(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=lo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==lo(t)?t:t+""}var ho=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.iframesWeights=t},(t=[{key:"detect",value:function(e,t){var i=this,r={};return e.map((function(e){var n=i._detectIframeTypeFromUrl(e,t);r[n]=r[n]||{urls:[],counter:0},r[n].urls.push(e),r[n].counter++})),r}},{key:"_detectIframeTypeFromUrl",value:function(e,t){return e.indexOf("imasdk")>-1?"ggl":t?"pxls":"gen"}},{key:"calculateWeightsByIframeType",value:function(e){var t=0;for(var i in e)t+=this.iframesWeights[i]*e[i].counter;return t}}])&&uo(e.prototype,t),i&&uo(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function po(e){return po="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},po(e)}function fo(e,t,i){return(t=yo(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function vo(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,yo(r.key),r)}}function yo(e){var t=function(e,t){if("object"!=po(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=po(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==po(t)?t:t+""}var mo={undefinedIframeSrc:"undefinedIframeSrc",event_AdImpression:"conversion",event_SoundViolation:"soundViolation",adStartTimeout:"adStartTimeout",AutoKill:"auto_kill",AdStopADTO:"before_startAd_timeout",queueTrimmed:"queueTrimmed",adPlayTimeout:"adPlayTimeout",queueExpired:"removed_from_queue",tagError:"tagError",vastFilterdByRegex:"vast_blacklisted",event_AdLoaded:"adLoaded",fetchVastXhr:"fetchVastXhr",fetchVastFallToXhr:"fetchVastFallToXhr",vpaidTimeout_AdLoaded:"adload_timeout",creatingVpaidHandler:"initVpaid",createdVpaidHandler:"before_adload",creatingVpaidHandlerError:"creatingVpaidHandlerError",networkError:"networkError",adUnitLoadFailed:"vpaid_unit_failed",adloadedTimeout:"adload_timeout",adImpressionTimeout:"adImpressionTimeout",playerClosed:"playerClosed",idleMode:"idleMode",hijackAttempt:"vpaid_blacklisted_url"},go=["conversion","soundViolation","timeout","bfRon","adPlayTimeout","vast_blacklisted","tagError","queueTrimmed","before_startAd_timeout","auto_kill","vpaidTimeout","creatingVpaidHandlerError","networkError","vpaid_unit_failed","adload_timeout","adImpressionTimeout","idleMode","vpaid_blacklisted_url","removed_from_queue"],_o={NoMediaFiles:"empty_vast",event_AdError:"ad_error",vastxhrerror_noflash:"vast_fetch_fail",WrapperError:"wrapper_error",ParsingError:"xml_parsing_error",NoMediaFileAfterSort:"unsupported_mediafile"},bo={BfRon:!0},Ao=function(){return e=function e(t,i){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tag=t,this.store=i,this.created=Date.now(),this.dataChanged=!1,this.friendlyVideoUrl=!1,this._setIframesDetector();var n=this.store.get("subUnitType");this.sessionStarted=this.store.get("session_started")||this.created,this.data={_id:(0,m.DA)(10),player_id:this.store.get("player_id"),tag:t,isMobile:t.isMobile,created:(new Date).toISOString(),timeSinceSessionStarted:this.created-this.sessionStarted,dp:t.dp,status:"new",statuses:["new"],itemScore:t.itemScore||-1,fullPageUrl:this.store.get("fullPageUrl"),documentVisible:!document.hidden,oneAuction:this.store.get("mltads"),su:null!=n?n:-99999,redId:this.store.get("red_id")||"na",displayLineItem:this.tag.lineItemId,updatesCount:0,serverSideDataSaver:this.store.get("serverSideDataSaver")||"na",clientSideDataSaver:this.store.get("clientSideDataSaver")||"na",dataSaver:this.store.get("dataSaver"),hasDsm:!!this.store.get("dsm"),hasVpaidAnalytics:!!this.store.get("analyticsFuncString"),isAmp:this.store.get("isAmp"),isCPCV:t.isCPCV,frameType:this.store.get("frameType")||-1,playWhenOutOfView:t.pwov,allowSlider:{isAllowed:!!this.tag.allowSlider,isActive:this.store.get("isSliderCutOff")||!1},unitElastic:{sessionId:this.store.get("elasticSessionId"),dependOnUnitForReporting:this.store.get("dpndonuntfrlgtoelstc"),shouldReport:this.store.get("shouldSendDataToElastic")&&void 0!==this.store.get("elasticSessionId")},dsm:t.dsm||{},inApp:this.store.get("isInApp")},this.isReportDb=!1,this.dtor=!1,this._dataModified=!0,this.updatingInterval=setInterval((function(){r._dataModified&&r._sendData()}),1e4)},t=[{key:"_setIframesDetector",value:function(){this.iframesDetector=this.store.get("iframesDetector"),this.iframesDetector||(this.iframesDetector=new ho(this.store.get("ifrmswghts")),this.store.set("iframesDetector",this.iframesDetector))}},{key:"push",value:function(e,t,i){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(this.data){if(e.indexOf("AdError")>-1||"event_SoundViolation"===e)this._addStatus(this._prettyErrorStatus(e,t));else if(mo.hasOwnProperty(e)&&"conversion"!==this.data.status)this._addStatus(mo[e]);else if(bo.hasOwnProperty(e)){var n="is"+e;this.data[n]=!0}if(r){var o=Date.now()-this.created;t.time=o}if(this._dataChanged(),!i&&this.data.hasOwnProperty(e))return Array.isArray(this.data[e])||(this.data[e]=[this.data[e]]),this.data[e].push(t),void(this.data[e].length>3&&this.data[e].splice(0,1));this.data[e]=t,-1!==go.indexOf(this.data.status)&&this._setDpStats()}}},{key:"_dataChanged",value:function(){this._dataModified=!0}},{key:"_sendData",value:function(){this._collectDataFromVpaidAnalytics(),this.data&&this.data.updatesCount++,(0,m.Q_)("analyitcs-vpaid","VpaidLog",this.data,this.store),this._dataModified=!1}},{key:"_collectDataFromVpaidAnalytics",value:function(){try{if(this.getVpaidAnalyticsReport){var e=this.getVpaidAnalyticsReport();e.realTotalRequestsCounter=e.totalRequestsCounter;var t=this.iframesDetector.detect(e.iframes,this.friendlyVideoUrl);e.totalRequestsCounter+=this.iframesDetector.calculateWeightsByIframeType(t),e.totalRequestsCounter-=e.iframes.length,this.push("vpaidAnalytics",e,!0),this.push("vpaidIframesDetection",t,!0)}}catch(e){this.push("vpaidAnalyticsCollectFail",{ex:e})}}},{key:"_prettyErrorStatus",value:function(e,t){var i=t.errType?t.errType:e;return _o.hasOwnProperty(i)?_o[i]:"error_".concat(i)}},{key:"_setDpStats",value:function(){if(!this.isDPStatusSet&&!this.store.get("static_schedule")){var e=Date.now();this.data.dtor=!0,this.data.timeFromLastPlayFromQueue=e-this.store.get("playFromQueue"),this.data.timeFromLastPlayFromQueueFound=e-this.store.get("playFromQueueFound"),this.isDPStatusSet=!0,this._incrStats(".tries");var t="".concat(this.tag.lineItem,".failsRow");if("conversion"===this.data.status){this._incrStats(".conversions");var i=this.store.get(t);this.store.multiSet(fo(fo(fo({},"".concat(this.tag.dp,".failsRow"),0),"".concat(this.tag.lineItem,".failsInARowTillConversion"),i<0?0:i),t,0))}else this._incrStats(".fails"),this.store.get(t)<0?this.store.set(t,1):this._incrStats(".failsRow");var r=this.store.get(this.tag.dp)||{fails:0,failsRow:0,conversions:0},n=this.store.get(this.tag.lineItem)||{};n.fails||(n.fails=0),n.failsRow||(n.failsRow=0),n.conversions||(n.conversions=0),r.lineItems=r.lineItems||[],-1===r.lineItems.indexOf(this.tag.lineItem)&&r.lineItems.push(this.tag.lineItem),this.data.lineItemLog=n,this.data.dpLog=r,this.data.conversionsCount=this.store.get("conversionsCount"),this.data.unit={width:this.store.get("width"),height:this.store.get("height")};var o=this.store.get("lineItems")||[];-1===o.indexOf(this.tag.lineItem)&&(o.push(this.tag.lineItem),this.store.set("lineItems",o)),this.store.set(this.tag.lineItem,n)}}},{key:"_incrStats",value:function(e){this.store.incr(this.tag.dp+e),this.store.incr(this.tag.lineItem+e)}},{key:"saveToDb",value:function(){this.saveToDbWithoutReport(),this._reportDb()}},{key:"saveToDbWithoutReport",value:function(){if(this.data){var e;this._collectDataFromVpaidAnalytics(),this._setDpStats();try{e=cmTag.utils.getLoopTime()}catch(e){}e&&(this.data.loopTime=e)}}},{key:"_reportDb",value:function(){this.isReportDb||(this.data.updatesCount++,(0,m.Q_)("analyitcs-vpaid","VpaidLog",this.data,this.store),this.tag=null,this.data=null,this.store=null,this.isReportDb=!0,this._dataModified=!1,clearInterval(this.updatingInterval))}},{key:"_addStatus",value:function(e){var t=this;-1===go.indexOf(this.data.status)&&(this.data.status=e,this.data.statuses.push(e),"conversion"===e&&setTimeout((function(){t._sendData()}),2e3))}},{key:"toString",value:function(){return(0,m.As)(this.data,4)}}],t&&vo(e.prototype,t),i&&vo(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function Eo(e){return Eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Eo(e)}function To(){return To=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e},To.apply(null,arguments)}function ko(){ko=function(){return t};var e,t={},i=Object.prototype,r=i.hasOwnProperty,n=Object.defineProperty||function(e,t,i){e[t]=i.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function d(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,i){return e[t]=i}}function u(e,t,i,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new D(r||[]);return n(a,"_invoke",{value:S(e,i,s)}),a}function c(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",p="suspendedYield",f="executing",v="completed",y={};function m(){}function g(){}function _(){}var b={};d(b,a,(function(){return this}));var A=Object.getPrototypeOf,E=A&&A(A(C([])));E&&E!==i&&r.call(E,a)&&(b=E);var T=_.prototype=m.prototype=Object.create(b);function k(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(n,o,a,s){var l=c(e[n],e,o);if("throw"!==l.type){var d=l.arg,u=d.value;return u&&"object"==Eo(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){d.value=e,a(d)}),(function(e){return i("throw",e,a,s)}))}s(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){i(e,r,t,n)}))}return o=o?o.then(n,n):n()}})}function S(t,i,r){var n=h;return function(o,a){if(n===f)throw Error("Generator is already running");if(n===v){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var l=P(s,r);if(l){if(l===y)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=f;var d=c(t,i,r);if("normal"===d.type){if(n=r.done?v:p,d.arg===y)continue;return{value:d.arg,done:r.done}}"throw"===d.type&&(n=v,r.method="throw",r.arg=d.arg)}}}function P(t,i){var r=i.method,n=t.iterator[r];if(n===e)return i.delegate=null,"throw"===r&&t.iterator.return&&(i.method="return",i.arg=e,P(t,i),"throw"===i.method)||"return"!==r&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=c(n,t.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,y;var a=o.arg;return a?a.done?(i[t.resultName]=a.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,y):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,y)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var i=t[a];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function i(){for(;++n<t.length;)if(r.call(t,n))return i.value=t[n],i.done=!1,i;return i.value=e,i.done=!0,i};return o.next=o}}throw new TypeError(Eo(t)+" is not iterable")}return g.prototype=_,n(T,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:g,configurable:!0}),g.displayName=d(_,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,d(e,l,"GeneratorFunction")),e.prototype=Object.create(T),e},t.awrap=function(e){return{__await:e}},k(w.prototype),d(w.prototype,s,(function(){return this})),t.AsyncIterator=w,t.async=function(e,i,r,n,o){void 0===o&&(o=Promise);var a=new w(u(e,i,r,n),o);return t.isGeneratorFunction(i)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(T),d(T,l,"Generator"),d(T,a,(function(){return this})),d(T,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),i=[];for(var r in t)i.push(r);return i.reverse(),function e(){for(;i.length;){var r=i.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=C,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function n(r,n){return s.type="throw",s.arg=t,i.next=r,n&&(i.method="next",i.arg=e),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),d=r.call(a,"finallyLoc");if(l&&d){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!d)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),O(i),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var n=r.arg;O(i)}return n}}throw Error("illegal catch attempt")},delegateYield:function(t,i,r){return this.delegate={iterator:C(t),resultName:i,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function wo(e,t,i,r,n,o,a){try{var s=e[o](a),l=s.value}catch(e){return void i(e)}s.done?t(l):Promise.resolve(l).then(r,n)}function So(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Po(r.key),r)}}function Po(e){var t=function(e,t){if("object"!=Eo(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Eo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Eo(t)?t:t+""}var Io="hijackAttempt",Oo={URL:"url",ACTION:"action"},Do={TB_COMPLETION:"tbCompletion",PWOV:"playWhenOutOfViewData",AD_STOPPED:"AdStopADTO",AUTO_KILL:"AutoKill",EARLY_AD_ERROR:"earlyError",AD_UNIT_LOAD_FAILED:"adUnitLoadFailed",CREATED_VPAID_HANDLER:"createdVpaidHandler",INIT_AD:"initAd",VIEWABILITY:"unitVieability",AD_OPTIONS:"adOptions",START_AD:"startAd",MEDIA_URL:"mediaUrl",VPAID_EVENTS:"event",VPAID_ANALYTICS:"vpaidAnalyticsUntil",AD_ICONS:"ad_choices",FAILED_TB_COMPLETION:"fireNewCompletionPrevented",COMPLETION_BEFORE_VIEWABILITY:"completionBeforeViewability",EARLY_AD_IMPRESSION:"earlyAdImpression",AD_SUCCESS:"success",RESTART_AD:"restartAd",ASYNC_AD_IMPRESSION:"fireAsyncAdimpression",AD_ERROR:"AdError",AD_SETTINGS:"adSettings",EARLY_AD_STOPPED:"earlyAdStopped",AD_FAILURE:"fails",HIJACK_ATTEMPT:Io,UNDEFINED_IFRAME_SRC:"undefinedRelativeIframeSrcError",MAX_NETWORK_CALLS:"vpaidAnalyticsCallLimit",VAST_PRICE:"vastPrice",STATUSES_ON_GET_AD:"statusesOnGetAd",WINNING_PRICE:"winningPrice",VPAID_RESOURCE_EVENT:"resourceEvent",VIDEO_ELEMENT_EVENT:"videoElement",CREATING_VPAID_HANDLER:"creatingVpaidHandler",CAN_PLAY:"canplay",VIDEO_BUFFER:"videoBuffer",SHOULD_SECURE_URL:"shouldSecureUrl",PAUSE_PROTECTION:"pauseAdProtection",UNFRIENDLY_IFRAME_SRC:"unfriendlyIframe",VPAID_VIDEO_URL:"jsVpaidVideoUrl",LOAD_AD_UNIT:"loadVPAIDJSScript",LOAD_AD_UNIT_ERROR:"loadVPAIDJSScriptErr",VIDEO_URL:"videoUrl",INIT_AD_ERROR:"initJsError",VPAID_VIDEO_TYPE:"jsVpaidVideo",VIDEO_PLAYING:"videoPlaying",SOUND_PROTECTION:"soundProtection",OMID_EVENT:"OMID",PREBID_BIDDER_REQUEST:"prebidBidderRequest",PREBID_BID_RESPONSE:"prebidBidResponse",PREBID_PRICE:"prebidPrice",AD_DURATION:"adDuration",NURL_PIXEL_FIRE:"nurlPixelFire",IIQ_IDS:"iiqIds",IMA_ERROR:"imaError",PREBID_HANDLER_ERROR:"prebidHandlerError",BLOCKED_CATEGORIES_AND_ADVERTISERS:"blockedCatAndAdv",BLOCKED_ADVERTISERS_ENFORCEMENT:"blockedAdvEnforcement",VAST_FILTERED_BY_REGEX:"vastFilterdByRegex",VAST_FILTERED_BY_VIDEO_BLACKLIST:"vastFilteredByVideoBlacklist",ACTUAL_VIDEO_SIZE:"actualVideoSize",PARSE_VAST_FROM_STRING:"parseVastFromString"},Co=[ke.A.AdDurationChange,ke.A.AdSizeChange,ke.A.AdLinearChange,ke.A.AdLog,ke.A.AdSkippableStateChange,ke.A.AdExpandedChange,ke.A.AdInteraction,ke.A.AdUserClose,ke.A.AdSkipped,ke.A.Progress,ke.A.AdVolumeChange],Vo=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t.store;var i=this._createVpaidLogTag(t.tag);this.vpaidLog=new Ao(i,this.store)},t=[{key:"_createVpaidLogTag",value:function(e){var t={auctionId:e.auctionId,advId:e.advId,dast:e.dast,price:e.price,queueNumber:e.queueNumber,cpmFloor:e.cpmFloor,dp:e.dp,rollType:e.rollType,lineItem:e.lineItem,unitType:this.store.get("unit_type"),unitVersion:this.store.get("unit_version"),isMobile:this.store.get("isMobile")||!1,rpox:e.rpox,alfrox:e.alfrox,frox:e.frox,waterfallIndex:e.wfIndex,itemType:e.itemType,requiredViewability:e.requiredViewability,requiredViewabilityDrawn:e.requiredViewabilityDrawn,flad:e.flad||e.flad_delay||0,brand:e.brand,priority:e.priority,isCPCV:e.isCPCV,backfillDelayed:!!e.isBackfillDelayed,getValueByKey:e.getValueByKey,pwov:e.pwov,allowSlider:e.alwsldr,dsm:e.dsm,itemScore:e.score||-1};return e.crId&&(t.stId=e.stId,t.cmpgnId=e.cmpgnId,t.itemType=e.itemType),t}},{key:"_logToElastic",value:function(e,t,i,r){this.stopped||(0,m.Hj)(this.vpaidLog,e,t,i,r)}},{key:"logTBCompletion",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._logToElastic(Do.TB_COMPLETION,{enabled:!0,length:e,byProgress:t})}},{key:"logPlayWhenOutOfView",value:function(e,t){this._logToElastic(Do.PWOV,{playWhenOutOfViewValue:e,costModel:t})}},{key:"logAdStopped",value:function(){this._logToElastic(Do.AD_STOPPED,{})}},{key:"logAutoKill",value:function(e){this._logToElastic(Do.AUTO_KILL,{timeout:e})}},{key:"logEarlyAdError",value:function(e){this._logToElastic(Do.EARLY_AD_ERROR,{errMsg:e})}},{key:"logAdUnitLoadFailed",value:function(e){this._logToElastic(Do.AD_UNIT_LOAD_FAILED,{errMsg:e})}},{key:"logCreatedVpaidHandler",value:function(){this._logToElastic(Do.CREATED_VPAID_HANDLER,{})}},{key:"logInitAd",value:function(){this._logToElastic(Do.INIT_AD,{})}},{key:"logViewability",value:function(){this._logToElastic(Do.VIEWABILITY,{isFired:!0})}},{key:"logAdOptions",value:function(e){this._logToElastic(Do.AD_OPTIONS,{count:e.count,getAdRetries:e.getAdRetries,requiredViewability:e.requiredViewability,predictorId:e.predictId},!1,!1)}},{key:"logStartAd",value:function(){this._logToElastic(Do.START_AD,{})}},{key:"logMediaUrl",value:function(e){this._logToElastic(Do.MEDIA_URL,{url:e},!1,!1)}},{key:"logVpaidEvent",value:function(e,t,i){Co.indexOf(e)>-1||this._logToElastic("".concat(Do.VPAID_EVENTS,"_").concat(e),{isViewable:!document.hidden,vidCurrentime:i,eventDataStr:t})}},{key:"logVpaidAnalytics",value:function(e,t){this._logToElastic("".concat(Do.VPAID_ANALYTICS).concat(e),t)}},{key:"logAdIcons",value:function(e,t){this._logToElastic(Do.AD_ICONS,{vpaid:{error:e,result:t}},!1,!1)}},{key:"logFailedTBCompletion",value:function(e){this._logToElastic(Do.FAILED_TB_COMPLETION,{reason:e},!1,!1)}},{key:"logCompletionBeforeViewability",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"na";this._logToElastic(Do.COMPLETION_BEFORE_VIEWABILITY,{videoTime:(0,m.vZ)(e)||-1,newCompletionByVideoProgress:t,reason:i,paused:e.paused||!1,ended:e.ended||!1})}},{key:"logEarlyAdImpression",value:function(){this._logToElastic(Do.EARLY_AD_IMPRESSION,{early:!0})}},{key:"logAdSuccess",value:function(e){this._logToElastic(Do.AD_SUCCESS,{count:e},!0,!1)}},{key:"logRestartAd",value:function(e){this._logToElastic(Do.RESTART_AD,{isReplayable:e},!1,!1)}},{key:"logAsyncAdImpressionFired",value:function(){this._logToElastic(Do.ASYNC_AD_IMPRESSION,{end:!0})}},{key:"logAdError",value:function(e){this._logToElastic(Do.AD_ERROR,{errType:e.type,handlerType:e.handlerType,isPraserError:!0})}},{key:"logAdSettings",value:function(e){0!==Object.keys(e).length&&this._logToElastic(Do.AD_SETTINGS,e,!0,!1)}},{key:"logEarlyAdStopped",value:function(){this._logToElastic(Do.EARLY_AD_STOPPED,{early:!0},!0,!1)}},{key:"logStopReason",value:function(e,t,i){e&&e!==Io&&this._logToElastic(e,{status:t,eventDataStr:i})}},{key:"logAdFailure",value:function(e){this._logToElastic(Do.AD_FAILURE,{count:e},!0,!1)}},{key:"logMaliciousUrl",value:function(e){this._logToElastic(Do.HIJACK_ATTEMPT,{type:Oo.URL,badUrl:e.url,earlyHijack:e.isEarly||!1},!1,!1)}},{key:"logMaliciousActions",value:function(e){this._logToElastic(Do.HIJACK_ATTEMPT,{type:Oo.ACTION,action:e})}},{key:"logUndefinedIframeSource",value:function(e){this._logToElastic(Do.UNDEFINED_IFRAME_SRC,{url:e})}},{key:"logMaxNetworkCalls",value:function(e,t){this._logToElastic(Do.MAX_NETWORK_CALLS,{adImpression:e,limitExceeded:!0,maxNetworkCalls:t})}},{key:"logVastPrice",value:function(e){0!==e&&this._logToElastic(Do.VAST_PRICE,{value:e})}},{key:"logStatusesOnGetAd",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3?arguments[3]:void 0;this._logToElastic(Do.STATUSES_ON_GET_AD,{status:e,hadImpression:t,isStarted:i,requiredViewability:r})}},{key:"logWinningPrice",value:function(e){this._logToElastic(Do.WINNING_PRICE,e,!1,!1)}},{key:"logVpaidResourceEvent",value:function(e){this._logToElastic(Do.VPAID_RESOURCE_EVENT,e,!1,!1)}},{key:"logVideoElementEvent",value:function(e){this._logToElastic(Do.VIDEO_ELEMENT_EVENT,{isAutoplaySupported:e},!1,!1)}},{key:"logCreatingVpaidHandler",value:function(e,t){var i={type:e};t||(i.error="typeNotFound"),this._logToElastic(Do.CREATING_VPAID_HANDLER,i)}},{key:"logCanPlay",value:function(){this._logToElastic(Do.CAN_PLAY,{videoCanPlay:!0})}},{key:"logVideoBuffer",value:function(e,t){t&&this._logToElastic(Do.VIDEO_BUFFER,{status:e,buffered:t},!1,!1)}},{key:"logShouldSecureUrl",value:function(e){this._logToElastic(Do.SHOULD_SECURE_URL,{replacedProtocol:e},!1,!1)}},{key:"logPauseProtection",value:function(e,t){this._logToElastic(Do.PAUSE_PROTECTION,{paused:e,adRestarted:t})}},{key:"logUnfriendlyIframeSource",value:function(e){this._logToElastic(Do.UNFRIENDLY_IFRAME_SRC,{src:e})}},{key:"logVpaidVideoUrl",value:function(e){this._logToElastic(Do.VPAID_VIDEO_URL,{videoUrl:e})}},{key:"logLoadAdUnit",value:function(){this._logToElastic(Do.LOAD_AD_UNIT,{scriptLoaded:!0})}},{key:"logLoadAdUnitErrorMessage",value:function(e){this._logToElastic(Do.LOAD_AD_UNIT_ERROR,{err:e})}},{key:"logLoadAdUnitError",value:function(){this._logToElastic(Do.LOAD_AD_UNIT,{scriptLoadedError:!0})}},{key:"logVideoUrl",value:function(e){e&&this._logToElastic(Do.VIDEO_URL,{url:e})}},{key:"logInitAdError",value:function(e,t,i,r){this._logToElastic(Do.INIT_AD_ERROR,{err:e,funcName:t,args:i,stack:r})}},{key:"logVpaidVideoType",value:function(e){this._logToElastic(Do.VPAID_VIDEO_TYPE,{videoType:e})}},{key:"logVideoPlaying",value:function(e){this._logToElastic(Do.VIDEO_PLAYING,{vidCurrentTime:e})}},{key:"logSoundProtection",value:function(e,t){this._logToElastic(Do.SOUND_PROTECTION,{selfSound:e,videoSound:t})}},{key:"logOMIDEvent",value:function(e){var t,i,r;this._logToElastic(Do.OMID_EVENT,(t={},r=!0,(i=Po(i=e))in t?Object.defineProperty(t,i,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[i]=r,t))}},{key:"logPrebidBidderRequest",value:function(e){this._logToElastic(Do.PREBID_BIDDER_REQUEST,{req:(0,m.As)(e)})}},{key:"logPrebidBidResponse",value:function(e){this._logToElastic(Do.PREBID_BID_RESPONSE,{bids:JSON.stringify(e)})}},{key:"logPrebidPricing",value:function(e,t,i,r){this._logToElastic(Do.PREBID_PRICE,{cpm:e||0,currency:t||"N/A",adjustedPrice:i,floor:r||"N/A",isBelowFloor:i<r})}},{key:"logAdDuration",value:function(e){isNaN(e)||this._logToElastic(Do.AD_DURATION,{val:parseInt(e)},!0,!1)}},{key:"postData",value:(r=ko().mark((function e(t){return ko().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,e.next=4,fetch("//vidanalytics.taboola.com/putes/client-debug",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});case 4:if(e.sent.ok){e.next=7;break}throw new Error("could not send data to server");case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(1);case 11:case"end":return e.stop()}}),e,null,[[1,9]])})),n=function(){var e=this,t=arguments;return new Promise((function(i,n){var o=r.apply(e,t);function a(e){wo(o,i,n,a,s,"next",e)}function s(e){wo(o,i,n,a,s,"throw",e)}a(void 0)}))},function(e){return n.apply(this,arguments)})},{key:"logNURLPixelFire",value:function(e){var t=To({},(function(e){if(null==e)throw new TypeError("Cannot destructure "+e)}(e),e));this.postData(t)}},{key:"logIIQIds",value:function(e){e&&this._logToElastic(Do.IIQ_IDS,{ids:JSON.stringify(e)},!0,!1)}},{key:"logIMAError",value:function(e){this._logToElastic(Do.IMA_ERROR,{error:e})}},{key:"logPrebidHandlerError",value:function(e){this._logToElastic(Do.PREBID_HANDLER_ERROR,{error:e})}},{key:"logBlockedCategoriesAndAdvertisers",value:function(e,t){(e||t)&&this._logToElastic(Do.BLOCKED_CATEGORIES_AND_ADVERTISERS,{bcat:e,badv:t},!0,!1)}},{key:"logBlockedAdvertiserEnforcement",value:function(e){this._logToElastic(Do.BLOCKED_ADVERTISERS_ENFORCEMENT,{advDomains:e},!0,!1)}},{key:"logVastFilteredByRegex",value:function(){var e={regex:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",match:arguments.length>0&&void 0!==arguments[0]?arguments[0]:""},t=Do.VAST_FILTERED_BY_REGEX;arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&(t=Do.VAST_FILTERED_BY_VIDEO_BLACKLIST),this._logToElastic(t,e,!0,!1)}},{key:"logParseVastFromString",value:function(e){this._logToElastic(Do.PARSE_VAST_FROM_STRING,{xml:e},!1,!1)}},{key:"logActualVideoSize",value:function(e,t){this._logToElastic(Do.ACTUAL_VIDEO_SIZE,{width:e,height:t,isVertical:t>e},!0,!1)}},{key:"destroy",value:function(){this.stopped=!0,this.vpaidLog=this.store=void 0}},{key:"vpaidLog",get:function(){return this._vpaidLog},set:function(e){this._vpaidLog=e}}],t&&So(e.prototype,t),i&&So(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i,r,n}();function Ro(e){return Ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ro(e)}function Lo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,o,a,s=[],l=!0,d=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(r=o.call(i)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){d=!0,n=e}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(d)throw n}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Mo(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Mo(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mo(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function xo(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Fo(r.key),r)}}function Fo(e){var t=function(e,t){if("object"!=Ro(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Ro(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ro(t)?t:t+""}var No="progress",Bo="impression",Uo={CLICK_THROUGH:"clickthrough",CLICK_THRU:"clickthru",AD_CLICK_TRACKING:"adclicktracking",CLICK_TRACKING:"clicktracking"},Wo="EMPTY_PIXEL",jo="time",Ho="percentage",Go="img",qo="js",zo="[CACHEBUSTING]",Qo="[ERRORCODE]",Ko="[TIMESTAMP]",Yo="[ASSETURI]",Xo="[CONTENTPLAYHEAD]",Jo="invalid url",Zo="image error",$o=function(){return e=function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t,this.tag=i.tag,this.vpaidLog=i.vpaidLog,this.debugTracker=new y.A("TrackingPixelManager"),this.trackingPixels={adimpression:[],impression:[],aderror:[],error:[],adclickthru:[],clickthru:[],adclickthrough:[],clickthrough:[],adclicktracking:[],clicktracking:[],adoloaded:[],loaded:[],adstarted:[],started:[],adstopped:[],stopped:[],adskipped:[],skipped:[],adskippablestatechange:[],skippablestatechange:[],adsizechange:[],sizechange:[],adlinearchange:[],linearchange:[],addurationchange:[],durationchange:[],adexpandedchange:[],expandedchange:[],advolumechange:[],volumechange:[],advideostart:[],start:[],advideofirstquartile:[],firstquartile:[],advideomidpoint:[],midpoint:[],advideothirdquartile:[],thirdquartile:[],advideocomplete:[],complete:[],adinteraction:[],interaction:[],aduseracceptinvitation:[],acceptinvitation:[],aduserminimize:[],minimize:[],aduserclose:[],close:[],adpaused:[],paused:[],pause:[],adplaying:[],playing:[],resume:[],adlog:[],log:[],admute:[],mute:[],adunmute:[],unmute:[],adfullscreen:[],fullscreen:[],creativeview:[],progress:[],viewability:[],viewable50precent1sec:[],fullyviewable1sec:[]},this.firedPixels=[],this.firedUrls=[],this.isPaused=!1,this.replaceExternalPixels=this.store.get("rplcpxlmcrplchldr"),this.pixelsToFireMultipleTimes=this.store.get("frmltplpxls")||[],this.adElasticLogger=new Vo({store:this.store,tag:this.tag})},t=[{key:"destroy",value:function(){this.stopped||(this.stopped=!0,this.trackingPixels=this.debugTracker=this.firedPixels=this.firedUrls=this.pixelsToFireMultipleTimes=this.store=this.tag=this.vpaidLog=void 0)}},{key:"pushPixel",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Go,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};this.stopped||e&&t&&"about:blank"!==t&&(e=e.toLowerCase(),this.trackingPixels[e]&&(e!==No?this.trackingPixels[e].push({pixel:t,method:r.toLowerCase(),options:n}):this._pushProgressPixel(t,i,r)))}},{key:"_pushProgressPixel",value:function(e,t,i){var r=t.attributes.offset;if(r){var n=r.indexOf("%")>-1?Ho:jo;this.trackingPixels[No]={pixel:e,offset:this._convertOffsetByType(r,n),offsetType:n,fired:!1,method:i.toLowerCase()}}}},{key:"_convertOffsetByType",value:function(e,t){return t===Ho?parseInt(e.replace("%",""))/100:t===jo?(0,m.Ob)(e):void 0}},{key:"isEmpty",value:function(){for(var e=0,t=Object.entries(this.trackingPixels);e<t.length;e++){var i=Lo(t[e],2);if(i[0],i[1].length>0)return!1}return!0}},{key:"firePixel",value:function(e,t){var i=this;return!!this.isPaused||(this._isValid(e)?(this.firedPixels.push(e),this.getPixels(e).forEach((function(r){i._sendPixel(r.pixel,r.method,e,t,r.options)})),!0):((0,m.Hj)(this.vpaidLog,"invalidPixel",{pixelType:e||Wo},!1,!1),!1))}},{key:"_isValid",value:function(e){return!!e&&(e!==ke.A.AdVideoComplete||this.firedPixels.indexOf(ke.A.AdVideoThirdQuartile)>-1)}},{key:"_sendPixel",value:function(e,t,i,r,n){if(!(this.firedUrls.indexOf(e)>-1))if((0,m.AY)(e)){this.pixelsToFireMultipleTimes.indexOf(i)<0&&this.firedUrls.push(e);try{e=this._replaceMacros(e.trim(),r),this.tag.getValueByKey("pxlnotsmtp")||(e=this._addCachebustTimestamp(e)),t===Go?(0,m._x)(e,this._reportInvalidPixel.bind(e,Zo)):t===qo&&this._fireScriptPixel(e),n.isNurl&&this.adElasticLogger.logNURLPixelFire({pixelUrl:e,pixelType:i,method:t})}catch(t){this.debugTracker.warn("Fire pixel",{status:"fail",ex:t,pixelUrl:e})}}else this._reportInvalidPixel(e,Jo)}},{key:"_replaceMacros",value:function(e,t){return e=(0,m.gM)(e,this.store,t),e=this._replaceCachebustingMacro(e),this.replaceExternalPixels&&(e=this._replaceErrorMacro(e,t),e=this._replaceTimestampMacro(e),e=this._replaceVideoMacro(e,t),e=this._replaceVideoCurrentTimeMacro(e,t)),e}},{key:"_replaceCachebustingMacro",value:function(e){if(e.indexOf(zo)<0)return e;var t=Date.now().toString().substring(5);return e.replace(zo,t)}},{key:"_replaceErrorMacro",value:function(e,t){if(e.indexOf(Qo)<0)return e;var i=(0,m.Ok)(t);return e.replace(Qo,i)}},{key:"_replaceTimestampMacro",value:function(e){return e.indexOf(Ko)<0?e:e.replace(Ko,(new Date).toISOString())}},{key:"_replaceVideoMacro",value:function(e,t){return e.indexOf(Yo)<0||!t||!t.dispatcher||!t.dispatcher.getVideoUrl?e.replace(Yo,""):e.replace(Yo,t.dispatcher.getVideoUrl())}},{key:"_replaceVideoCurrentTimeMacro",value:function(e,t){if(e.indexOf(Xo)<0||!t||!t.dispatcher||!t.dispatcher.video)return e.replace(Xo,"");var i=(0,m.vZ)(t.dispatcher.video);if(!i)return e.replace(Xo,"");var r=Math.floor(i/60);r=r<10?"0".concat(r):r;var n=Math.floor(i%60);n=n<10?"0".concat(n):n;var o=i.toFixed(3).split(".")[1];return e.replace(Xo,"00:".concat(r,":").concat(n,".").concat(o))}},{key:"_addCachebustTimestamp",value:function(e){return"".concat(e).concat(e.search(/\?/)>-1?"&":"?").concat((new Date).getTime())}},{key:"_reportInvalidPixel",value:function(e,t){(0,m.Hj)(this.vpaidLog,"fireInvalidPixel",{url:e,err:t},!1,!1)}},{key:"_fireScriptPixel",value:function(e){var t=document.createElement("script");t.src=e,t.type="text/javascript",t.async=!0,document.body.appendChild(t)}},{key:"pause",value:function(){this.isPaused=!0}},{key:"extractWinningPrice",value:function(e){var t={found:!1,price:void 0};if(!e)return t;var i=this.getPixels(Bo),r=new RegExp("".concat(e,"=(.*?)(&|$)"),"gi");return i.forEach((function(e){var i=r.exec(e.pixel);if(i&&i.length>1){var n=i[1];n&&(0,m.Kk)(n)&&(t.found=!0,t.price=n)}})),t}},{key:"getPixels",value:function(e){var t=this;return this._getLinkedPixelTypes(e).map((function(e){if(t.trackingPixels&&t.trackingPixels[e])return t.trackingPixels[e]})).filter((function(e){return e&&e.length>0})).reduce((function(e,t){return e.concat(t)}),[])}},{key:"_getLinkedPixelTypes",value:function(e){var t=[];return e?((e=this._cleanPixelType(e))===Uo.CLICK_THROUGH||e===Uo.CLICK_THRU?t.push(Uo.AD_CLICK_TRACKING,Uo.CLICK_TRACKING):(t.push(e,"aduser".concat(e),"advideo".concat(e),"ad".concat(e)),(0,m.d5)(e,"ed")&&(e=e.slice(0,e.length-(this._isPixelTypeContainConsonantChar(e)?3:2)),t.push(e))),t):t}},{key:"_cleanPixelType",value:function(e){return e.toLowerCase().replace(/^advideo|^aduser|^ad/gi,"")}},{key:"_isPixelTypeContainConsonantChar",value:function(e){return!((e=e.replace(/ed$/,"")).length<2)&&e.charAt(e.length-1)===e.charAt(e.length-2)}},{key:"hasPixels",value:function(e){return this.trackingPixels[e].length>0}}],t&&xo(e.prototype,t),i&&xo(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function ea(e){return ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ea(e)}function ta(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,o,a,s=[],l=!0,d=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(r=o.call(i)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){d=!0,n=e}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(d)throw n}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ia(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ia(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ia(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function ra(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,na(r.key),r)}}function na(e){var t=function(e,t){if("object"!=ea(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=ea(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ea(t)?t:t+""}var oa=function(){return e=function e(t,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(0,j.mixin)(this),this.store=t,this.options=i,this.vpaidLog=this.options.vpaidLog,this.tag=this.options.tag,this.jsTrackers=this.tag.jsTrackers||[],this.vasts=[],this.maxNumberOfVastWrappers=this.store.get("mxwrps"),this.stopped=!1,this.debugTracker=new y.A("RawVastHandler"),this.mediaFiles=new so(this.store,this.options),this.trackingPixelManager=new $o(this.store,this.options),this.adElasticLogger=new Vo({store:this.store,tag:this.tag}),this._setVastRegex(),this.secureWrapperUrls=(0,m.VT)(t)},t=[{key:"_setVastRegex",value:function(){var e=this.tag.getValueByKey("regx");e&&(this.regex=new RegExp(e,"i"))}},{key:"_decodeRegex",value:function(e){return e.map((function(e){try{return atob(e)}catch(t){return e}})).join("|")}},{key:"parseVastFromXML",value:function(e){if(!this.stopped)if(this._filterVastByRegex(e))this._onError(sa.FILTER_BY_REGEX,{response:e},V.MH.FILTER_VAST_BY_REGEX);else{this.adElasticLogger.logParseVastFromString(e);var t=new eo(e,this.store,this.options);this.vasts.push(t),this._extractAdDataFromVast(t),this._extractTrackingPixels(t),this._extractLandingPageUrl(t),this._analyzeVast(t),t.isInlineVast()?this._handleInlineVast(t):t.isWrapperVast()?this._handleWrapperVast(t):this._onError(sa.EMPTY_VAST,{response:t.getRawXML()},V.MH.EMPTY_VAST)}}},{key:"_isNumberOfWrappersReachedCap",value:function(){return this.maxNumberOfVastWrappers>0&&this.vasts.length>=this.maxNumberOfVastWrappers}},{key:"_handleInlineVast",value:function(e){var t=e.extractMediaFiles();this.mediaFiles.pushMediaFiles(t,this._extractAdInlines(),this.duration),this.mediaFiles.isEmpty()?e.isWrapperVast()?this._handleWrapperVast(e):this._onMediaFilesParsingError(e):this._onMediaFilesParsedSuccessfully(e)}},{key:"_onMediaFilesParsingError",value:function(e){var t,i;this.debugTracker.error("Vast","No media files!"),this.mediaFiles.isBlockedForHeavyAds()?(t=sa.BLOCKED_FOR_HEAVY_ADS,i=V.MH.HEAVY_ADS_BLOCK):(t=sa.NO_MEDIA_FILES_AFTER_SORT,i=V.MH.MEDIA_FILE_NOT_SUPPORTED),this._onError(t,{response:e.getRawXML()},i)}},{key:"_extractTrackingPixels",value:function(e){this._extractImpressionPixels(e),this._extractErrorPixels(e),this._extractClickPixels(e),this._extractTrackingEvents(e),this._extractCustomTrackingEvents(e),this._addUnitEventTrackers(),this._addExternalEventTrackers()}},{key:"_extractImpressionPixels",value:function(e){var t=this,i=e.extractPixels(la.IMPRESSION);(i=i.concat(this._getInternalImpressionPixels())).forEach((function(e){return t.trackingPixelManager.pushPixel(la.IMPRESSION,e)}))}},{key:"_getInternalImpressionPixels",value:function(){if(this.addedImpressionPixels)return[];this.addedImpressionPixels=!0;var e=[];return this.tag.pixel&&e.push(this.tag.pixel),e=e.concat(this.tag.conversionPixels)}},{key:"_extractErrorPixels",value:function(e){var t=this;e.extractPixels(la.ERROR).forEach((function(e){return t.trackingPixelManager.pushPixel(la.ERROR,e)}))}},{key:"_extractClickPixels",value:function(e){var t=this;e.extractPixels(la.CLICK_TRACKING).forEach((function(e){return t.trackingPixelManager.pushPixel(la.CLICK_TRACKING,e)})),this.tag.nas&&this.tag.nas.link&&this.trackingPixelManager.pushPixel(la.CLICK_TRACKING,this.tag.nas.link)}},{key:"_extractTrackingEvents",value:function(e){var t=this;e.hasTrackingPixels()&&e.extractTrackingPixels().forEach((function(i){var r=i.attributes.event,n=e.extractURLFromTag(i);t.trackingPixelManager.pushPixel(r,n,i)}))}},{key:"_extractCustomTrackingEvents",value:function(e){var t=this;if(e.hasCustomTrackingPixels())for(var i=function(){var i=ta(n[r],2),o=i[0],a=i[1];e.extractPixelsByType(o.toLowerCase()).forEach((function(i){var r=e.extractURLFromTag(i);t.trackingPixelManager.pushPixel(a,r,i)}))},r=0,n=Object.entries(da);r<n.length;r++)i()}},{key:"_addUnitEventTrackers",value:function(){for(var e=this,t=function(){var t=ta(r[i],2),n=t[0],o=t[1];o&&o.forEach((function(t){return e.trackingPixelManager.pushPixel(n,t.url,{},t.type,{isNurl:t.isNurl})}))},i=0,r=Object.entries(this.tag.eventTrackers);i<r.length;i++)t()}},{key:"_addExternalEventTrackers",value:function(){var e=this.store.get("expxls");if(e)for(var t=0,i=Object.entries(e);t<i.length;t++){var r=ta(i[t],2),n=r[0],o=r[1];this.trackingPixelManager.pushPixel(n,o)}}},{key:"_extractLandingPageUrl",value:function(e){this.landingPageUrl=e.extractLandingPageUrl()}},{key:"_isHandlingFirstVast",value:function(){return 1===this.vasts.length}},{key:"_analyzeVast",value:function(e){var t=e.extractAd(),i=e.extractAdInline(),r=i.as,n=i.at,o=e.extractWrapperUrl();this.vastAnalysis={},t&&(this.vastAnalysis.aid=t.attributes.id),r&&(this.vastAnalysis.as=r,(0,m.Hj)(this.vpaidLog,"adSystem",{system:r},!1,!1)),n&&(this.vastAnalysis.at=n),o&&(this.vastAnalysis.wu=o)}},{key:"_onMediaFilesParsedSuccessfully",value:function(e){this._extractAdParameters(e),this._publishResponse(e)}},{key:"_extractAdParameters",value:function(e){this.adParameters=e.extractAdParameters()}},{key:"_publishResponse",value:function(e){this._publishVastXMLToTRC(e.getRawXML()),this._publishVastData(e)}},{key:"_publishVastXMLToTRC",value:function(e){this.store.get("report_vast_xml")&&window.TRC.vastXmlList.push(e)}},{key:"_publishVastData",value:function(e){var t=this.mediaFiles.getSelectedMediaFileType();(0,m.Hj)(this.vpaidLog,"vpiadWrapperFound",{wrapperMode:t},!1,!1);var i={type:t,handlerOptions:{adParams:this.adParameters,vpaidFiles:this.mediaFiles.getMediaFiles(),extra:{duration:this.duration}},vastOptions:{price:this.price,icons:this.icons,analysis:this.vastAnalysis||{},omidElements:this.omidElements,hasOmid:e.hasOMID()||!1,omidVendor:e.getOMIDVendor()||"",landingPage:this.landingPageUrl||""},trackingPixelManager:this.trackingPixelManager};this.emit(aa.MEDIA_FILES_FOUND,i)}},{key:"_extractAdInlines",value:function(){return this.vasts.map((function(e){return e.extractAdInline()}))}},{key:"_handleWrapperVast",value:function(e){if(this._isNumberOfWrappersReachedCap())this._onError(sa.MAX_WRAPPERS,{response:e.getRawXML(),maxNumberOfWrappers:{hasReachedCap:!0,cap:this.maxNumberOfVastWrappers}},V.MH.MAX_WRAPPERS);else{var t=e.extractWrapperUrl();t?(t=(0,m.gM)(t,this.store),t=this.secureWrapperUrls?t.replace("http:","https:"):t,this._isHandlingFirstVast()&&(0,m.Hj)(this.vpaidLog,"VastWrapper",{type:"wrapper"}),this.parseVastFromURL(t)):this._onError(sa.MISSING_WRAPPER_URL,{response:e.getRawXML()},V.MH.VAST_WRAPPER_ERROR)}}},{key:"_extractAdDataFromVast",value:function(e){e.didParsingFailed()?this._onError(sa.PARSING_FAILED,{response:e.getRawXML()},V.MH.VAST_ERROR):(this.vastVersion=e.extractVastVersion(),this.price=e.extractPrice(),this.icons=e.extractIcons(),this.omidElements=(this.omidElements||[]).concat(e.extractOMIDElements()),this.mediaFiles.setHasOMID(e.hasOMID()),this.duration=e.extractDuration())}},{key:"parseVastFromURL",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";!this.stopped&&e&&(this._shouldAddInstreamPlacement()&&(e+="".concat(e.includes("?")?"&":"?","plcmnt=2")),e=this._replaceCachebust((0,m.Bq)(e)),(0,m.Hj)(this.vpaidLog,"parseVastFromUrl",{url:e},!1,!1),this._fetchVast(e,t))}},{key:"_replaceCachebust",value:function(e){return e.replace(/\[CACHEBUSTER\]/,Date.now())}},{key:"_shouldAddInstreamPlacement",value:function(){return this.store.get("iscntntactv")&&this.tag.getValueByKey("instrmplcmnt")}},{key:"_fetchVast",value:function(e,t){ie(e,t,this._onFetchResponse.bind(this),this._onFetchError.bind(this,sa.VAST_FETCH_FAIL,{url:e}),void 0,void 0,void 0,void 0,this.store.get("psthdrs")||"application/json")}},{key:"_onFetchResponse",value:function(e,t){this.stopped||(this.debugTracker.info("Vast was loaded",{vast:e}),(0,m.Hj)(this.vpaidLog,"tagResponse",{response:e,xhrErrors:t},!0,!1),e=(0,m.gM)(e,this.store,{},this.tag),this.parseVastFromXML(e))}},{key:"_filterVastByRegex",value:function(e){if(!this.regex)return!1;var t=this.regex.exec(e);return!!(t&&t.length>0)&&(this.adElasticLogger.logVastFilteredByRegex(t[0],!1,this.regex.toString()),!0)}},{key:"_onFetchError",value:function(e,t,i){t.fetchErrors=(0,m.As)(i),this._onError(e,t)}},{key:"_onError",value:function(e,t,i){this.debugTracker.error("Error while parsing vast",e,t),(0,m.Hj)(this.vpaidLog,e,t||{}),this.emit(aa.ERROR,{type:e,data:t,adEvent:i})}},{key:"destroy",value:function(){this.stopped||(this.stopped=!0,this._destroyVastParsers(),this.mediaFiles.destroy(),this.trackingPixelManager.destroy(),this.mediaFiles=this.trackingPixelManager=this.debugTracker=this.icons=this.jsTrackers=this.omidElements=this.options=this.store=this.tag=this.vpaidLog=void 0)}},{key:"_destroyVastParsers",value:function(){this.vasts.forEach((function(e){e.destroy(),e=void 0})),this.vasts=void 0}},{key:"hasTrackingPixels",value:function(){return!this.trackingPixelManager.isEmpty()}},{key:"fireErrorPixels",value:function(){this.trackingPixelManager.firePixel(la.ERROR)}}],t&&ra(e.prototype,t),i&&ra(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}(),aa={MEDIA_FILES_FOUND:"mediaFilesFound",ERROR:"error"},sa={VAST_FETCH_FAIL:"vastxhrerror_noflash",FILTER_BY_REGEX:"VastFilterdByRegex",PARSING_FAILED:"ParsingError",MISSING_MEDIA_FILES:"MissingMediaFiles",BLOCKED_FOR_HEAVY_ADS:"BlockedForHeavyAds",NO_MEDIA_FILES_AFTER_SORT:"NoMediaFileAfterSort",MISSING_WRAPPER_URL:"WrapperError",EMPTY_VAST:"noMediaFilesAndWrapper",MAX_WRAPPERS:"maxWrappers"},la={IMPRESSION:"impression",ERROR:"error",CLICK_TRACKING:"clicktracking",VIEWABILITY:"viewability"},da={MEASURABLE_IMPRESSION:la.IMPRESSION,VIEWABLE_IMPRESSION:la.VIEWABILITY};function ua(e){return ua="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ua(e)}function ca(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,pa(r.key),r)}}function ha(e,t,i){return t&&ca(e.prototype,t),i&&ca(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function pa(e){var t=function(e,t){if("object"!=ua(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=ua(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ua(t)?t:t+""}const fa=ha((function e(){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var i,r=0,n=!1;function o(){var e=performance.now();r+=e-t,t=e,i=requestAnimationFrame(o)}this.start=function(){t||(t=performance.now(),i=requestAnimationFrame(o))},this.stop=function(){cancelAnimationFrame(i),t=null,r=0},this.pause=function(){if(!n&&t){cancelAnimationFrame(i);var e=performance.now();r+=e-t,n=!0}},this.resume=function(){n&&t&&(t=performance.now(),i=requestAnimationFrame(o),n=!1)},this.getElapsedTime=function(){return r}}));function va(e){return void 0===e}function ya(e){return ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ya(e)}function ma(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,ga(r.key),r)}}function ga(e){var t=function(e,t){if("object"!=ya(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=ya(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ya(t)?t:t+""}var _a=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(0,j.mixin)(this),this.store=t,this.userAgent=this.store.get("wurfl")},(t=[{key:"isAutoplaySupported",value:function(){var e=this._isAutoplaySupportedByOS();this._emitDetectionResult(e)}},{key:"_isAutoplaySupportedByOS",value:function(){return this.userAgent.os.name===ge?this._isAutoplaySupportedAndroid():this.userAgent.os.name===_e?this._isAutoplaySupportedFireOS():this.userAgent.os.name===me&&this._isAutoplaySupportedIOS()}},{key:"_isAutoplaySupportedIOS",value:function(){if(this.userAgent.os.version<10)return!1;var e=this._isAutoplaySupportedOnBrowser(Te[me]);return!!va(e)||e}},{key:"_isAutoplaySupportedOnBrowser",value:function(e){if(e.hasOwnProperty(this.userAgent.browser.name))return va(e[this.userAgent.browser.name])||this.userAgent.browser.version>=e[this.userAgent.browser.name]}},{key:"_isAutoplaySupportedAndroid",value:function(){var e=this._isAutoplaySupportedOnBrowser(Te[ge]);return!va(e)&&e}},{key:"_isAutoplaySupportedFireOS",value:function(){var e=this._isAutoplaySupportedOnBrowser(Te[_e]);return!va(e)&&e}},{key:"_emitDetectionResult",value:function(e){this.emit("detectIsAutoplaySupported",e)}}])&&ma(e.prototype,t),i&&ma(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function ba(e){return ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ba(e)}function Aa(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Ea(r.key),r)}}function Ea(e){var t=function(e,t){if("object"!=ba(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=ba(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ba(t)?t:t+""}var Ta=function(){return e=function e(t){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.video=document.createElement("video"),this.store=t,this.isMobile=this.store.get("isMobile"),this.userAgent=this.store.get("wurfl"),this._addVideoTagMethods(),this._addVideoTagProperties(),this._addVideoTagAttributes(),this.video},(t=[{key:"_addVideoTagMethods",value:function(){this._addClearVideoSourcesMethod(),this._addAppendSourceMethod(),this._addAppendVideoSourcesMethod(),this._addProtectVideoPauseMethod(),this._addGetSrcMethod(),this._addHookMutedPropertyMethod(),this._addSupressErrorEventsMethod(),this._addDispatchEventMethod()}},{key:"_addClearVideoSourcesMethod",value:function(){this.video.clearVideoSources=function(){for(;this.childNodes.length;)this.removeChild(this.childNodes[0])}}},{key:"_addAppendSourceMethod",value:function(){this.video.appendSource=function(e,t){var i=document.createElement("source");i.src=e,i.setAttribute("type",t),this.appendChild(i),this.relevantSources++}}},{key:"_addAppendVideoSourcesMethod",value:function(){var e=this;this.video.appendVideoSources=function(t){var i=null;e.video.clearVideoSources();for(var r=0;r<t.length;r++){var n=t[r],o=n.url;e.video.canPlayType(n.originalType)&&(e.store.get("dcdvdurl")&&(o=decodeURI(o)),e.store.get("scrmf")&&"https:"===window.location.protocol&&(o=o.replace("http:","https:")),i||((i=n).mediaUrl=o),e.video.appendSource(o,n.originalType))}return i}}},{key:"_addProtectVideoPauseMethod",value:function(){this.video.protectPause=function(){this._play=this.play,this.play=function(){this.resumeInvoked&&this._play()}}}},{key:"_addGetSrcMethod",value:function(){this.video.getSrc=function(){return this.src||this.currentSrc||""}}},{key:"_addHookMutedPropertyMethod",value:function(){this.isMobile&&(this.video.hookMutedProperty=function(){this.__defineSetter__("_muted",this.__lookupSetter__("muted")),this.__defineSetter__("muted",(function(e){if(this.mutedChangeByUserGesture)return this._muted=e,void this.__defineSetter__("muted",this.__lookupSetter__("_muted"));this._muted=!0}))})}},{key:"_addSupressErrorEventsMethod",value:function(){this.video.supressErrorEvents=function(){this.__addEventListener=this.addEventListener,this.addEventListener=function(e,t){"error"!==e&&this.__addEventListener(e,t)}}}},{key:"_addDispatchEventMethod",value:function(){this.video._dispatchEvent=function(e,t){var i=document.createEvent("Event");i.initEvent(e,!0,!0),i.data=t||{},this.dispatchEvent(i)}}},{key:"_addVideoTagProperties",value:function(){this._addProgressPrecentageProperty(),this._addRemainingTimeProperty(),this._addRelevantSourcesProperty(),this._addBufferSizeProperty(),this._addResumeInvokedProperty(),this._addMutedChangeByUserGestureProperty(),this._hookSrcProperty()}},{key:"_addProgressPrecentageProperty",value:function(){Object.defineProperty(this.video,"progressPrecentage",{get:function(){return this.currentTime/this.duration}})}},{key:"_addRemainingTimeProperty",value:function(){Object.defineProperty(this.video,"remainingTime",{get:function(){return this.duration-this.currentTime}})}},{key:"_addRelevantSourcesProperty",value:function(){Object.defineProperty(this.video,"relevantSources",{get:function(){return this._relevantSources||0},set:function(e){this._relevantSources=e}})}},{key:"_addBufferSizeProperty",value:function(){Object.defineProperty(this.video,"bufferSize",{get:function(){if(this.buffered)return 0===this.buffered.length||0!==this.buffered.start(0)?0:this.buffered.end(0)-this.buffered.start(0)}})}},{key:"_addResumeInvokedProperty",value:function(){Object.defineProperty(this.video,"resumeInvoked",{get:function(){return this._resumeInvoked||!1},set:function(e){this._resumeInvoked=e}})}},{key:"_addMutedChangeByUserGestureProperty",value:function(){this.isMobile&&Object.defineProperty(this.video,"mutedChangeByUserGesture",{get:function(){return this._mutedChangeByUserGesture||!1},set:function(e){this._mutedChangeByUserGesture=e}})}},{key:"_hookSrcProperty",value:function(){var e=this;!function(e,t,i,r){var n="alt_"+t;if(!e.hasOwnProperty(n)){e[n]="";try{Object.defineProperty(e,t,{get:function(){return i?i():this[n]},set:function(i){this[n]=i,r&&r(i)&&e.setAttribute(t,i)}})}catch(e){}}}(this.video,"src",null,(function(t){return!(""==t&&!e.video.removeSrc)}))}},{key:"_addVideoTagAttributes",value:function(){this.isMobile&&(this.video.muted=!0,this.video.setAttribute("muted",""),this.video.setAttribute("playsinline",""),this.userAgent.os.name===me&&(this.store.get("atplyhk")?(this.video.setAttribute("autoPlay",""),this.video.setAttribute("autoplay",""),this.video.setAttribute("webkit-playsinline",""),this.video.style.willChange="transform",this.video.volume=0):this.video.removeAttribute("autoplay","")))}}])&&Aa(e.prototype,t),i&&Aa(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function ka(e){return ka="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ka(e)}function wa(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Sa(r.key),r)}}function Sa(e){var t=function(e,t){if("object"!=ka(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=ka(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ka(t)?t:t+""}var Pa=function(){return e=function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Hn,r=arguments.length>2?arguments[2]:void 0;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t,this.videoState=i,this.adElasticLogger=r,this.isMobile=this.store.get("isMobile"),this.video=new Ta(this.store),this._overrideVideoAddEventListener(),this._initVideoMobileParams(),this._addVideoElementProperties(),this._addVideoElementMethods(),this._addTimeupdateEvents(),this._loopThroughMediaSources(),this.video.videoState=this.videoState,this.video},t=[{key:"_initVideoMobileParams",value:function(){this._shouldDetectAutoplay()&&this._detectAutoplay()}},{key:"_shouldDetectAutoplay",value:function(){return this.isMobile}},{key:"_detectAutoplay",value:function(){var e=new _a(this.store);e.on("detectIsAutoplaySupported",this._onIsAutoplaySupportedDetected.bind(this)),e.isAutoplaySupported()}},{key:"_onIsAutoplaySupportedDetected",value:function(e){this.adElasticLogger&&this.adElasticLogger.logVideoElementEvent(e)}},{key:"_overrideVideoAddEventListener",value:function(){this.eventsCb={};var e=this;this.video._addEventListener=this.video.addEventListener,this.video.addEventListener=function(t,i,r){e._addEventCb(t,i),this._addEventListener(t,i,r)}}},{key:"_addEventCb",value:function(e,t){this.eventsCb[e]=this.eventsCb[e]||[],this.eventsCb[e].push(t)}},{key:"_addVideoElementProperties",value:function(){this._addVideoStateProperty(),this._addBufferingProperty()}},{key:"_addVideoStateProperty",value:function(){Object.defineProperty(this.video,"videoState",{get:function(){return this._videoState||Hn},set:function(e){this._videoState=e}})}},{key:"_addBufferingProperty",value:function(){if(this.isMobile){var e=this.video.buffering||!1;Object.defineProperty(this.video,"buffering",{get:function(){return this._buffering||e},set:function(e){this._buffering=e}})}}},{key:"_addVideoElementMethods",value:function(){this._addRegisterProgressEventsMethod(),this._addDestroyMethod()}},{key:"_addRegisterProgressEventsMethod",value:function(){var e=this;this.video.registerProgressEvents=function(t){e._progressEvents={};for(var i=0;i<t.length;i++){var r="precentage"===t[i].offsetType?t[i].offset:t[i].offset/e.video.duration;e._progressEvents[r]={offset:r,fired:!1}}}}},{key:"_addDestroyMethod",value:function(){var e=this;this.video.destroy=function(){e.video.pause(),e.video.clearVideoSources(),e._cleanVideoSrcProp()}}},{key:"_cleanVideoSrcProp",value:function(){this.video.removeSrc=!0,this.video.src=""}},{key:"_addTimeupdateEvents",value:function(){this.quartiles={q1:!1,q2:!1,q3:!1};var e=this,t=function(){if(!this._buffering){this.progressPrecentage>=.75&&!e.quartiles.q3?(e.quartiles.q3=!0,this._dispatchEvent("thirdQuartile")):this.progressPrecentage>=.5&&!e.quartiles.q2?(e.quartiles.q2=!0,this._dispatchEvent("midpoint")):this.progressPrecentage>=.25&&!e.quartiles.q1&&(e.quartiles.q1=!0,this._dispatchEvent("firstQuartile"));var i=!0;for(var r in e._progressEvents)e._progressEvents[r].fired||(e._progressEvents[r].offset<=this.progressPrecentage?(e._progressEvents[r].fired=!0,this._dispatchEvent("timeProgress",{pre:this.progressPrecentage,time:this.currentTime})):i=!1);i&&e.quartiles.q3&&!e._ticker&&this.removeEventListener("timeupdate",t,!0)}};this.video.addEventListener("timeupdate",t)}},{key:"_loopThroughMediaSources",value:function(){var e=this;this.video.addEventListener("ended",(function(){if(e._isPlayingContent()&&e.video.childNodes.length>1){var t=e.video.removeChild(e.childNodes[0]);e.video.appendChild(t),e.video.load(),e.video.play()}}))}},{key:"_isPlayingContent",value:function(){return this.video.videoState===Hn}}],t&&wa(e.prototype,t),i&&wa(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function Ia(e){return Ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ia(e)}function Oa(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return Da(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Da(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function Da(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function Ca(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Va(r.key),r)}}function Va(e){var t=function(e,t){if("object"!=Ia(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Ia(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ia(t)?t:t+""}var Ra="_cm-ad",La="multi-vpaids",Ma="_cm-video-ad",xa="cm-ad-click-target",Fa="cm-ad-player",Na="cm-ad-player-active",Ba={WRAPPER:"_cm-ad-choices-player",ANCHOR:"_cm-ad-choices-player-anchor"},Ua="ie-black-edges",Wa="vertical-video",ja="next-up-fit",Ha="_cm-css-reset",Ga="vpaid-player-container",qa="13px",za="16px",Qa=["right","left"],Ka=["top","botton"],Ya=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t.store,this.tag=t.tag,this.target=t.target,this.index=t.index,this.adElasticLogger=t.adElasticLogger,this.demandTypeSettings=t.demandTypeSettings,this.stopped=!1,this.isMobile=this.store.get("isMobile")||!1,this.isMultiAdsActive=this.store.get("mltads"),this.isMultiVpaidUnit=this.store.get("isMultiVpaidUnit"),this.shouldMuteVideo=this.store.get("dskVidMuted")&&!this.isMobile,this.fireIconViewTracking=function(){},this._render()},(t=[{key:"_render",value:function(){this._createPlacementWrapper(),this._createPlacement()}},{key:"_createPlacementWrapper",value:function(){(this.isMultiVpaidUnit||this.isMultiAdsActive)&&(this.placementWrapper=document.createElement("div"),this.placementWrapper.className=Ra,this.placementWrapper.id=Ha)}},{key:"_createPlacement",value:function(){this.placement=document.createElement("div"),this._stylePlacement(),this._customizePlacement(),this._customizeParentElement(),this._customizeBySelector(),this._appendToDOM()}},{key:"_appendToDOM",value:function(){this.placementWrapper?((0,m.vy)(this.placement,La),this.placementWrapper.appendChild(this.placement),this.target.appendChild(this.placementWrapper)):this.target.appendChild(this.placement)}},{key:"_stylePlacement",value:function(){this.placement.style.cssText=this.target.style.cssText,this.placement.className="".concat(this.target.className||""," ").concat(this.index),this.placement.id=Ga;var e=this.tag.getValueByKey("adtnlclsnm");e&&(0,m.iQ)(this.placement,e),this.placement.style.cssText+="position: absolute; overflow: hidden; top: 0; height: 0; left :0;",this.isMultiAdsActive&&(0,m.iQ)(this.placement,Ma)}},{key:"_customizePlacement",value:function(){var e=this.store.get("adtrgtcss")&&this.tag.getValueByKey("trgtcss");if(e)for(var t in e)this.placement.style[t]=e[t]}},{key:"_customizeParentElement",value:function(){var e=this.store.get("vpdcntrcstmcss");e&&((this.placementWrapper||this.placement).style.cssText+=e)}},{key:"_customizeBySelector",value:function(){var e=this.tag.getValueByKey("vpdcss");if(e)for(var t in e){var i=void 0;if(i=this.placement.className.indexOf(t)>-1?this.placement:this.placement.querySelectorAll(t)[0])for(var r in e[t])i.style[r]=e[t][r]}}},{key:"createClickArea",value:function(){this.stopped||this.isMobile&&this.store.get("wurfl.os.name")===me&&(this.clickArea=document.createElement("div"),this._styleClickArea(),this.placement.appendChild(this.clickArea))}},{key:"_styleClickArea",value:function(){var e=this.store.get("width"),t=this.store.get("height");this.clickArea.className=xa,this.clickArea.style.cssText="width: ".concat(this._intToPixels(e),"; height: ").concat(this._intToPixels(t),"; cursor: pointer; position: absolute; top: 0px; left: 0px;"),this.clickArea.style.display="",this._resizeElement(this.clickArea,e,t)}},{key:"destroy",value:function(){this.stopped=!0,this._clearIframeContent(),this._removeElements(),this.store=this.tag=this.target=this.adElasticLogger=this.placement=this.placementWrapper=this.clickArea=this.videoTag=void 0}},{key:"_removeElements",value:function(){var e;this.placement.parentNode.removeChild(this.placement),null===(e=this.placementWrapper)||void 0===e||null===(e=e.parentNode)||void 0===e||e.removeChild(this.placementWrapper),this.removeClickArea()}},{key:"createVideoTag",value:function(e){this.stopped||(this.videoTag=new Pa(this.store,jn,this.adElasticLogger),this._handleVideoInitialVolume(),this._styleVideoTag(e),this.store.get("addprld")&&this.videoTag.setAttribute("preload","auto"),this.placement.appendChild(this.videoTag))}},{key:"_handleVideoInitialVolume",value:function(){this.videoTag.volume=0,this.shouldMuteVideo&&(this.videoTag.muted=!0)}},{key:"_styleVideoTag",value:function(e){var t=this.store.get("width"),i=this.store.get("height");this.videoTag.className=Fa,this.videoTag.style.cssText="width: ".concat(this._intToPixels(t),"; height: ").concat(this._intToPixels(i),";"),this.videoTag.style.display="",this._handleVideoStretching(),this._resizeElement(this.videoTag,t,i),e.videoSlotControls&&this.videoTag.removeAttribute("controls")}},{key:"_handleVideoStretching",value:function(){!1===this._shouldStretchVideo()?this.videoTag.style.objectFit="contain":this.store.get("wurfl.browser.name")===Ee&&(0,m.iQ)(this.videoTag,Ua)}},{key:"_shouldStretchVideo",value:function(){var e;return(0,m.hX)(null===(e=this.demandTypeSettings)||void 0===e?void 0:e.strch)?this.tag.getValueByKey("strch"):this.demandTypeSettings.strch}},{key:"isVideoHover",value:function(){return this.placement.querySelector(":hover")==this.videoTag}},{key:"getIframesFromPlacement",value:function(){return this.placement.getElementsByTagName("iframe")}},{key:"_clearIframeContent",value:function(){var e=this.getIframesFromPlacement();if(e&&0!==e.length){var t=e[0],i=this.store.get("debug");(0,m.vn)(t,"iframe",(function(e){e.forEach((function(e){e.parentNode.removeChild(e)}))}),"*",i),t&&t.parentNode.removeChild(t)}}},{key:"bringToFront",value:function(e){this.placement.style.display="block",this.placement.style.height="".concat(this._intToPixels(this.store.get("height")));var t=e+99;return this.placement.style.zIndex=t,this.clickArea&&(this.clickArea.style.zIndex=t),t}},{key:"moveToBack",value:function(){this.stopped||(this.placement.style.zIndex=0,this.clickArea&&(this.clickArea.style.zIndex=0))}},{key:"resize",value:function(e,t){this.resizePlacement(e,t),this._resizeClickArea(e,t)}},{key:"resizePlacement",value:function(e,t){this.stopped||(this._resizeElement(this.placement,e,t),this._resizeElement(this.videoTag,e,t))}},{key:"_intToPixels",value:function(e){return"".concat(e,"px")}},{key:"_resizeClickArea",value:function(e,t){!this.stopped&&this.clickArea&&this._resizeElement(this.clickArea,e,t)}},{key:"_resizeElement",value:function(e,t,i){e.style.width=this._intToPixels(t),e.style.height=this._intToPixels(i),e.setAttribute("width",t),e.setAttribute("height",i)}},{key:"removeClickArea",value:function(){this.clickArea&&this.clickArea.parentNode.removeChild(this.clickArea)}},{key:"handleVerticalVideo",value:function(e,t,i){!this.stopped&&this.isVerticalVideo(e,t,i)&&((0,m.iQ)(this.videoTag,Wa),(0,m.vy)(this.videoTag,Ua))}},{key:"handleNextUpFit",value:function(e,t){this.store.get("isNextUp")&&!this._isVideoFitInContainer(e,t)&&((0,m.iQ)(this.videoTag,ja),(0,m.vy)(this.videoTag,Ua))}},{key:"isVerticalVideo",value:function(e,t,i){return!!this.tag.getValueByKey("spprtvrtclvd")&&(t>e||(i&&i.indexOf(":")>-1?(i=i.split(":"),parseInt(i[1])>parseInt(i[0])):!(!this.videoTag.videoWidth||!this.videoTag.videoHeight)&&this.videoTag.videoHeight>this.videoTag.videoWidth))}},{key:"_isVideoFitInContainer",value:function(e,t){if(!this.videoTag.videoWidth&&!this.videoTag.videoHeight)return!0;var i=this.videoTag.videoWidth/this.videoTag.videoHeight;if(i>e/t){if(t*i>e)return!1}else if(e/i>t)return!1;return!0}},{key:"handleSquareVideo",value:function(){!this.stopped&&this._isSquareVideo()&&(this.videoTag.style.objectFit="contain")}},{key:"_isSquareVideo",value:function(){return!(!this.videoTag.videoWidth||!this.videoTag.videoHeight)&&this.videoTag.videoWidth===this.videoTag.videoHeight}},{key:"activateVideoTag",value:function(){this.stopped||(0,m.iQ)(this.videoTag,Na)}},{key:"getVideoBuffered",value:function(){var e=this.videoTag.buffered;return e&&0!==e.length?e.end(0):0}},{key:"getVideoSource",value:function(){return this.videoTag&&this.videoTag.getSrc&&this.videoTag.getSrc()}},{key:"getVideoDuration",value:function(){var e,t=null===(e=this.videoTag)||void 0===e?void 0:e.duration;return t?parseInt(t):void 0}},{key:"handleVastIcons",value:function(e){this.tag.getValueByKey("fkadchcs")||0===e.length||this._appendAdChoiceIcons(e)}},{key:"_appendAdChoiceIcons",value:function(e){var t,i=[],r=Oa(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.attributes.program&&-1===i.indexOf(n.attributes.program)){i.push(n.attributes.program);var o=this._createAdChoiceIcon(n),a=this._createAdChoiceAnchor(n);n.iconViewTracking.length&&(this.fireIconViewTracking=this._fireIconViewTracking.bind(this,n)),o.appendChild(a),this.placement.appendChild(o)}}}catch(e){r.e(e)}finally{r.f()}}},{key:"_createAdChoiceIcon",value:function(e){var t=document.createElement("div");return t.className=Ba.WRAPPER,e.attributes.xposition&&(t.style.left="initial",t.style[this._isValidPosition(Qa,e.attributes.xposition)?e.attributes.xposition:Qa[0]]=qa),e.attributes.yposition&&(t.style.top="initial",t.style[this._isValidPosition(Ka,e.attributes.yposition)?e.attributes.yposition:Ka[0]]=za),t.onclick=this._onIconClick.bind(this,e),t}},{key:"_isValidPosition",value:function(e,t){return e.indexOf(t)>-1}},{key:"_createAdChoiceAnchor",value:function(e){var t=document.createElement("a");return e.clickThroughUrl&&(t.href=e.clickThroughUrl),t.target="_blank",t.className=Ba.ANCHOR,t.style.width=e.attributes.width,t.style.height=e.attributes.height,e.staticresource?t.style.background="#fff url(".concat(e.staticresource,") no-repeat center center"):e.htmlresource&&(t.innerHTML+=e.htmlresource),t}},{key:"_onIconClick",value:function(e){var t,i=Oa(e.clickTracking);try{for(i.s();!(t=i.n()).done;){var r=t.value;(0,m._x)(r.trim())}}catch(e){i.e(e)}finally{i.f()}}},{key:"_fireIconViewTracking",value:function(e){var t,i=Oa(e.iconViewTracking);try{for(i.s();!(t=i.n()).done;){var r=t.value;(0,m._x)(r.trim())}}catch(e){i.e(e)}finally{i.f()}this.fireIconViewTracking=function(){}}},{key:"setVolume",value:function(e){this.shouldMuteVideo||(this.videoTag.volume=e,this.videoTag.muted=0===e)}},{key:"logActualVideoSize",value:function(){this.adElasticLogger.logActualVideoSize(this.videoTag.videoWidth,this.videoTag.videoHeight)}},{key:"placement",get:function(){return this._placement},set:function(e){this._placement=e}},{key:"videoTag",get:function(){return this._videoTag},set:function(e){this._videoTag=e}},{key:"clickArea",get:function(){return this._clickArea},set:function(e){this._clickArea=e}},{key:"placementWrapper",get:function(){return this._placementWrapper},set:function(e){this._placementWrapper=e}}])&&Ca(e.prototype,t),i&&Ca(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function Xa(e){return Xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xa(e)}function Ja(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,o,a,s=[],l=!0,d=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(r=o.call(i)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){d=!0,n=e}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(d)throw n}}return s}}(e,t)||$a(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Za(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=$a(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function $a(e,t){if(e){if("string"==typeof e)return es(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?es(e,t):void 0}}function es(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function ts(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,is(r.key),r)}}function is(e){var t=function(e,t){if("object"!=Xa(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Xa(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Xa(t)?t:t+""}var rs=function(){},ns=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.timers={},this.intervals={},this.vpaidEvents={}},t=[{key:"setTimer",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rs;e&&t&&(this.timers[e]={timer:setTimeout(i,(0,m.q1)(t)),callback:i,duration:t,startTime:this._getCurrentTime()})}},{key:"hasTimer",value:function(e){return this.timers.hasOwnProperty(e)}},{key:"pauseTimer",value:function(e){var t=this.timers[e];t&&t.timer&&(t.timer=clearTimeout(t.timer),t.duration=(0,m.q1)(t.duration-(this._getCurrentTime()-t.startTime)))}},{key:"resumeTimer",value:function(e){var t=this.timers[e];t&&!t.timer&&(t.timer=setTimeout(t.callback,t.duration),t.startTime=this._getCurrentTime())}},{key:"clearTimer",value:function(e){this.hasTimer(e)&&(this.timers[e].timer=clearTimeout(this.timers[e].timer),delete this.timers[e])}},{key:"setInterval",value:function(e){function t(t,i){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rs;e&&t&&(this.intervals[e]=setInterval(i,(0,m.q1)(t)))}))},{key:"hasInterval",value:function(e){return this.intervals.hasOwnProperty(e)}},{key:"clearInterval",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){this.hasInterval(e)&&(this.intervals[e]=clearInterval(this.intervals[e]),delete this.intervals[e])}))},{key:"_getCurrentTime",value:function(){return(new Date).getTime()}},{key:"waitForVPAIDEvent",value:function(e,t){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:rs;e&&(t>0&&(i=setTimeout(arguments.length>3&&void 0!==arguments[3]?arguments[3]:rs,(0,m.q1)(t))),this.vpaidEvents[e]=this.vpaidEvents[e]||[],this.vpaidEvents[e].push({callback:r,timeout:i}))}},{key:"onVPAIDEvent",value:function(e){var t=this.vpaidEvents[e];if(t){var i,r=Za(t);try{for(r.s();!(i=r.n()).done;){var n=i.value;n.timeout&&(n.timeout=clearTimeout(n.timeout)),n.callback()}}catch(e){r.e(e)}finally{r.f()}delete this.vpaidEvents[e]}}},{key:"clearVPAIDEvent",value:function(e){var t=this.vpaidEvents[e];if(t){var i,r=Za(t);try{for(r.s();!(i=r.n()).done;){var n=i.value;n.timeout=clearTimeout(n.timeout)}}catch(e){r.e(e)}finally{r.f()}delete this.vpaidEvents[e]}}},{key:"destroy",value:function(){for(var e=0,t=Object.entries(this.timers);e<t.length;e++){var i=Ja(t[e],1)[0];this.clearTimer(i)}for(var r=0,n=Object.entries(this.intervals);r<n.length;r++){var o=Ja(n[r],1)[0];this.clearInterval(o)}for(var a=0,s=Object.entries(this.vpaidEvents);a<s.length;a++){var l=Ja(s[a],1)[0];this.clearVPAIDEvent(l)}this.timers=this.intervals=this.vpaidEvents=void 0}}],t&&ts(e.prototype,t),i&&ts(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function os(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,o,a,s=[],l=!0,d=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(r=o.call(i)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){d=!0,n=e}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(d)throw n}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return as(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?as(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function as(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}var ss="tbvol",ls=function(e,t){e&&e.sv||(e.sv=!0,e.addEventListener("volumechange",(function(){e.volume!==parseFloat(this.getAttribute(ss))?e.volume=0:e.volume=t})))},ds=function(e){if(e)return Object.entries(e).reduce((function(e,t){var i=os(t,2),r=i[0],n=i[1];return(0,m.hX)(n)||(e[r]=n),e}),{})},us=n(9312);function cs(e){return cs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cs(e)}function hs(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function ps(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=cs(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=cs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==cs(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var fs=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.bidderRequest,i=e.itemsToParse;if(i&&t){var r=function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?hs(Object(i),!0).forEach((function(t){ps(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):hs(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},t);return Object.values(i).forEach((function(e){var i=e.parser(t);e.setter(i,r)})),(0,m.p4)(t,r)}};function vs(e){return vs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vs(e)}function ys(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,o,a,s=[],l=!0,d=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(r=o.call(i)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){d=!0,n=e}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(d)throw n}}return s}}(e,t)||gs(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ms(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=gs(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function gs(e,t){if(e){if("string"==typeof e)return _s(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?_s(e,t):void 0}}function _s(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function bs(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function As(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?bs(Object(i),!0).forEach((function(t){Es(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):bs(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function Es(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=vs(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=vs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==vs(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var Ts=function(e){return{code:{setter:function(e,t){t.code=e},parser:function(){return Ds(e)}},"ortb2Imp.ext.gpid":{setter:function(e,t){t.ortb2Imp.ext.gpid=e},parser:function(){return Ds(e)}},"renderer.render":{setter:function(e,t){t.renderer.render=e},parser:function(){return function(){}}}}},ks=function(e,t){var i,r={"mediaTypes.video.playerSize":{setter:function(e,t){t.mediaTypes.video.playerSize=e},parser:function(e){return Vs(e.mediaTypes.video.playerSize)}}};return(0,m.hX)(e.sizes)||(r.sizes={setter:function(e,t){t.sizes=e},parser:function(e){return Vs(e.sizes)}}),(0,m.hX)(null===(i=t.params)||void 0===i?void 0:i.sizes)||(r["params.sizes"]={setter:function(e,t){t.bids[0].params.sizes=e},parser:function(e){return Vs(e.bids[0].params.sizes)}}),r},ws=function(e){var t,i,r,n,o={};return(0,m.hX)(null===(t=e.params)||void 0===t?void 0:t.customFloor)||(o["params.customFloor"]={setter:function(e,t){t.bids[0].params.customFloor=e},parser:function(e){return parseFloat(e.bids[0].params.customFloor)}}),(0,m.hX)(null===(i=e.params)||void 0===i?void 0:i.bidfloor)&&(0,m.hX)(e.floor)||(o["params.bidfloor"]={setter:function(e,t){t.bids[0].params.bidfloor=e},parser:function(e){return e.bids[0].params.bidfloor||e.bids[0].floor}}),(0,m.hX)(null===(r=e.params)||void 0===r||null===(r=r.video)||void 0===r?void 0:r.bidfloor)||(o["params.video.bidfloor"]={setter:function(e,t){t.bids[0].params.video.bidfloor=e},parser:function(e){return parseFloat(e.bids[0].params.video.bidfloor)}}),(0,m.hX)(null===(n=e.params)||void 0===n?void 0:n.kadfloor)||(o["params.kadfloor"]={setter:function(e,t){t.bids[0].params.kadfloor=e},parser:function(e){return Cs(e.bids[0].params.kadfloor)}}),o},Ss=function(e){var t=0;if(e.getFloorField.indexOf("|")>-1){var i=e.getFloorField.split("|");t=Ps(e,i[0])||Ps(e,i[1])}else t=Ps(e,e.getFloorField);var r={val:t};return e.getFloorField.indexOf("kadfloor")>-1&&(r.parser=function(e){return e.toString()}),{getFloor:{setter:function(e,t){delete t.bids[0].getFloorField,t.bids[0].getFloor=e},parser:function(){return Os(r)}}}},Ps=function(e,t){return t.indexOf("params")<0?e[t]:t.indexOf("params.video")<0?e.params[t.split(".")[1]]:e.params.video[t.split(".")[2]]},Is=function(e,t){var i,r,n,o,a,s,l,d={};return(0,m.hX)(null===(i=t.params)||void 0===i?void 0:i.userId)||(d["params.userId"]={setter:function(e,t){t.bids[0].params.userId=e},parser:function(e){return e.user.buyeruid}}),(0,m.hX)(null===(r=t.params)||void 0===r?void 0:r.latLong)||(d["params.latLong"]={setter:function(e,t){t.bids[0].params.latLong=e},parser:function(e){return[parseFloat(e.bids[0].params.latLong[0]),parseFloat(e.bids[0].params.latLong[1])]}}),(0,m.hX)(null===(n=t.params)||void 0===n?void 0:n.lat)||(0,m.hX)(null===(o=t.params)||void 0===o?void 0:o.lon)||(d["params.lat|lon"]={setter:function(e,t){t.bids[0].params.lat=e.lat,t.bids[0].params.lon=e.lon},parser:function(e){return{lat:Cs(e.bids[0].params.lat),lon:Cs(e.bids[0].params.lon)}}}),t.copyVideoObj&&!(0,m.hX)(null===(a=e.mediaTypes)||void 0===a?void 0:a.video)&&(delete t.copyVideoObj,d["params.video"]={setter:function(e,t){t.bids[0].params.video=e},parser:function(e){return e.mediaTypes.video}}),(0,m.hX)(null===(s=e.mediaTypes)||void 0===s||null===(s=s.video)||void 0===s?void 0:s.w)||(0,m.hX)(null===(l=e.mediaTypes)||void 0===l||null===(l=l.video)||void 0===l?void 0:l.h)||(d["params.cf"]={setter:function(e,t){t.bids[0].params.cf=e},parser:function(e){return"".concat(e.mediaTypes.video.w,"x").concat(e.mediaTypes.video.h)}}),d},Os=function(e){var t=e.val,i=e.parser,r=void 0===i?parseFloat:i;return function(){return{floor:r(t),currency:us.yR.USD}}},Ds=function(e){return"ad_unit_".concat(e.id)},Cs=function(e){return e.toString()},Vs=function(e){var t=[];if(Array.isArray(e[0])){var i,r=ms(e);try{for(r.s();!(i=r.n()).done;){var n=i.value;n[0]=parseInt(n[0]),n[1]=parseInt(n[1])}}catch(e){r.e(e)}finally{r.f()}return e}var o,a=ms(e.entries());try{for(a.s();!(o=a.n()).done;){var s=ys(o.value,2),l=s[0],d=s[1];t[l]=parseInt(d)}}catch(e){a.e(e)}finally{a.f()}return t};const Rs=1,Ls=2,Ms=200,xs=203,Fs=204,Ns=210;var Bs,Us="adto",Ws="autoKill",js="adloadedTimeout",Hs="adImpressionTimeout",Gs={POST_REPEAT:"post_repeat",GLOBAL_AD_TIMEOUT:"global_ad_timeout",UNDEFINED_IFRAME_SRC:"undefinedIframeSrc",NEXTUP_CLOSED_BY_USER:"nextup_closed_by_user",AD_REPLACED:"ad_replaced",MP4_AD_ERROR:["Mp4AdError"],AD_ERROR:["AdError"],AUTO_KILL:[Ws],HANDLER_CREATING_FAIL:"handlerCreatingFail",NO_MEDIA_FILE_AFTER_SORT:"NoMediaFileAfterSort",NETWORK_CALLS_LIMIT_EXCEEDED:"networkCallsLimitExceeded",AD_UNIT_LOAD_FAILED_ERROR:[V.MH.AD_UNIT_LOAD_FAILED],HIJACK_ATTEMPT:[V.MH.HIJACK_ATTEMPT],AD_LOADED_TIMEOUT:[js],AD_IMPRESSION_TIMEOUT:[Hs],AD_UNIT_LOAD_FAILED:[V.MH.AD_UNIT_LOAD_FAILED],AD_TIMEOUT:[V.MH.AD_TIMEOUT],MAX_WRAPPERS:[V.MH.MAX_WRAPPERS],VAST_FETCH_FAIL:[sa.VAST_FETCH_FAIL],PARSING_FAILED:[sa.PARSING_FAILED],EMPTY_VAST:[sa.EMPTY_VAST],FILTER_BY_REGEX:[sa.FILTER_BY_REGEX],BLOCKED_FOR_HEAVY_ADS:[sa.BLOCKED_FOR_HEAVY_ADS],MISSING_WRAPPER_URL:[sa.MISSING_WRAPPER_URL],MISSING_MEDIA_FILES:[sa.MISSING_MEDIA_FILES],NO_MEDIA_FILES_AFTER_SORT:[sa.NO_MEDIA_FILES_AFTER_SORT],BLOCKED_VERTICAL_DEMAND:[V.MH.BLOCKED_VERTICAL_DEMAND]};function qs(e){return qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},qs(e)}function zs(e,t,i){return(t=function(e){var t=function(e,t){if("object"!=qs(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=qs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==qs(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var Qs=(zs(zs(zs(zs(zs(zs(zs(zs(zs(zs(Bs={},Gs.AD_UNIT_LOAD_FAILED,Rs),Gs.VAST_FETCH_FAIL,Fs),Gs.PARSING_FAILED,Fs),Gs.EMPTY_VAST,Fs),Gs.MP4_AD_ERROR,Rs),Gs.AD_ERROR,Rs),Gs.HIJACK_ATTEMPT,Ms),Gs.NETWORK_CALLS_LIMIT_EXCEEDED,Ms),Gs.AD_TIMEOUT,Ls),Gs.GLOBAL_AD_TIMEOUT,Ls),zs(zs(zs(zs(zs(zs(zs(zs(zs(zs(Bs,Gs.AUTO_KILL,Ls),Gs.AD_LOADED_TIMEOUT,Ls),Gs.AD_IMPRESSION_TIMEOUT,Ls),Gs.FILTER_BY_REGEX,Fs),Gs.HANDLER_CREATING_FAIL,Rs),Gs.BLOCKED_FOR_HEAVY_ADS,xs),Gs.MAX_WRAPPERS,xs),Gs.MISSING_WRAPPER_URL,Ns),Gs.MISSING_MEDIA_FILES,Ns),Gs.NO_MEDIA_FILES_AFTER_SORT,Ns),zs(Bs,Gs.UNDEFINED_IFRAME_SRC,Rs));function Ks(e){return Ks="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ks(e)}function Ys(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,o,a,s=[],l=!0,d=!1;try{if(o=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(r=o.call(i)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){d=!0,n=e}finally{try{if(!l&&null!=i.return&&(a=i.return(),Object(a)!==a))return}finally{if(d)throw n}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Xs(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Xs(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Xs(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function Js(){Js=function(){return t};var e,t={},i=Object.prototype,r=i.hasOwnProperty,n=Object.defineProperty||function(e,t,i){e[t]=i.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function d(e,t,i){return Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,i){return e[t]=i}}function u(e,t,i,r){var o=t&&t.prototype instanceof m?t:m,a=Object.create(o.prototype),s=new D(r||[]);return n(a,"_invoke",{value:S(e,i,s)}),a}function c(e,t,i){try{return{type:"normal",arg:e.call(t,i)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",p="suspendedYield",f="executing",v="completed",y={};function m(){}function g(){}function _(){}var b={};d(b,a,(function(){return this}));var A=Object.getPrototypeOf,E=A&&A(A(C([])));E&&E!==i&&r.call(E,a)&&(b=E);var T=_.prototype=m.prototype=Object.create(b);function k(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(n,o,a,s){var l=c(e[n],e,o);if("throw"!==l.type){var d=l.arg,u=d.value;return u&&"object"==Ks(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):t.resolve(u).then((function(e){d.value=e,a(d)}),(function(e){return i("throw",e,a,s)}))}s(l.arg)}var o;n(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){i(e,r,t,n)}))}return o=o?o.then(n,n):n()}})}function S(t,i,r){var n=h;return function(o,a){if(n===f)throw Error("Generator is already running");if(n===v){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var l=P(s,r);if(l){if(l===y)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===h)throw n=v,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=f;var d=c(t,i,r);if("normal"===d.type){if(n=r.done?v:p,d.arg===y)continue;return{value:d.arg,done:r.done}}"throw"===d.type&&(n=v,r.method="throw",r.arg=d.arg)}}}function P(t,i){var r=i.method,n=t.iterator[r];if(n===e)return i.delegate=null,"throw"===r&&t.iterator.return&&(i.method="return",i.arg=e,P(t,i),"throw"===i.method)||"return"!==r&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+r+"' method")),y;var o=c(n,t.iterator,i.arg);if("throw"===o.type)return i.method="throw",i.arg=o.arg,i.delegate=null,y;var a=o.arg;return a?a.done?(i[t.resultName]=a.value,i.next=t.nextLoc,"return"!==i.method&&(i.method="next",i.arg=e),i.delegate=null,y):a:(i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,y)}function I(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(I,this),this.reset(!0)}function C(t){if(t||""===t){var i=t[a];if(i)return i.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function i(){for(;++n<t.length;)if(r.call(t,n))return i.value=t[n],i.done=!1,i;return i.value=e,i.done=!0,i};return o.next=o}}throw new TypeError(Ks(t)+" is not iterable")}return g.prototype=_,n(T,"constructor",{value:_,configurable:!0}),n(_,"constructor",{value:g,configurable:!0}),g.displayName=d(_,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,d(e,l,"GeneratorFunction")),e.prototype=Object.create(T),e},t.awrap=function(e){return{__await:e}},k(w.prototype),d(w.prototype,s,(function(){return this})),t.AsyncIterator=w,t.async=function(e,i,r,n,o){void 0===o&&(o=Promise);var a=new w(u(e,i,r,n),o);return t.isGeneratorFunction(i)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},k(T),d(T,l,"Generator"),d(T,a,(function(){return this})),d(T,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),i=[];for(var r in t)i.push(r);return i.reverse(),function e(){for(;i.length;){var r=i.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=C,D.prototype={constructor:D,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var i in this)"t"===i.charAt(0)&&r.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var i=this;function n(r,n){return s.type="throw",s.arg=t,i.next=r,n&&(i.method="next",i.arg=e),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var l=r.call(a,"catchLoc"),d=r.call(a,"finallyLoc");if(l&&d){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!d)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),y},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.finallyLoc===e)return this.complete(i.completion,i.afterLoc),O(i),y}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var i=this.tryEntries[t];if(i.tryLoc===e){var r=i.completion;if("throw"===r.type){var n=r.arg;O(i)}return n}}throw Error("illegal catch attempt")},delegateYield:function(t,i,r){return this.delegate={iterator:C(t),resultName:i,nextLoc:r},"next"===this.method&&(this.arg=e),y}},t}function Zs(e,t,i,r,n,o,a){try{var s=e[o](a),l=s.value}catch(e){return void i(e)}s.done?t(l):Promise.resolve(l).then(r,n)}function $s(e){return function(){var t=this,i=arguments;return new Promise((function(r,n){var o=e.apply(t,i);function a(e){Zs(o,r,n,a,s,"next",e)}function s(e){Zs(o,r,n,a,s,"throw",e)}a(void 0)}))}}function el(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,il(r.key),r)}}function tl(e,t,i){return(t=il(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function il(e){var t=function(e,t){if("object"!=Ks(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Ks(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ks(t)?t:t+""}var rl=0,nl=0,ol=function(){},al={UNTIL_AD_START:"untilAdStart",AUTO_KILL:"autoKill",GLOBAL_TIMEOUT:"globalTimeout",TB_COMPLETION:"tbCompletion",FORCE_AD_VOLUME:"forceAdVolume"},sl=0,ll=1,dl=2,ul=3,cl=4,hl=5,pl=6,fl=tl(tl(tl(tl(tl({},V.MH.PREBID_NO_BID,"prebid_noBid"),V.MH.PREBID_EMPTY_RESPONSE,"prebid_emptyResponse"),V.MH.PREBID_MISSING_PRICE,"prebid_unsupportedCurrency"),V.MH.PREBID_CPM_ABOVE_THRESHOLD,"prebid_cpmAboveThreshold"),V.MH.PREBID_CPM_BELOW_FLOOR,"prebid_cpmBelowFloor"),vl=function(){return e=function e(t){var i,r,n,o,a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),tl(this,"isIMATag",(function(){return a.tag.t===C.l.ITEM_TYPES.IMA})),(0,j.mixin)(this),this.store=t.store,this.target=t.target,this.options=t.options,this.isAdvDelayLoad=t.isAdvDelayLoad,this.tag=Object.assign({},t.tag),this.demandTypeSettings=this.store.getByDemandType(this.tag.advType),this.clickThroughHandler=new Un(this.store),this.index=++rl,this.adElasticLogger=new Vo({store:this.store,tag:this.tag}),this.debugTracker=new y.A("VpaidWrapper".concat(this.index)),this.isOmidActive=this.tag.getValueByKey("enblomid")||this.store.get("omid.isActive"),this.tag.vpaidWrapperData={},this.isMultiAdsActive=this.store.get("mltads"),this.isMultiVpaidUnit=this.store.get("isMultiVpaidUnit"),this.adLoadedFired=!1,this.hijackFired=!1,this.blockBringToFront=this.isMultiVpaidUnit&&this.store.get("blckbrngtofrnt"),this.waitForAdPausedBeforeResumeAd=this.store.get("wtfradpsdbfrrsmad"),this.isVerticalVideoSupported=this._isVerticalVideoSupported(),this.tag.vpaidWrapperData.oneSecViewability=this.tag.getValueByKey("one_sec_viewability"),this.vpaidStatus=sl,this.stayAlive=!1,this.isMobile=this.store.get("isMobile")||!1,this.adTimers=new ns,this.timeoutLengthToAdCompletion=this.tag.getValueByKey("".concat(this.isMobile?"mbl":"dsk","tmouttoadcmpltn")),this.newCompletionByVideoProgress=this.store.get("q5byprgrss"),this.validateViewabilityFiredBeforeCompletion=this.tag.getValueByKey("vldtvwbfrcmp")||!1,this.setAdVolume=(0,m.T7)(this.store.get("dbncadvltm"),this._setAdVolume.bind(this)),this.RVTypeToDelayVideoVpaidImpressionOn=this.tag.getValueByKey("rvtyptodlyvdovmpson"),this.adElasticLogger.logTBCompletion(this.timeoutLengthToAdCompletion,this.newCompletionByVideoProgress),this.pwov=(i=this.tag.getValueByKey("optpwov"),r=this.tag.isDirectDemand,n=this.tag.isCPCV,o=r&&n?0:100,(0,m.bv)(i,o)),this.adElasticLogger.logPlayWhenOutOfView(this.pwov,this.tag.cstmdl),this._wfStats=this.tag.wfStats,this._wfStats.increaseVpaidsCount(),this.adEvents=new V.NU({store:this.store,tag:this.tag,index:this.index,creatives:t.config.creatives}),this.adEvents.onEvent(ke.A.TagStarted),this.store.get("unitFetcherWfActive")&&this._reportDemandFirstWf(),this.vpaidResourcesHandler=new nn(this.store,this.tag,this.adElasticLogger),this.onVpaidResourceEvent=this._onVpaidResourceEvent.bind(this),this.vpaidResourcesHandler.on("vpaidResourceEvent",this.onVpaidResourceEvent),this.config=(0,m.h2)(t.config)||{},this.config.creatives=(0,m.h2)(t.config.creatives),this.adVolume=(0,m.ZE)(parseInt(this.config.VOLUME)?parseInt(this.config.VOLUME):0),this.adView=new Ya({store:this.store,tag:this.tag,target:this.target,index:this.index,adElasticLogger:this.adElasticLogger,demandTypeSettings:this.demandTypeSettings}),this.vpaidHandlersFactory=new xn(this.adElasticLogger,this.store),this.handlerOptions={applyBypass:!!this.config.creatives.AFBP,slot:this.adView.placement,videoSlotControls:!!this.config.videoSlotControls,videoSlotCanAutoPlay:!!this.config.videoSlotCanAutoPlay,protection:this.config.vpaid_protect_path,tag:this.tag,onReady:this._onHandlerCreated.bind(this),onError:this._onHandlerError.bind(this),playerDAST:this.adEvents.playerDAST,vpaidResourcesHandler:this.vpaidResourcesHandler,wrapperIndex:this.index,debugTracker:this.debugTracker,extra:{}},this.adView.createClickArea(),this.adView.createVideoTag(this.config),this.adView.videoTag.addEventListener("timeupdate",(function(e){a._onTimeupdate(a.adView.videoTag)})),this.handlerOptions.videoSlot=this.adView.videoTag,this.handlerOptions.clickableTarget=this.adView.clickArea||null,this.vastHandler=new oa(this.store,{vpaidLog:this.adElasticLogger.vpaidLog,width:this.config.width,height:this.config.height,bitrate:this.config.bitrate,tag:this.tag}),this._registerToVastHandlerEvents(),this.vpaidHandler=!1,this.stopped=!1,this._handleWfItemByType(),this._initAdLoadedTimer(),this._setTimers(),this.isReplayable=!1,this.stopwatch=new fa},t=[{key:"_isVerticalVideoSupported",value:function(){var e;return(0,m.hX)(null===(e=this.demandTypeSettings)||void 0===e?void 0:e.spprtvrtclvd)?this.tag.getValueByKey("spprtvrtclvd"):this.demandTypeSettings.spprtvrtclvd}},{key:"_reportDemandFirstWf",value:function(){this.store.get("unitFetcherDemand")?(this.adEvents.onEvent(V.MH.UNIT_FETCHER_DEMAND),this.store.set("unitFetcherDemand",!1)):this.store.get("liteUnitDemand")&&(this.adEvents.onEvent(V.MH.LITE_UNIT_DEMAND),this.store.set("liteUnitDemand",!1))}},{key:"_createVideoControls",value:function(){this.store.get("useVideoControls")&&!1!==this.tag.getValueByKey("ad_controls")&&(this.videoControls=new st(this.isMobile,{video:this.adView.videoTag,store:this.store,target:this.adView.placement,controls:[this.resumeAd.bind(this),this.pauseAd.bind(this)]}),this.videoControls.setOnSoundChangeCallback(this._onSoundChange.bind(this)),this.videoControls.on(Ge.VOLUME_CHANGE,this.setAdVolume.bind(this)),this.videoControls.on(Ge.TIMEUPDATE_REGISTER,this.registerToVPAIDVideoTimeupdateEvent.bind(this)),this.videoControls.on(Ge.RESET_CONTROLS,this._resetVideoControls.bind(this)))}},{key:"_registerToVastHandlerEvents",value:function(){this.bindedCreateHandler=this._createHandler.bind(this),this.bindedOnVastHandlerError=this._onVastHandlerError.bind(this),this.vastHandler.on(aa.MEDIA_FILES_FOUND,this.bindedCreateHandler),this.vastHandler.on(aa.ERROR,this.bindedOnVastHandlerError)}},{key:"_updatePlacement",value:function(e){this.tag.modifiedPlacement=e}},{key:"_unregisterFromVastHandlerEvents",value:function(){this.vastHandler.off(aa.MEDIA_FILES_FOUND,this.bindedCreateHandler),this.vastHandler.off(aa.ERROR,this.bindedOnVastHandlerError)}},{key:"_handleWfItemByType",value:function(){this.tag.isPrebid?this._parsePrebidItem():this.isIMATag()?this._parseIMAItem():this._parseItem()}},{key:"_parsePrebidItem",value:(n=$s(Js().mark((function e(){var t,i,r;return Js().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={placement:this.adView.placement,bidderRequest:this.tag.url.bidderRequest},o=void 0,a=void 0,s=void 0,l=void 0,d=void 0,u=void 0,c=void 0,h=void 0,o=n.placement,a=n.bidderRequest,s=a.bids[0],l=Ts(o),d=ks(a,s),u=ws(s),c=Ss(s),h=Is(a,s),t=As(As(As(As(As({},l),d),u),c),h),i=fs({bidderRequest:this.tag.url.bidderRequest,itemsToParse:t}),e.next=4,this.vpaidHandlersFactory.createPrebidHandler(this.tag.bidder,this.tag,i);case 4:if(this.prebidHandler=e.sent,this.prebidHandler){e.next=8;break}return this._onVastHandlerError({type:"handlerCreatingFail",adEvent:V.MH.PREBID_HANDLER_NOT_SUPPORTED,eventData:{isPrebid:!0,bidder:null===(r=this.tag)||void 0===r?void 0:r.bidder}}),e.abrupt("return");case 8:this.prebidHandler.once(us.FD.BID_WON,this._onPrebidBidWon.bind(this)),this.prebidHandler.once(us.FD.NO_BID,this._onPrebidNoBid.bind(this)),this.prebidHandler.requestBids();case 11:case"end":return e.stop()}var n,o,a,s,l,d,u,c,h}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"_onPrebidBidWon",value:function(e){this.adEvents.onEvent(V.MH.PREBID_BID_WON),this.stopped||(e.url||e.vast?e.currency===us.yR.USD&&e.price?e.price>e.maxBidThreshold?this._onPrebidNoBid(V.MH.PREBID_CPM_ABOVE_THRESHOLD):e.price<e.floor?this._onPrebidNoBid(V.MH.PREBID_CPM_BELOW_FLOOR):(this.tag.url=e.url,this.tag.vast=e.vast,this.tag.prebidPrice=e.price,this.tag.dspCreativeId=e.dspCreativeId,this.adEvents.onEvent(V.MH.PREBID_BID_VALID),this.tag.vast&&this.tag.vast.indexOf("imasdk.googleapis.com")>-1?this._parseIMAItem():this._parseItem()):this._onPrebidNoBid(V.MH.PREBID_MISSING_PRICE):this._onPrebidNoBid(V.MH.PREBID_EMPTY_RESPONSE))}},{key:"_onPrebidNoBid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:V.MH.PREBID_NO_BID;this.stopped||this.stop(fl[e],e)}},{key:"_parseIMAItem",value:function(){this.adEvents.trackingPixelManager=this.vastHandler.trackingPixelManager,this.type=we.ADX,this.vpaidHandler=this.vpaidHandlersFactory.create("ima",this.handlerOptions),this.vpaidHandler.on(fr.adError,this._handleIMAError.bind(this)),this.tag.vpaidWrapperData.mediatype=this.vpaidHandler.getMediaType()}},{key:"_handleIMAError",value:function(e){var t;this.adElasticLogger.logIMAError(null==e||null===(t=e.eventData)||void 0===t?void 0:t.data)}},{key:"_parseItem",value:function(){this.stopped||(this.tag.vast?this.vastHandler.parseVastFromXML(this.tag.vast):this.vastHandler.parseVastFromURL(this.tag.url,this.tag.request&&"GET"!==this.tag.request.method?this.tag.request.data:void 0))}},{key:"_initAdLoadedTimer",value:function(){this.adTimers.waitForVPAIDEvent(ke.A.AdLoaded,this.tag.getValueByKey("altmot")||this.tag.ADTO,ol,this._onAdLoadedTimeout.bind(this))}},{key:"_setTimers",value:function(){this._initTillAdstartTimeout(),this._initAutoKillTimeOut()}},{key:"_initTillAdstartTimeout",value:function(){var e=this;if(!this.adTimers.hasTimer(al.UNTIL_AD_START)){var t=this.type&&this.store.getByTech("adto",this.type)||this.tag.getValueByKey("adto")||this.tag.ADTO;this.adTimers.setTimer(al.UNTIL_AD_START,t,(function(){e.adElasticLogger.logAdStopped(),e._firePixel(ke.A.AdError,{eventData:{iabErrorCode:Wn.A.timeout}}),e.stop(Us,V.MH.AD_TIMEOUT)}))}}},{key:"_initAutoKillTimeOut",value:function(){var e=this;if(!this.adTimers.hasTimer(al.AUTO_KILL)){var t=this.type&&this.store.getByTech("vakll",this.type)||this.tag.getValueByKey("vakll")||9e4;this.adTimers.setTimer(al.AUTO_KILL,t,(function(){e.adElasticLogger.logAutoKill(t),e.emit(ke.A.AdVideoComplete,{eventData:e}),e._firePixel(ke.A.AdError,{eventData:{iabErrorCode:Wn.A.timeout}}),e.stop(Ws,V.MH.GLOBAL_TIMEOUT)}))}}},{key:"_killTimers",value:function(){this.adTimers.clearTimer(al.AUTO_KILL),this.adTimers.clearTimer(al.UNTIL_AD_START),this.adTimers.clearVPAIDEvent(ke.A.AdLoaded),this.adTimers.clearVPAIDEvent(ke.A.AdImpression)}},{key:"_onHandlerError",value:function(e,t){this.adElasticLogger.logEarlyAdError(e),this.adLoadedFired||(this.status="error",this.stopped||(this.emit(ke.A.AdError,{eventData:e}),"adUnitLoadFailed"===t&&(this.adElasticLogger.logAdUnitLoadFailed(e),this._firePixel(ke.A.AdError,{eventData:{iabErrorCode:Wn.A.timeout}}),this.stop("adUnitLoadFailed",V.MH.AD_UNIT_LOAD_FAILED))))}},{key:"_onHandlerCreated",value:function(){var e=this;this.stopped||(this.adElasticLogger.logCreatedVpaidHandler(),this._connectToVpaidHandler(),this.vpaidHandler.handshakeVersion("2.0"),this.adElasticLogger.logInitAd(),this.on("unit::viewability",(function(){e.unitVieawbility=!0,e.adElasticLogger.logViewability()})),this.isIMATag()&&this.adEvents.onEvent(V.MH.ADX_REQUEST),this.vpaidHandler.initAd(this.config.width,this.config.height,this.config.viewMode,this.config.bitrate,{AdParameters:this.config.creatives.AdParameters},{slot:this.adView.placement,videoSlot:this.adView.videoTag,videoSlotControls:!!this.config.videoSlotControls,videoSlotCanAutoPlay:!!this.config.videoSlotCanAutoPlay}))}},{key:"_connectToVpaidHandler",value:function(){if(!this.stopped)for(var e in ke.A)this.vpaidHandler.subscribe(this._handleVpaidEvents.bind(this,ke.A[e]),ke.A[e])}},{key:"_adLoadedHandler",value:function(){if(!this.stopped){if(this.adLoadedFired=!0,this.debugTracker.time("[VpaidWrapper".concat(this.index,"] adLoaded->startAd()")),this.debugTracker.info("RequiredViewability:".concat(this.tag.requiredViewability)),this.debugTracker.info("Ad loaded now => pause it srcEvent"),this.adEvents.onEvent(V.MH.AD_LOADED),this.vpaidStatus=ll,this.status="ready",this._setIsUnpaused(!0),this.store.emit("vpaidReady",this),this.setAdVolume(this.adVolume),this.vpaidHandler.checkUnfriendlyIframe&&(this.isUnfriendlyIframe=this.vpaidHandler.checkUnfriendlyIframe()),this.type&&this.type==Se.VPAID){this.earlySrcVPAID=!1;var e=this.adView.getVideoSource();e&&(this.earlySrcVPAID=!0,this.isMobile&&this.vpaidHandler.prefetchVideo&&(this.vpaidHandler.prefetchVideo(Se.VPAID,e),this.debugTracker.info("_adLoadedHandler() -> javascript vpaidHandler.prefetchVideo() src:".concat(e))))}this.vpaidResourcesHandler&&this.vpaidResourcesHandler.setVpaidAnalyticsIsVideoUrlPublic&&this.vpaidResourcesHandler.setVpaidAnalyticsIsVideoUrlPublic(""!==this.getVideoUrl());var t=this.store.get("rvfrquesttsemttr");"any"!==t&&this.tag.requiredViewability!==t||this.store.emit(Me)}}},{key:"startAd",value:function(e){var t,i,r,n,o,a,s,l,d,u,c=this;this.adEvents.predictorId=e.predictId,this.getAdId=e.id,this.startTimestamp=new Date,this.adStarted=!0,this.debugTracker.timeEnd("[VpaidWrapper".concat(this.index,"] adLoaded->startAd()")),this.setAdVolume(this.adVolume),this._startForceAdVolumeInterval(),this.options=Object.assign(e||{},this.store.get("getAdData")),this.isStarted=!0,this.store.incr("ads_started"),this.vpaidStatus=dl,this.type!==we.VIDEO||this.options.predictId===C.l.PREDICTORS.IMMEDIATE_START?this._sendStartAdOpp():addEventListener("AdResume",this._sendStartAdOpp.bind(this),!1),this.adElasticLogger.logAdOptions(this.options),this.adElasticLogger.logStartAd(),this.earlyAdImpression||this.adTimers.waitForVPAIDEvent(ke.A.AdImpression,(t={RV1Timeout:this.store.get("rv1adimptmot"),PPDTimeout:this.store.get("ppdAdImpressionTimeoutInMS"),requiredViewability:this.tag.requiredViewability,isPPD:this.store.get("isPPD"),defaultTimeout:this.store.get("adimptmot")},i=t.RV1Timeout,r=void 0===i?0:i,n=t.PPDTimeout,o=void 0===n?0:n,a=t.requiredViewability,s=void 0!==a&&a,l=t.isPPD,d=void 0!==l&&l,u=t.defaultTimeout,d?o:s&&r>0?r:void 0===u?0:u),this.emit.bind(Gl.CLEAR_GET_AD_TIMEOUT,e),this._onAdImpressionTimeout.bind(this)),this.isUnPaused?(this.debugTracker.info("startAd()"),this.vpaidHandler.startAd(),this.stopwatch.start()):(this.debugTracker.info("resumeAd() from startAd()"),this.vpaidHandler.resumeAd(),this.stopwatch.resume()),this.adTimers.clearTimer(al.UNTIL_AD_START),this.working=!0,this.earlyAdImpression&&(this._onAdImpression(),this.emit(Gl.CLEAR_GET_AD_TIMEOUT,e)),this.vpaidHandler.on("activeAdCurrentTime",(function(e){c.emit("activeAdCurrentTime",e)})),this.newCompletionByVideoProgress&&(this._newCompletionListener=function(){c._newCompletionHandler("timerEnded")},this.vpaidHandler.on(Le,this._newCompletionListener)),this.tag.nas&&this.vpaidHandler.on("clickThruUrlFound",(function(e){c.landingPageUrl=e}))}},{key:"_sendStartAdOpp",value:function(){removeEventListener("AdResume",this._sendStartAdOpp),this.adEvents.onEvent(V.MH.START_AD),this._dispatchOmidEvents("startAd"),this.store.set("ads_started_fired",!0)}},{key:"_startForceAdVolumeInterval",value:function(){var e=this;if(!this.isMobile&&!this.adTimers.hasInterval(al.FORCE_AD_VOLUME)){this.adTimers.setInterval(al.FORCE_AD_VOLUME,this.store.get("frcadvlmtrvl"),(function(){e.vpaidHandler&&!e.vpaidHandler.stopped?e.setAdVolume(e.adVolume):e.adTimers.clearInterval(al.FORCE_AD_VOLUME)}));var t=this.store.get("stpfrcvlevnt")||ke.A.AdVideoFirstQuartile;this.adTimers.waitForVPAIDEvent(t,0,this._stopForceAdVolumeInterval.bind(this))}}},{key:"_stopForceAdVolumeInterval",value:function(){this.adTimers.clearInterval(al.FORCE_AD_VOLUME)}},{key:"restartAd",value:function(){var e=this;this.isReplayable&&(this.adEvents.resume(),this.adEvents.onEvent(V.MH.REPLAY_AD),this.adEvents.pause(),this.working=this.isStarted=this.adStarted=!0,this.store.incr("ads_started"),this.vpaidHandler.restartAd(this.getVideoUrl(),this.landingPageUrl),setTimeout((function(){e.bringToFront()})))}},{key:"isReplayableVpaid",value:function(){return this.tag.getValueByKey("rplvpdactv")&&this.vpaidHandler&&this.vpaidHandler.isReplayable()}},{key:"dontDie",value:function(){(this.tag&&this.tag.singleAd||this.store.get("forceSingleAd"))&&(this.stayAlive=!0,this.vpaidHandler&&this.vpaidHandler.dontDie&&this.vpaidHandler.dontDie(),this._killTimers())}},{key:"_handleStopped",value:function(e){this.adView.moveToBack(),this.stop(e.type,e.adEvent),this.working=!1}},{key:"pauseAd",value:function(){!this.stopped&&this.isUnPaused&&(this.waitForAdPausedBeforeResumeAd&&(this.isUnPaused&&(this.adPausedFired=!1),this.resumeOnAdPaused&&(this.resumeOnAdPaused=!1)),this.pauseAdStartTime=Date.now(),this.working=!1,this.vpaidHandler.pauseAd(),this.stopwatch.pause(),this._pauseAdTimeoutToCompletion(),this._pauseGlobalAdTimeout(),this.emit("adPaused"))}},{key:"resumeAd",value:function(){this.stopped||!this.isMultiAdsActive&&this.store.get("forcePause")||(!this.waitForAdPausedBeforeResumeAd||this.adPausedFired?(this.resumeOnAdPaused=!1,this.working=!0,this.vpaidHandler.resumeAd(),this.stopwatch.resume(),this.emit("adResumed"),this.adView.activateVideoTag(),this.workingVpaid||(this._isDelayedImpressionByRVType()&&(this._fireNetworkAdImpression(),this._firePixel(ke.A.AdVideoStart,{})),this._dispatchOmidEvents(ke.A.AdVideoStart,!0,!0),this._dispatchOmidEvents(ke.A.AdImpression,!0,!0)),this.isMultiVpaidUnit&&(this.isVerticalVideoSupported&&this.isVertical||this.resizeAd(this.store.get("width"),this.store.get("height"))),this.videoControls&&!this.workingVpaid&&(this.videoControls.resetAdControls(),this.isMobile&&this._setVideoControlsState({playerState:jn})),this.store.set("ad_controls",!1!==this.tag.getValueByKey("ad_controls")),this.workingVpaid=!0,this._setTimeoutToAdCompletion(),this._setGlobalAdTimeout()):this.resumeOnAdPaused=!0)}},{key:"_setGlobalAdTimeout",value:function(){var e=this;this.adTimers.hasTimer(al.GLOBAL_TIMEOUT)?this.adTimers.resumeTimer(al.GLOBAL_TIMEOUT):this.adTimers.setTimer(al.GLOBAL_TIMEOUT,this.tag.getValueByKey("global_ad_timeout"),(function(){e.stopped||e.stop(Gs.GLOBAL_AD_TIMEOUT,V.MH.GLOBAL_AD_TIMEOUT)}))}},{key:"_pauseGlobalAdTimeout",value:function(){this.adTimers.pauseTimer(al.GLOBAL_TIMEOUT)}},{key:"_setTimeoutToAdCompletion",value:function(){var e=this,t=this.newCompletionByVideoProgress&&null!=this.vpaidHandler.activeVideoElement;this.adEvents.isEventFired(V.MH.TB_COMPLETION)||t||(this.adTimers.hasTimer(al.TB_COMPLETION)?this.adTimers.resumeTimer(al.TB_COMPLETION):this.adTimers.setTimer(al.TB_COMPLETION,this.timeoutLengthToAdCompletion,(function(){e.stopped||e._newCompletionHandler("timerEnded")})))}},{key:"_pauseAdTimeoutToCompletion",value:function(){this.adTimers.pauseTimer(al.TB_COMPLETION)}},{key:"_fireNewCompletionEvent",value:function(){this.adEvents.onEvent(V.MH.TB_COMPLETION),this.vpaidStatus=pl,this.emit(Le),this.adTimers.clearTimer(al.TB_COMPLETION),this.unsubscribe(this._newCompletionListener,Le)}},{key:"getVideoUrl",value:function(){return this.videoUrl||(this.videoUrl=this.vpaidHandler.getVideoUrl?this.vpaidHandler.getVideoUrl():""),this.videoUrl}},{key:"_dispatchOmidEvents",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.omidHandler&&!1!==t&&(e===ke.A.AdPaused&&this._checkFirstAdPaused()||e==ke.A.AdPlaying&&this._checkFirstPlayEvent()||this.adEvents.shouldDelayEvent(e,!i)||this.omidHandler.dispatch({type:e,duration:this.adDuration,adVolume:this.adVolume}))}},{key:"_checkFirstPlayEvent",value:function(){return!!this.isFirstPlay&&(this.isFirstPlay=!1,!0)}},{key:"_checkFirstAdPaused",value:function(){if(!this.isFirstAdPaused)return this.isFirstAdPaused=!0,this.isFirstPlay=!0,!0}},{key:"_handleVpaidEvents",value:function(e,t){var i,r,n=this;if(ke.A){if(this.type===Se.VPAID&&(this.tag.getValueByKey("cmpltonstpd")||this._getAdSettingValue("cmpltonstpd")||this.vpaidHandler.completeOnAdStop)){if(e===ke.A.AdVideoComplete)return void(this.vpaidHandler&&this.vpaidHandler.setCompletionOnAdStoppedTimeout&&this.vpaidHandler.setCompletionOnAdStoppedTimeout());e===ke.A.AdStopped&&(e=ke.A.AdVideoComplete)}!this.isFirstVpaidEvent&&this.vpaidHandler&&this.vpaidHandler._getMediaUrl()&&(this.isFirstVpaidEvent=!0,this.adElasticLogger.logMediaUrl(this.vpaidHandler._getMediaUrl()));var o=!0;if(!this.stopped){var a;switch(e!==ke.A.AdStarted&&(a=this._firePixel(e,t)),this.debugTracker.info("VpaidHandler-event",e),this._dispatchOmidEvents(e,a),this.adTimers.onVPAIDEvent(e),e){case ke.A.AdLoaded:this._adLoadedHandler(),this._sendVpaidAnalyticsReport(e),this.vpaidHandler.getAdIcons&&this.vpaidHandler.getAdIcons(this.adElasticLogger.logAdIcons.bind(this.adElasticLogger)),(this._isDelayedIMATag()||this.isAdvDelayLoad)&&this.startAd(this.options);break;case ke.A.AdImpression:if(this._sendVpaidAnalyticsReport(e),this.store.emit("playContentAfterFirstAd"),o=this._onAdImpression(e),this.adView.logActualVideoSize(),this.store.get("isVerticalDemandBlocked")&&this.adView.isVerticalVideo(this.adView.videoTag.videoWidth,this.adView.videoTag.videoHeight,this.store.get("playerAspectRatio")))return void this.stop(Gs.BLOCKED_VERTICAL_DEMAND,V.MH.BLOCKED_VERTICAL_DEMAND);if(this.adView.handleVerticalVideo(parseInt(this.store.get("width")),parseInt(this.store.get("height"))),this.adView.handleNextUpFit(parseInt(this.store.get("width")),parseInt(this.store.get("height"))),this.adView.handleSquareVideo(),this._getAdDuration().then((function(e){return n.adElasticLogger.logAdDuration(e)})),this.earlyAdImpression)return;break;case ke.A.AdVideoStart:this.adEvents.onEvent(V.MH.AD_VIDEO_START),this.setAdVolume(this.adVolume),this._firePixel(E.A.start),this._setIsUnpaused(!0),this.debugTracker.info("_handleVpaidEvents() -> AdStarted || AdVideoStart -> this.isUnPaused = true");break;case ke.A.AdSkipped:this._fireNewCompletionEvent(),this._handleStopped({type:e,adEvent:V.MH.AD_SKIPPED}),this.adStoppedHandler(e);break;case ke.A.AdStopped:this.adStoppedHandler(e),this._handleStopped({type:e});break;case ke.A.AdLog:this.debugTracker.info("VpaidHandler-Log",arguments);break;case ke.A.AdError:this.vpaidStatus=hl,this.type===we.VIDEO?this.stop("Mp4AdError",e):this.stop(ke.A.AdError,e,t);break;case ke.A.AdPaused:this.pauseAdStartTime=void 0,this.adPausedFired=!0,this.waitForAdPausedBeforeResumeAd&&this.resumeOnAdPaused&&this.resumeAd(),this._setIsUnpaused(!1),this._pauseAdTimeoutToCompletion(),this._pauseGlobalAdTimeout();break;case ke.A.AdClickThru:this._fireNewCompletionEvent(),t=function(e,t){var i;if(null!=e&&null!==(i=e.eventData)&&void 0!==i&&i.url||!t)return e;var r={url:t};return e?(e.eventData=Object.assign(e.eventData||{},r),e):{eventData:r}}(t,this.landingPageUrl),this._pauseAdTimeoutToCompletion(),this._pauseGlobalAdTimeout();break;case ke.A.AdPlaying:this._setTimeoutToAdCompletion(),this._setGlobalAdTimeout(),this._fireAdPlaying();case ke.A.AdStarted:this.adEvents.onEvent(V.MH.AD_STARTED),this._setIsUnpaused(!0),this._firePixel(E.A.creativeView);break;case ke.A.AdVolumeChange:t&&t.eventData&&t.eventData.volume&&(this.adVolume=(0,m.ZE)(t.eventData.volume),this._dispatchOmidEvents(e,!0===this.hadImpression));break;case ke.A.AdVideoThirdQuartile:this.hasReachedThirdQuartile=!0;break;case ke.A.VideoBlacklisted:this.adElasticLogger.logVastFilteredByRegex(null===(i=t)||void 0===i?void 0:i.match,!0,null===(r=t)||void 0===r?void 0:r.regex),this.stop(sa.FILTER_BY_REGEX,V.MH.FILTER_VAST_BY_REGEX,{})}if(this.emit(e,{type:e,data:t}),this.adElasticLogger.logVpaidEvent(e,t&&t.eventData?(0,m.As)(t.eventData):void 0,(0,m.vZ)(this.adView.videoTag)),a&&this.adEvents.onEvent(e),ke.A)if(e===ke.A.AdClickThru)this.landingPageUrl=t&&t.eventData?t.eventData.url:"",this.isClicked=!0,this.clickThroughHandler.invokeClick(t.eventData);else if(e==ke.A.AdVideoComplete){var s,l;this.adCompleted=!0;var d,u=this.store.get("placement");if(null===(s=TRC)||void 0===s||null===(l=s.dispatch)||void 0===l||l.call(s,"onVideoEnd".concat(u?"_".concat(u.replace(" - Video","")):"")),this._newCompletionHandler(ke.A.AdVideoComplete,a),this.stayAlive)return this.adTimers.clearTimer(al.GLOBAL_TIMEOUT),null===(d=this.omidHandler)||void 0===d||d.dispose(),void this.emit("end");this.vpaidHandler.stopAd(),this.adTimers.setTimer(al.AD_COMPLETION),setTimeout((function(){n.working=!1,n.workingVpaid=!1,n.stop(ke.A.AdVideoComplete),n.status="stopped"}),2)}o&&this.emit(Gl.TRIGGER_EVENT,e,this,t?t.eventData:void 0)}}}},{key:"_sendVpaidAnalyticsReport",value:function(e){this.adElasticLogger.vpaidLog.getVpaidAnalyticsReport&&this.adElasticLogger.logVpaidAnalytics(e,this.adElasticLogger.vpaidLog.getVpaidAnalyticsReport())}},{key:"_setIsUnpaused",value:function(e){this.isUnPaused=e,this._setVideoControlsState({isPaused:!e})}},{key:"_newCompletionHandler",value:function(e,t){if(!this.adEvents.isEventFired(V.MH.TB_COMPLETION)&&(this.adTimers.hasTimer(al.TB_COMPLETION)||this.newCompletionByVideoProgress)){if(this.adTimers.clearTimer(al.TB_COMPLETION),this._validateNewCompletionFiring(e,t))return void this._fireNewCompletionEvent();this.adElasticLogger.logFailedTBCompletion(e)}}},{key:"_validateNewCompletionFiring",value:function(e,t){return this.validateViewabilityFiredBeforeCompletion&&!this.unitVieawbility?(this.adElasticLogger.logCompletionBeforeViewability(this.adView.videoTag,this.newCompletionByVideoProgress,e),!1):e===ke.A.AdVideoComplete?t&&this.adEvents.isEventFired(ke.A.AdVideoComplete):"timerEnded"===e}},{key:"_getHipItems",value:function(){return Object.entries(TRCImpl&&TRCImpl.boxes||{}).filter((function(e){var t=Ys(e,2),i=(t[0],t[1]);return i&&C.l.ABOVE_THE_FEED.MODES.some((function(e){return i.mode.includes(e)}))})).map((function(e){var t=Ys(e,2),i=(t[0],t[1]);return{placement:i&&i.placement}}))}},{key:"_isAboveTheFeedPlacement",value:function(){return void 0!==this.hipItemObj}},{key:"_shouldUpdateAboveTheFeedPlacement",value:function(){var e=this._getHipItems();return this.hipItemObj=e[e.length-1],"FEED_MANAGER"===this.store.get("unit_type")&&(0,m.Jr)(this.store)&&this._isAboveTheFeedPlacement()&&this.tag.hip}},{key:"_onAdImpression",value:function(){var e=!0,t=this.store.get("rstmrai");return this._shouldUpdateAboveTheFeedPlacement()&&this._updatePlacement(this._getHipObjPlacement()),this.store.get("isNextUp")&&this._updatePlacement("nextUp"),this.adView.fireIconViewTracking(),t&&this._killTimers(),!this.adStarted&&this.store.get("erlyai")?(this.earlyAdImpression=!0,this.adEvents.onEvent(V.MH.EARLY_AD_IMPRESSION),this.pauseAd(),this._setIsUnpaused(!1),this.adElasticLogger.logEarlyAdImpression(),this.adTimers.clearTimer(al.UNTIL_AD_START),this.tag.getValueByKey("prvnterlyadimpopp")||this.adSettings&&this.adSettings.prvnterlyadimpopp||this._shouldSkipEarlyAdImpression()||this._fireAdImpression(),!1):(this.hadImpression?e=!1:(this.adElasticLogger.logAdSuccess(this.store.incr("conversionsCount")),this.setAdVolume(this.adVolume),this.emit(ke.A.AdImpression),this._fireAdImpression(),this.hadImpression=!0,this.adEvents.hadImpression=!0,this._wfStats.increaseSuccess(),this.vpaidHandler&&this.vpaidHandler.logVideoUrl&&this.vpaidHandler.logVideoUrl(),this.vpaidHandler&&!this.vpaidHandler.activeVideoElement&&this.adEvents.onEvent(V.MH.NON_FRIENDLY_VIDEO),this.isReplayable=this.isReplayableVpaid(),this.adElasticLogger.logRestartAd(this.isReplayable),this.adEvents.updatePlayerDAST(V.J7.AD_IMPRESSION,{videoUrl:this.getVideoUrl(),videoEl:this.vpaidHandler.getVPAIDVideoElement?this.vpaidHandler.getVPAIDVideoElement():this.adView.videoTag})),this.earlyAdImpression&&this.emit(Gl.TRIGGER_EVENT,ke.A.AdImpression,this),e)}},{key:"_getHipObjPlacement",value:function(){return this.hipItemObj&&this.hipItemObj.placement}},{key:"_shouldSkipEarlyAdImpression",value:function(){if(this.type===Se.VPAID&&this.store.get("jsDsbleErlyai")&&this.tag.requiredViewability)return!0}},{key:"_fireAdImpression",value:function(){this.adimpFired||(this._isDelayedImpressionByRVType()?this.vpaidStatus=ul:(this.adElasticLogger.logAsyncAdImpressionFired(),this._fireNetworkAdImpression()))}},{key:"_isDelayedImpressionByRVType",value:function(){return this.type===we.VIDEO&&("any"===this.RVTypeToDelayVideoVpaidImpressionOn||this.tag.requiredViewability===this.RVTypeToDelayVideoVpaidImpressionOn)}},{key:"_fireNetworkAdImpression",value:function(){var e,t,i,r=null===(e=this.adView)||void 0===e?void 0:e.getVideoSource();this.adEvents.onEvent(ke.A.AdImpression,{buffer:r?this.adView.getVideoBuffered():void 0,vdr:r?this.adView.getVideoDuration():void 0}),this._firePixel(ke.A.AdImpression,{},!0),this.adimpFired=!0,this.adEvents.onEvent(V.MH.FIRST_SESSION_IMPRESSION),this.adEvents.sendDelayedQuartileOpps();var n=this.store.get("placement");null===(t=TRC)||void 0===t||null===(i=t.dispatch)||void 0===i||i.call(t,"onVideoStart".concat(n?"_".concat(n.replace(" - Video","")):""))}},{key:"_fireAdPlaying",value:function(){this.hadImpression&&this.workingVpaid&&(this.adEvents.onEvent(V.MH.AD_PLAYING),this.emit(Gl.TERMINATE_PPD,this.tag.advType),this.vpaidStatus=cl)}},{key:"adStoppedHandler",value:function(e){var t=this;this.stop(),setTimeout((function(){t._cleanVpaid()}),1e4)}},{key:"_setAdVolume",value:function(e,t){this.stopped||(0===this.adVolume&&e>0&&this.adEvents.onEvent(V.MH.AD_UNMUTED),t&&this.adView.isVideoHover()&&this.adEvents.onEvent(V.MH.SOUND_ON_HOVER),e=(0,m.ZE)(e),this.adVolume=e,this.adView.setVolume(e),this.adVolume>0&&this._stopForceAdVolumeInterval(),this.store.get("frcmtfrms")&&function(e){var t=e.iframes,i=void 0===t?[]:t,r=e.volume,n=void 0===r?0:r,o=e.shouldMuteVideo,a=void 0!==o&&o,s=e.isDebug,l=void 0!==s&&s;(0,m.vn)(i[0],"iframe",(function(e){e.forEach((function(e){ls(e,n),e.setAttribute(ss,n),e.volume=n,a&&(e.muted=0===n)}))}),"video",l)}({iframes:this.adView.getIframesFromPlacement(),volume:e,isDebug:this.store.get("debug"),shouldMuteVideo:this.store.get("dskVidMuted")&&!this.isMobile}),this.vpaidHandler&&(this.vpaidHandler.setAdVolume(e,t),this.vpaidHandler.callIMAApi&&this.vpaidHandler.callIMAApi("volume",e)),e>0?this._firePixel(Re,{}):this._firePixel(Ve,{}))}},{key:"_onVastHandlerError",value:function(e){this.stopped||(this.status="error",this.isPlaying=!1,this.adElasticLogger.logAdError(e),this.vastHandler&&this.vastHandler.hasTrackingPixels()&&this.vastHandler.fireErrorPixels(ke.A.adError),this.stop(e.type||"",e.adEvent,e.eventData))}},{key:"_updateAdVideoDurationOnVideoControls",value:function(e){this._setVideoControlsState({vidDuration:e,vidCurrentTime:0})}},{key:"_createHandler",value:function(e){if(!this.stopped){if(e&&e.vastOptions&&e.vastOptions.hasOmid){var t={vastVersion:(r=e.vastOptions.analysis.vr,parseInt(r)),vendorsNum:e.vastOptions.omidElements.length,vendor:e.vastOptions.omidVendor};this.adEvents.onEvent(V.MH.OMID_DETECTED,{vendor:(i=this.omidVendor||t.vendor,i.substring(0,30))}),this.handlerOptions.omid=e.vastOptions.omidElements}var i,r;e&&(this.setVastPrice(e.vastOptions.price),this.adView.handleVastIcons(e.vastOptions.icons||[]),this.adEvents.updatePlayerDAST(V.J7.SET_KEY,{vdr:e.handlerOptions.extra.duration}),this.adEvents.updatePlayerDAST(V.J7.ADD_WRAPPER,e.vastOptions.analysis),this.handlerOptions.adParams=e.handlerOptions.adParams,this.handlerOptions.vpaidFiles=e.handlerOptions.vpaidFiles,this.handlerOptions.extra.duration=e.handlerOptions.extra.duration,this.adEvents.trackingPixelManager=this.handlerOptions.trackingPixelManager=e.trackingPixelManager),this._setTimers(),this.config.creatives.AdParameters=this.handlerOptions.adParams,this.handlerOptions.adSettings=this._getAdSettings(),this.adSettings&&this.adSettings.hasOwnProperty("wtfradpsdbfrrsmad")&&!0===this.adSettings.wtfradpsdbfrrsmad&&(this.waitForAdPausedBeforeResumeAd=!0),this.vpaidHandler=this.vpaidHandlersFactory.create(e.type,this.handlerOptions),this.vpaidHandler?(this.type=e.type,this.hasOmid=e.vastOptions&&e.vastOptions.hasOmid,this.omidVendor=e.vastOptions&&e.vastOptions.omidVendor,this.landingPageUrl=e.vastOptions&&e.vastOptions.landingPage,this.store.emit(Me),this.debugTracker.info("ParserResponded[".concat(this.type,"-").concat(this.isMobile?"mob":"desk","]"),this.handlerOptions.vpaidFiles),this._updateAdVideoDurationOnVideoControls(this.handlerOptions.extra.duration),this.type===we.VPAID&&this.adView.removeClickArea(),this._createVideoControls(this.vpaidHandler),function(e){var t=e.store,i=e.tag,r=e.vastOptions,n=void 0===r?{}:r,o=e.type;if(!i.getValueByKey("enblomid")&&!t.get("omid.isActive"))return!1;if(!n.hasOmid)return!1;if(!n.omidElements||0===n.omidElements.length)return!1;if(o===Se.VPAID){var a,s=null===(a=n.analysis)||void 0===a?void 0:a.as;if(!t.getByTech("forceOmidForVpaid",s))return!1}return!Rr(t)}({store:this.store,tag:this.tag,vastOptions:e.vastOptions,type:this.type})&&(this.vpaidHandler.isOMID=!0,this.omidHandler=this.vpaidHandlersFactory.createOMIDHandler(this.handlerOptions)),this.tag.vpaidWrapperData.mediatype=this.vpaidHandler.getMediaType(),1!==this.tag.vpaidWrapperData.mediatype&&6!==this.tag.vpaidWrapperData.mediatype||this.store.get("emitVimpOnMp4AdLoad")&&this.emit(Gl.FIRST_MP4_VIMP),this._extractWinningPrice()):this._onVastHandlerError({type:"handlerCreatingFail",handlerType:e.type,adEvent:V.MH.MEDIA_FILE_NOT_SUPPORTED})}}},{key:"_getAdSettings",value:function(){return this.adSettings=this.store.getByAdInline(this.adEvents.getFromPlayerDAST(V.J7.GET_WRAPPER))||{},this.adElasticLogger.logAdSettings(this.adSettings),this.adSettings}},{key:"_cleanVpaid",value:function(e){var t,i,r,n,o,a;this.clean||this.stayAlive&&this.isReplayable&&e!==Gs.POST_REPEAT||(this.clean=!0,this.adElasticLogger&&this.adElasticLogger.vpaidLog&&(this.adElasticLogger.vpaidLog.saveToDb(),this.adElasticLogger.vpaidLog.getVpaidAnalyticsReport=void 0),null===(t=this.adEvents)||void 0===t||t.destroy(),null===(i=this.adView)||void 0===i||i.destroy(),this._destroyAdTimers(),this._unregisterFromVastHandlerEvents(),this.vastHandler.destroy(),null===(r=this.omidHandler)||void 0===r||r.dispose(),this.status="stopped",this.working=!1,null===(n=this.videoControls)||void 0===n||n.destroy(),null===(o=this.vpaidHandlersFactory)||void 0===o||o.destroy(),null===(a=this.adElasticLogger)||void 0===a||a.destroy(),this.adElasticLogger=this.vastHandler=this.debugTracker=this.adElasticLogger=this.tag=this.adEvents=this.config=this.vpaidHandler=this.store=this._wfStats=this.videoControls=this.adSettings=this.omidHandler=void 0,this.isPlaying=!1,window.setTimeout(this.onAfterStop,0),this.emit(Gl.VPAID_CLEANED))}},{key:"_destroyAdTimers",value:function(){this.adTimers.clearTimer(al.TB_COMPLETION),this.adTimers.clearTimer(al.GLOBAL_TIMEOUT),this._killTimers(),this.adTimers.destroy()}},{key:"bringToFront",value:function(){if(this.adView.placement&&!this.blockBringToFront){var e=this.adView.bringToFront(nl++);this.vpaidHandler&&(this.vpaidHandler.zIndex=e),this._setVideoControlsState({isVisible:!0}),this.toggleIframeContentDisplay("hide")}}},{key:"subscribe",value:function(e,t){this.stopped||ke.A[t]&&this.on(t,e)}},{key:"unsubscribe",value:function(e,t){ke.A&&ke.A[t]&&(e?this.off(t,e):this.off(t))}},{key:"_isDelayedIMATag",value:function(){return this.isIMATag()&&this.store.get("delayAdxLoad")&&!0===this.tag.requiredViewability}},{key:"stop",value:function(e,t,i){var r,n=this;if(!e&&this.hasReachedThirdQuartile&&!this.adCompleted)return this.adElasticLogger.logEarlyAdStopped(),void this._handleVpaidEvents(ke.A.AdVideoComplete,{});if((Object.values(Gs).includes(e)||!this.stayAlive||!this.isReplayable)&&!this.stopped){this.adElasticLogger.logStopReason(e,this.status,i&&i.eventData?(0,m.As)(i.eventData):void 0),this._stopForceAdVolumeInterval(),this._fireUpdatedLurl(e),this.hadImpression||this.adElasticLogger.logAdFailure(this.store.incr("failsCount")),this._wfStats&&(this.hadImpression||this._wfStats.increaseFailure()),this.isStarted&&this.store.decr("ads_started"),this.isPlaying=!1,this.adEvents.onEvent(t,i),"NoMediaFileAfterSort"===e&&t===V.MH.MEDIA_FILE_NOT_SUPPORTED&&this._firePixel(ke.A.AdError,{eventData:{iabErrorCode:Wn.A.mediaFileNotSupported}}),"playerClosed"===e&&this.hadImpression&&this._firePixel(E.A.close),this.stopped=!0,this.vpaidHandler&&(this.vpaidHandler.onAfterStop=this._cleanVpaid.bind(this),this.vpaidHandler.stopAd());var o=null===(r=this.stopwatch)||void 0===r?void 0:r.getElapsedTime();this.store.set("adElapsedDuration",o),this.emit("end",{adElapsedDuration:o}),this.store.emit("vpaidEnded",this),this.emit(Gl.TERMINATE_PPD,this.tag.advType),setTimeout((function(){n._cleanVpaid(e)}),2),e===Gs.GLOBAL_AD_TIMEOUT&&(this.isReplayable=!1)}}},{key:"callVpaidMethod",value:function(e,t,i){if(!this.stopped){if(this.vpaidHandler&&this.vpaidHandler.callIMAApi&&("pauseAd"!=e&&"resumeAd"!=e||this.vpaidHandler.callIMAApi(e)),"setAdVolume"==e&&(this.adVolume=(0,m.ZE)(t[0])),"pauseAd"==e&&this._setIsUnpaused(!1),"resizeAd"==e&&this.adView.resizePlacement(t[0],t[1]),!this.vpaidHandler||!this.vpaidHandler[e])return i;try{return this.vpaidHandler[e].apply(this.vpaidHandler,t)}catch(e){return i}}}},{key:"onAfterStop",value:function(){}},{key:"_fireUpdatedLurl",value:function(e){var t,i=null===(t=this.tag)||void 0===t?void 0:t.lurl,r=Qs[e];if(i&&r){var n=i.replace("${AUCTION_LOSS}",r);(0,m._x)(n)}}},{key:"_hijackAttempt",value:function(e,t){"maliciousUrl"===e?this.hijackFired||(this.hijackFired=!0,this.adElasticLogger.logMaliciousUrl(t),!1!==this.store.get("hjkstp")&&this.stop("hijackAttempt",V.MH.HIJACK_ATTEMPT)):"maliciousAction"===e&&this.adElasticLogger.logMaliciousActions(t.action)}},{key:"_onVpaidResourceEvent",value:function(e){"hijackAttempt"===e.event?this._hijackAttempt(e.data.type,e.data.data):e.event===Gs.UNDEFINED_IFRAME_SRC?(this.adElasticLogger.logUndefinedIframeSource(e.data.url),this.store.get("stpvpdonudfndsrc")&&this.stop(Gs.UNDEFINED_IFRAME_SRC)):"maxNetworkCalls"===e.event&&(this.adElasticLogger.logMaxNetworkCalls(this.adimpFired,e.data.maxNetworkCalls),this.adimpFired||this.stop("networkCallsLimitExceeded",V.MH.MAX_NETWORK_CALLS))}},{key:"_onAdLoadedTimeout",value:function(){this._firePixel(ke.A.AdError,{eventData:{iabErrorCode:Wn.A.timeout}}),this.stop(js,V.MH.AD_LOADED_TIMEOUT)}},{key:"_onAdImpressionTimeout",value:function(){this.adEvents.onEvent(V.MH.AD_IMPRESSION_TIMEOUT),this.stop(Hs)}},{key:"setVastPrice",value:function(e){this.tag.vpaidWrapperData.vastPrice=e,this.adElasticLogger.logVastPrice(e)}},{key:"mute",value:function(){this.stopped||(this.vpaidHandler.video&&this.vpaidHandler.video.muteButtonClicked&&this.adVolume>0&&this.vpaidHandler.video.muteButtonClicked(),this.adVolume=0,this._setVideoControlsState({isMuted:!0}))}},{key:"unmute",value:function(){if(!this.stopped&&(this.vpaidHandler.video&&this.vpaidHandler.video.muteButtonClicked&&0===this.adVolume&&this.vpaidHandler.video.muteButtonClicked(),this.adVolume=(0,m.ZE)(this.store.get("dfltvlm")),this.videoControls)){if(this.store.get("forceMute"))return void(this.adVolume=0);this._setVideoControlsState({isMuted:!1}),this.adVolume=(0,m.ZE)(this.videoControls.getFromState("volume"))}}},{key:"updateStatusesOnGetAd",value:function(e){this.adElasticLogger.logStatusesOnGetAd(this.status,this.hadImpression,this.isStarted,e.requiredViewability)}},{key:"resizeAd",value:function(e,t,i){if(!this.stopped)try{var r=function(e,t,i){if((0,m.Sp)(e)&&(0,m.Sp)(t))return{};if(t&&e)return{width:e,height:t};var r=i.split(":");return e?{width:e,height:(0,m.Ih)(e,r[1]/r[0])}:{height:t,width:(0,m.Ih)(t,r[0]/r[1])}}(e,t,i=i&&i.split(":").length>1?i:this.store.get("playerAspectRatio")),n=r.width,o=r.height;if(!n&&!o)return void this.debugTracker.error("resize","No height and no width specified!");n&&o&&(this.adView.resize(n,o),this.isMultiAdsActive&&(!this.isVerticalVideoSupported||o<n?(this.store.multiSet({width:n.toString(),height:o.toString()}),this.store.emit("resizeVpaidWrapper",{width:n,height:o})):this.isVertical=!0),this.adView.handleVerticalVideo(n,o,i),this.vpaidHandler.resizeAd(n,o,this.config.viewMode||"normal",i)),this.blockBringToFront&&(this.blockBringToFront=!1,this.bringToFront())}catch(e){this.debugTracker.error("resize","Resizing component failed!")}}},{key:"getCurrentVolume",value:function(){return this.videoControls?this.videoControls.getFromState("volume"):this.adVolume}},{key:"_onSoundChange",value:function(e){this.vpaidHandler&&this.vpaidHandler.onMuteChanged&&this.vpaidHandler.onMuteChanged(e)}},{key:"toggleIframeContentDisplay",value:function(e){!this.stopped&&this.isMultiVpaidUnit&&this.store.get("tglifrmcntndsplyactv")&&this.vpaidHandler.toggleIframeContentDisplay&&this.vpaidHandler.toggleIframeContentDisplay(e)}},{key:"_getAdDuration",value:(r=$s(Js().mark((function e(){var t=this;return Js().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.adDuration){e.next=2;break}return e.abrupt("return",this.adDuration);case 2:if(!this.adView.videoTag.duration){e.next=5;break}return this.adDuration=this.adView.videoTag.duration,e.abrupt("return",this.adDuration);case 5:return e.next=7,new Promise((function(e){t.vpaidHandler.getAdDuration((function(i,r){t.adDuration=r,e(t.adDuration)}))}));case 7:return this.adDuration=e.sent,e.abrupt("return",this.adDuration);case 9:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"registerToVPAIDVideoTimeupdateEvent",value:function(){var e=this;if(this.vpaidHandler&&this.vpaidHandler.getVPAIDVideoElement){var t=this.vpaidHandler.getVPAIDVideoElement();null!==t&&t.addEventListener("timeupdate",(function(i){e._onTimeupdate(t)}))}}},{key:"_onTimeupdate",value:function(e){this.workingVpaid&&(0,m.vZ)(e)>0&&this._setVideoControlsState({preventAdTicker:!0,vidDuration:e.duration,vidCurrentTime:(0,m.vZ)(e)})}},{key:"getVpaidStatus",value:function(){return{st:this.vpaidStatus}}},{key:"getPrice",value:function(e){if(this.stopped)return"";var t=this.tag.vpaidWrapperData&&this.tag.vpaidWrapperData.vastPrice?this.tag.vpaidWrapperData.vastPrice:this.tag.price;return t||void 0!==this.store.get("dftgprc")?e?(0,m.wx)(t):t:""}},{key:"_getAdSettingValue",value:function(e){return this.adSettings&&this.adSettings.hasOwnProperty(e)?this.adSettings[e]:void 0}},{key:"_extractWinningPrice",value:function(){if(this._getAdSettingValue("extwnprc")){var e=this._getAdSettingValue("wnprcfld"),t=this.adEvents.trackingPixelManager.extractWinningPrice(e);t.found&&(this.adElasticLogger.logWinningPrice(t),this.adEvents.updatePlayerDAST(V.J7.SET_KEY,{wp:t}))}}},{key:"getVpaidData",value:function(e){var t;if(this.stopped)return{};this.tag.nas&&(this.tag.nas.isClickable=void 0!==this.tag.nas.isClickable?this.tag.nas.isClickable:this._isNativeAdSettingsClickable());var i=this.vpaidHandler.getAdWidth()||this.adEvents.getFromPlayerDAST(lt.V.vastWidth),r=this.vpaidHandler.getAdHeight()||this.adEvents.getFromPlayerDAST(lt.V.vastHeight);return this.clickThruUrl=this.landingPageUrl||this.store.get("defaultLandingPageUrl"),{advId:this.tag.advId,advType:this.tag.advType,backfill:this.tag.priority===this.store.get("bfprty"),brand:this.tag.brand,campaignId:this.tag.campaignId,costModel:this.tag.cstmdl,cpcv:this.tag.isCPCV,creativeId:this.tag.creativeId,dp:this.tag.dp,itemType:this.tag.itemType,lineItem:this.tag.lineItemId,price:this.getPrice(e),pubId:this.tag.pubId,replayable:this.isReplayable,rv:this.tag.requiredViewability,singleAd:this.tag.singleAd,vpaidStatus:this.getVpaidStatus(),wfSequence:this.tag.sequenceId,wfTagId:this.tag.wfIndex,adNativeSettings:ds(null===(t=this.tag)||void 0===t?void 0:t.nas),adWidth:i||0,adHeight:r||0,supportVerticalVideo:this.isVerticalVideoSupported,vastClickThruLink:this.landingPageUrl,eventTrackers:this._getUnitEventTrackers(),supportVideoCurrentTimeEvents:!(!this.vpaidHandler||!this.vpaidHandler.activeVideoElement),duration:this.vpaidHandler&&this.vpaidHandler.activeVideoElement?this.vpaidHandler.getActiveVideoElementDuration():null,earlySrcVPAID:this.earlySrcVPAID,startTimestamp:this.startTimestamp,hip:!!this.tag.hip,allowSlider:!!this.tag.alwsldr}}},{key:"_isNativeAdSettingsClickable",value:function(){var e=this.tag.nas.link||this.landingPageUrl;return void 0!==e&&""!==e}},{key:"_getUnitEventTrackers",value:function(){var e=this,t=this.store.get("untetrk")||[],i={};return t.forEach((function(t){var r=e.adEvents.trackingPixelManager.getPixels(t);r.length>0&&(i[t]=r)})),i}},{key:"skipAd",value:function(){this.stopped||(this.vpaidHandler.skipAd(),this._handleVpaidEvents(ke.A.AdSkipped),this.emit("adSkipped"))}},{key:"getHandlerOptions",value:function(){return this.handlerOptions}},{key:"getVpaidLog",value:function(){return this.adElasticLogger.vpaidLog}},{key:"_setVideoControlsState",value:function(e){!this.stopped&&this.videoControls&&this.videoControls.setState(e)}},{key:"_resetVideoControls",value:function(){this._setVideoControlsState({preventAdTicker:""!==this.getVideoUrl(),isMuted:!0})}},{key:"triggerClick",value:function(){this.tag.nas&&this._handleVpaidEvents(ke.A.AdClickThru,{eventData:{url:this.landingPageUrl,playerHandles:!0}})}},{key:"getLocalTarget",value:function(){return this.adView.placement}},{key:"_firePixel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t.adDuration=1e3*(this.externalPlayerItem?this.getExternalAdDuration():this.adView.videoTag.duration||0),this.adEvents.firePixel(e,t,this._isDelayedImpressionByRVType(),i)}}],t&&el(e.prototype,t),i&&el(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i,r,n}();function yl(e){return yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yl(e)}function ml(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,gl(r.key),r)}}function gl(e){var t=function(e,t){if("object"!=yl(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=yl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==yl(t)?t:t+""}var _l,bl=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.store=t,this.store.set("hasAdxInQueue",!1),this.event="queueStatusChanged",this.backfillPriority=this.store.get("mxbckflldlyitms")?this.store.get("bfprty"):void 0,this.previousQueue=[],this._initQueueStatus()},(t=[{key:"_initQueueStatus",value:function(){this.queueStatus={readyPublisherDemands:0,readyDemands:0,requiredViewabilityCount:0,nonRVCount:0,adxCount:0,adLoadedCount:0,adxCard:!1,size:0,singleAd:!1,items:[],previousQueue:[]}}},{key:"onItemRemovedFromQueue",value:function(e){var t=this._getItemFromQueue(e);t&&(27==e.t&&this.queueStatus.adxCount--,(t=Object.assign({},t)).vw=e.vpaidWrapper?e.vpaidWrapper.getVpaidStatus():{},this.previousQueue.push(Object.assign({},t)))}},{key:"_getItemFromQueue",value:function(e){for(var t=0;t<this.queueStatus.items.length;t++){var i=this.queueStatus.items[t];if(e.wfIndex===i.seq&&parseInt(e.waterfallTagId)===i.wti)return i}return!1}},{key:"onScheduleChange",value:function(e,t){this._initQueueStatus(),this.queueStatus.size=e.length,this.queueStatus.previousQueue=this.previousQueue;for(var i=0;i<e.length;i++){var r=e[i],n=r.vpaidWrapper?r.vpaidWrapper.getVpaidStatus():{};(null==n?void 0:n.st)===ll&&(this.queueStatus.readyDemands++,r.advType===D&&this.queueStatus.readyPublisherDemands++),r.requiredViewability?this.queueStatus.requiredViewabilityCount++:this.queueStatus.nonRVCount++,r.vpaidWrapper.adLoadedFired&&this.queueStatus.adLoadedCount++,27==r.t&&this.queueStatus.adxCount++,r.singleAd&&(this.queueStatus.singleAd=!0),this.queueStatus.items.push(this._getItemStatus(r))}this.setHasAdxInQueue(),this.emit(t)}},{key:"_getItemStatus",value:function(e){return{aid:e.advId,at:e.advType,bf:e.priority===this.backfillPriority,br:e.brand,cmpid:e.campaignId,crid:e.creativeId,cstmdl:e.cstmdl,dp:e.dp,t:e.itemType,li:e.lineItemId,pid:e.pubId,rv:e.requiredViewability,pr:e.vpaidWrapper?e.vpaidWrapper.getPrice(!0):"",sa:e.singleAd,seq:e.wfIndex,wti:parseInt(e.waterfallTagId),vw:e.vpaidWrapper?e.vpaidWrapper.getVpaidStatus():{},mt:e.vpaidWrapper?e.vpaidWrapper.type:"",ves:e.vpaidWrapper?e.vpaidWrapper.earlySrcVPAID:void 0,hip:!!e.hip,alwsldr:1===e.alwsldr}}},{key:"emit",value:function(e){this.store.emit(e||this.event,this.queueStatus)}},{key:"setHasAdxInQueue",value:function(){this.store.set("hasAdxInQueue",this.queueStatus.adxCount>0)}}])&&ml(e.prototype,t),i&&ml(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function Al(e){return Al="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Al(e)}function El(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Tl(r.key),r)}}function Tl(e){var t=function(e,t){if("object"!=Al(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Al(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Al(t)?t:t+""}var kl=function(){return e=function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),!_l){this.costModels={};var i=t.get("cpcvcmpgntps"),r=t.get("cstmdltps");for(var n in r){var o=r[n];this.costModels[o]={costModel:o,type:n,isCPCV:i.indexOf(o)>-1}}_l=this}return _l},(t=[{key:"isCPCV",value:function(e){return this.costModels.hasOwnProperty(e)&&this.costModels[e].isCPCV}}])&&El(e.prototype,t),i&&El(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function wl(e){return wl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wl(e)}function Sl(e,t,i){return(t=Il(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Pl(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Il(r.key),r)}}function Il(e){var t=function(e,t){if("object"!=wl(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=wl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==wl(t)?t:t+""}var Ol="function",Dl="prop",Cl="tag",Vl="object",Rl="adView",Ll="adElasticLogger",Ml="adEvents",xl=function(){return e=function e(t){var i=this;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.interface={},this.vpaidWrapper=t,this.members=[{name:"dontDie",type:Ol},{name:"restartAd",type:Ol},{name:"emit",type:Ol},{name:"getVpaidData",type:Ol},{name:"on",type:Ol},{name:"off",type:Ol},{name:"pauseAd",type:Ol},{name:"resumeAd",type:Ol},{name:"resizeAd",type:Ol},{name:"mute",type:Ol},{name:"unmute",type:Ol},{name:"toggleIframeContentDisplay",type:Ol},{name:"stop",type:Ol},{name:"skipAd",type:Ol},{name:"triggerClick",type:Ol},{name:"isCPCV",type:Dl},{name:"adTarget",type:Rl,viewEl:"placementWrapper"},{name:"hadImpression",type:Dl},{name:"isBf",type:Dl},{name:"hasAdChoices",type:Dl},{name:"type",type:Dl},{name:"localTarget",type:Rl,viewEl:"placement"},{name:"pwov",type:Dl},{name:"clickThruUrl",type:Dl},{name:"adVolume",type:Dl},{name:"isReplayable",type:Dl},{name:"tag",type:Cl},{name:"playerDAST",type:Ml},{name:"vpaidLog",type:Ll}],this.memberConverter=Sl(Sl(Sl(Sl(Sl(Sl(Sl({},Ol,this._convertFunction.bind(this)),Dl,this._convertProp.bind(this)),Cl,this._convertTag.bind(this)),Vl,this._convertObject.bind(this)),Rl,this._convertAdView.bind(this)),Ll,this._convertAdElasticLogger.bind(this)),Ml,this._convertAdEvents.bind(this)),this.vpaidWrapper.once("vpaidCleaned",(function(){i._stop()})),this._appendMembersToInterface(),this.interface},(t=[{key:"_appendMembersToInterface",value:function(){var e=this;this.members.forEach((function(t){e.memberConverter[t.type](t.name,t.viewEl)}))}},{key:"_convertFunction",value:function(e){this.interface[e]=this.vpaidWrapper[e].bind(this.vpaidWrapper)}},{key:"_convertProp",value:function(e){var t=this;Object.defineProperty(this.interface,e,{get:function(){if(!t.stopped)return t.vpaidWrapper[e]}})}},{key:"_convertTag",value:function(e){var t=this;Object.defineProperty(this.interface,e,{get:function(){if(!t.stopped)return Object.assign(t.vpaidWrapper[e],t.vpaidWrapper[e].vpaidWrapperData)}})}},{key:"_convertObject",value:function(e){this.interface[e]=this.vpaidWrapper[e]}},{key:"_convertAdView",value:function(e,t){this.interface[e]=this.vpaidWrapper.adView[t]}},{key:"_convertAdElasticLogger",value:function(e){this.interface[e]=this.vpaidWrapper.adElasticLogger[e]}},{key:"_convertAdEvents",value:function(e){this.interface[e]=this.vpaidWrapper.adEvents[e]}},{key:"_stop",value:function(){this.stopped=!0,this.vpaidWrapper=this.members=this.memberConverter=this.interface=void 0}}])&&Pl(e.prototype,t),i&&Pl(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function Fl(e){return Fl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fl(e)}function Nl(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=function(e,t){if(e){if("string"==typeof e)return Bl(e,t);var i={}.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Bl(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,n=function(){};return{s:n,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}function Bl(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function Ul(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Wl(r.key),r)}}function Wl(e){var t=function(e,t){if("object"!=Fl(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Fl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Fl(t)?t:t+""}var jl="pagehide",Hl="beforeunload",Gl={VPAID_CLEANED:"vpaidCleaned",CLEAR_GET_AD_TIMEOUT:"clearGetAdTimeout",TRIGGER_EVENT:"triggerEvent",TERMINATE_PPD:"terminatePPD",QUEUE_CHANGE:"queueChange",FIRST_MP4_VIMP:"firstMp4Vimp"},ql=function(){return e=function e(t){var i,r,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i=this,n=function(e){return e.t===C.l.ITEM_TYPES.IMA},(r=Wl(r="_isIMATag"))in i?Object.defineProperty(i,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[r]=n,(0,j.mixin)(this),this.store=t.store,this.config=t.config,this.options=t.options,this.target=t.target,this.time=(new Date).getTime(),this.sequenceId=((new Date).getTime()+"").substring(3,11),this.stopped=!1,this.started=!1,this.schedule=[],this.delayedAdsSchedule=[],this.playingQueue=[],this.timedTimeout=0,this.waterfall={},this.adSlots=1,this.adIsPlaying=!1,this.shouldBlockRv1Ads=!1,this.debugTracker=new y.A("Manager"),this.droppableTypes=this.store.get("drpbletps")||[],this.shouldFirePpdFlowPixel=(0,m.ri)(this.store.get("frppdfpxl")),this.queueSize=this.store.get("queue_size")||10,this.shouldCleanAdOnImpression=this.store.get("cleanAdOnImp"),this.store.on("stop",this.stop.bind(this)),this.store.on(Me,this._emitQueueStatus.bind(this,"queueStatus")),this.store.on("navigatorConnectionChange",this._onNavigatorConnectionChange.bind(this)),this._onNavigatorConnectionChange(),this.queueStatus=new bl(this.store),this.dontTrimMp4=this.store.get("novdtrm"),this.maxBackfillDelayItems=this.store.get("mxbckflldlyitms"),this.maxBackfillDelayItems&&(this.backfilldelayTime=this.store.get("bckflldlyms"),this.backfillPriority=this.store.get("bfprty")),this.continueGetAdFlow=this.store.get("cntgtad"),this.immediateStartDelayLoadAdProperties=this.store.get("startImmediateDelayLoad")||{},this._registerToUnloadEvent()},t=[{key:"_createDelayedVpaidWrapper",value:function(e){var t,i=this;(t=e.predictId===C.l.PREDICTORS.ADX?this.delayedAdsSchedule.find((function(e){return i._isIMATag(e.item)})):this.delayedAdsSchedule.find((function(t){return i._isAdPropertiesMatch(e.adProperties,t.item,!0)})))&&(this._createVpaidWrapper(t.item,t.tagId,e),this.delayedAdsSchedule=this.delayedAdsSchedule.filter((function(e){return e.tagId!==t.tagId})))}},{key:"_trigger",value:function(e,t,i){if(this._handleAllEvents({type:e,dispatcher:t}),this.store.emit(e,t),t.working||e===ke.A.AdImpression){var r={type:e,dispatcher:t};e===ke.A.AdImpression&&(r.tag=t.tag,this._moveItemFromInitialQueueToPlayingQueue(r.tag,t)),e===ke.A.AdVideoComplete&&(r.tag=t.tag,this._removeItemFromPlayingQueue(r.tag)),r.vpaidReady=this.getVpaidReadyCount(),r.qsize=this.schedule.length,r.dp=t&&t.tag?t.tag.dp:"na",r.clickThru={url:i?i.url:"",playerHandles:i&&!1!==i.playerHandles},this.emit(e,r)}}},{key:"getVpaidReadyCount",value:function(){var e=0;return this.schedule.map((function(t){t&&t.vpaidWrapper&&"ready"===t.vpaidWrapper.status&&e++})),e}},{key:"getVpaidReadyImpressionCount",value:function(){var e=0;return this.schedule.map((function(t){t&&t.vpaidWrapper&&t.vpaidWrapper.hadImpression&&e++})),e}},{key:"_subscribeToVpaidWrapper",value:function(e){this.stopped||(e.on(Gl.VPAID_CLEANED,this._onVpaidCleaned.bind(this,e)),e.on(Gl.CLEAR_GET_AD_TIMEOUT,this._cleanGetAdTimeout.bind(this)),e.on(Gl.TRIGGER_EVENT,this._trigger.bind(this)),e.on(Gl.TERMINATE_PPD,this._terminatePPDFlow.bind(this)),e.on(Gl.QUEUE_CHANGE,this._emitQueueStatus.bind(this)),e.subscribe(this._handleError.bind(this),ke.A.AdError),e.on(ke.A.AdImpression,this._onAdImpression.bind(this)),e.on(Gl.FIRST_MP4_VIMP,this._onAdImpression.bind(this)))}},{key:"_onAdImpression",value:function(){this.hadFirstImpression||(this.hadFirstImpression=!0,this.store.emit("FirstAdImpression"))}},{key:"_handleAllEvents",value:function(e){var t=this,i=this.store.get("max_ready_vpaid")||2;if(e.type!==ke.A.AdVideoStart&&e.type!==ke.A.AdImpression&&e.type!==ke.A.AdPlaying||!e.dispatcher.isPlaying||this._trigger("viewAdPlayer",e.dispatcher.tag),e.type===ke.A.AdLoaded&&this.shouldPlayWhenAvialable&&!this.store.get("evtbsschdl")&&(setTimeout((function(){t.playFromQueue(t.shouldPlayWhenAvialable,t.options||{})}),2),this.shouldPlayWhenAvialable=!1),e.type===ke.A.AdImpression){this.getVpaidReadyImpressionCount()>=i&&(0,m.ri)(parseInt(this.store.get("frdmrvhpxls")))&&(0,m.jr)((0,m.TF)(E.A.maxReadyVpaidHit,this.store));var r=!0;e.dispatcher.options&&e.dispatcher.options.getAdContext&&(r=!1,e.dispatcher.gotAd=!0,this.debugTracker.info("gotAd",e.dispatcher,{color:"#5EB9FF"}),e.dispatcher.options.getAdContext.getAdCallback(new xl(e.dispatcher))),(0,m.Hj)(e.dispatcher.vpaidLog,"getAdContexIsEmpty",{empty:r})}}},{key:"_handleError",value:function(e){var t=e.dispatcher;this.adIsPlaying&&t&&t.isStarted&&!t.hadImpression&&!this.store.get("evtbsschdl")&&this.playFromQueue(this.shouldPlayWhenAvialable,t.options||{})}},{key:"_isAdvDelayLoad",value:function(e){return!!e.requiredViewability&&!!Object.keys(this.immediateStartDelayLoadAdProperties).length&&this._isAdPropertiesMatch(this.immediateStartDelayLoadAdProperties,e,!0)}},{key:"_shouldDelayIMATag",value:function(e){return this._isIMATag(e)&&this.store.get("delayAdxLoad")&&!0===e.requiredViewability}},{key:"initVpaidInQue",value:function(){if(!this.stopped)for(var e=0;e<this.schedule.length;e++){var t=this.schedule[e],i="".concat(e,"-").concat(t.waterfallTagId);t.vpaidWrapper||(this._shouldDelayIMATag(t)||this._isAdvDelayLoad(t)?(t.adEvents.onEvent(V.MH.DELAYED_ITEM_BY_TYPE),this.store.emit("delayedItem"),this.delayedAdsSchedule.push({item:t,tagId:i})):this.maxBackfillDelayItems&&t.priority===this.backfillPriority?(t.adEvents.onEvent(V.MH.DELAYED_ITEM_BY_BACKFILL),t.backfillDelay=setTimeout(this._createVpaidWrapper.bind(this,t,i),this.backfilldelayTime)):this._createVpaidWrapper(t,i))}}},{key:"_createVpaidWrapper",value:function(e,t,i){this._setBackfillDelay(e),e.sequenceId=e.wfIndex,e.adEvents.onEvent(V.MH.CREATE_VPAID_WRAPPER),e.vpaidWrapper=new vl({tag:e,config:this.config,tagid:t,target:this.target,store:this.store,options:i,isAdvDelayLoad:this._isAdvDelayLoad(e)}),e.vpaidWrapper&&this._subscribeToVpaidWrapper(e.vpaidWrapper)}},{key:"_setBackfillDelay",value:function(e){e.backfillDelay&&(e.backfillDelay=window.clearTimeout(e.backfillDelay),e.isBackfillDelayed=!0)}},{key:"_updateCostModel",value:function(e){var t=new kl(this.store),i=e.getValueByKey("cstmdl");void 0===i&&(i=e.cstmdl),e.cstmdl=i,e.isCPCV=t.isCPCV(e.cstmdl)}},{key:"_onVpaidCleaned",value:function(e){this.cleanQueue(this.queueSize),this.continueGetAdFlow&&e.options&&e.adStarted&&!e.hadImpression&&this.getAdFromQueue(e.options),this.queueStatus.onScheduleChange(this.schedule)}},{key:"unsubscribeFromVpaid",value:function(e){!this.stopped&&e&&Object.values(ke.A).forEach((function(t){e.unsubscribe(null,t)}))}},{key:"_shouldDropAd",value:function(e,t){return this.droppableTypes.indexOf(e)>-1&&this._isItemOfType(t,e)}},{key:"_isItemOfType",value:function(e,t){return e.hasOwnProperty(t)&&e[t]}},{key:"_isPPDPreventingCleanup",value:function(){return this.store.get("isPPD")}},{key:"cleanQueue",value:function(e,t){var i=this;if(!this._isPPDPreventingCleanup()){if(this.schedule.map((function(e,r){if(e&&e.vpaidWrapper&&!e.vpaidWrapper.working){var n,o=!1;"error"===e.vpaidWrapper.status||"stopped"===e.vpaidWrapper.status?(o=!0,n="error"===e.vpaidWrapper.status?V.MH.VAST_ERROR:ke.A.AdError):t&&i._shouldDropAd(t,e)&&!e.vpaidWrapper.hadImpression&&(o=!0,n=V.MH.AD_DROPPED),o&&(i.queueStatus.onItemRemovedFromQueue(e),e.vpaidWrapper._status=e.vpaidWrapper.status,i.unsubscribeFromVpaid(i.schedule[r].vpaidWrapper),i.schedule[r].vpaidWrapper.stop("cleanExpierd",n),i.schedule[r]&&(i.schedule[r].vpaidWrapper=null),i.schedule[r]=void 0)}})),this.schedule=this.schedule.filter((function(e){return e})),this.schedule=Ie(this.schedule,this.store),this.schedule.length>e){var r=this.config.creatives.ADTO||this.store.get("expirationTime")||C.l.EXPIRATION_TIME,n=this.store.get("trmrdyvpaid");this.schedule.map((function(t,o){if(i.schedule[o]&&!t.vpaidWrapper.working&&(n||"ready"!==t.vpaidWrapper.status)){var a=Date.now()-i.schedule[o].vpaidWrapper.created;if(t&&(o<i.schedule.length-e||a>r)){var s,l,d,u;if(i.queueStatus.onItemRemovedFromQueue(t),i.unsubscribeFromVpaid(i.schedule[o].vpaidWrapper),a>r?(d="queueExpired",u=V.MH.QUEUE_EXPIRED):(d="queueTrimmed",u=V.MH.QUEUE_TRIMMED),!i._canTrim(d,t))return;null===(s=(l=i.schedule[o].vpaidWrapper).stop)||void 0===s||s.call(l,d,u),i.schedule[o]=void 0}}}))}this.schedule=this.schedule.filter((function(e){return e}))}}},{key:"_moveItemFromInitialQueueToPlayingQueue",value:function(e,t){if(this.shouldCleanAdOnImpression){var i=this._getIndexFromArray(this.schedule,e.lineItemId);this.queueStatus.onItemRemovedFromQueue(e),i>-1&&this.schedule.splice(i,1),this.playingQueue.push(t)}}},{key:"_removeItemFromPlayingQueue",value:function(e){if(this.shouldCleanAdOnImpression){var t=this._getIndexFromArray(this.playingQueue,e.lineItemId);t>-1&&this.playingQueue.splice(t,1)}}},{key:"_getIndexFromArray",value:function(e,t){return e.findIndex((function(e){var i;return(e.lineItemId||(null===(i=e.tag)||void 0===i?void 0:i.lineItemId))===t}))}},{key:"_canTrim",value:function(e,t){return"queueTrimmed"!==e||!(t.vpaidWrapper&&"mp4"===t.vpaidWrapper.type&&this.dontTrimMp4)}},{key:"_setPPDpriorityIfPPD",value:function(e){e.advType===D&&this.store.set("isPPD",!0)}},{key:"_terminatePPDFlow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(this.store.get("isPPD")&&e===D||t)&&this.store.set("isPPD",!1)}},{key:"_clientPreferPPD",value:function(e){return e&&this.store.get("isPPD")}},{key:"_reportQueueSizeHit",value:function(){(0,m.ri)(parseInt(this.store.get("frdqshpxls")))&&(0,m.jr)((0,m.TF)(E.A.queueSizeHit,this.store))}},{key:"fillSchedule",value:function(e){this.schedule.length>this.queueSize&&(this.cleanQueue(this.queueSize),this._reportQueueSizeHit()),this.started=!0,this.stopped=!1;var t=this.config.creatives;t.ADTO=parseInt(t.ADTO)>1?parseInt(t.ADTO):60,t.ADTO=t.ADTO<1e3?1e3*t.ADTO:t.ADTO,this.adSlots=parseInt(t.B2B)&&parseInt(t.B2B)>1?parseInt(t.B2B):1;for(var i=t.DEFAULTTAGTIMEOUT<1e3?1e3*t.DEFAULTTAGTIMEOUT:t.DEFAULTTAGTIMEOUT,r=0;r<e.tags.length;r++)if(this._setPPDpriorityIfPPD(e.tags[r]),this._shouldInsertToQueue(e.tags[r])){var n=e.tags[r];n.active=!1,n.offset=0,n.tagStart=0,n.tagTimeout=i,n.queueNumber=0,n.ADTO=t.ADTO,n.vpaidWrapper=!1,n.tagEnd=1*n.tagStart+1*n.tagTimeout,n.wfStats=e.data,Oe(n,this.store),this._updateCostModel(n),this.store.get("frstlk")&&this._updateItemFirstLook(n),this.schedule.push(n)}this.time=(new Date).getTime(),this.initVpaidInQue(),this.store.multiSet({queueLength:this.schedule.length,vpaidReadyCount:this.getVpaidReadyCount()}),this.queueStatus.onScheduleChange(this.schedule)}},{key:"_shouldInsertToQueue",value:function(e){return this.maxBackfillDelayItems&&e.priority===this.backfillPriority&&this._getBackfillCount()>=this.maxBackfillDelayItems?(e.adEvents.onEvent(V.MH.DROPPED_ON_BACKFILL_DELAY),!1):!this.shouldBlockRv1Ads||!e.requiredViewability||(e.adEvents.onEvent(V.MH.DROPPED_BY_LOW_DOWNLINK),!1)}},{key:"_updateItemFirstLook",value:function(e){e.flad&&(this.store.get("first_look_ad_loaded")?(e.flad_delay=e.flad,delete e.flad):this._startFladTimeout(e.flad))}},{key:"_startFladTimeout",value:function(e){this.store.set("first_look_ad_loaded",e),this.fladTimeout=setTimeout(this._onFladTimeout.bind(this),1e3*e)}},{key:"_onFladTimeout",value:function(){for(var e=0;e<this.schedule.length;e++){var t=this.schedule[e];if(t.flad_delay)return t.flad=t.flad_delay,delete t.flad_delay,void this._startFladTimeout(t.flad)}this.store.set("first_look_ad_loaded",!1),this.store.emit("fladInactive")}},{key:"stop",value:function(){if(!this.stopped){this.stopped=!0,window.clearTimeout(this.timedTimeout);for(var e=0;e<this.schedule.length;e++){var t,i;this.schedule[e].backfillDelay?window.clearTimeout(this.schedule[e].backfillDelay):null===(t=(i=this.schedule[e].vpaidWrapper).stop)||void 0===t||t.call(i,"playerClosed",V.MH.PLAYER_CLOSED)}this._unregisterFromUnloadEvent()}}},{key:"playFromQueue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.store.get("isIdleMode")&&!this.stopped){var i=Date.now();this.store.set("playFromQueue",i);var r=this.getVpaidReadyCount();this.store.get("first_look")||this.store.get("first_look_ad_loaded")||(this.schedule=Ie(this.schedule,this.store)),this.config.creatives.ADTO;for(var n=!1,o=this._getItemScores(),a=this.schedule.length-1;a>=0;a--){var s=this.schedule[a];s&&(this._setItemScores(s,a,o),"ready"!==s.vpaidWrapper.status||s.vpaidWrapper.working||s.vpaidWrapper.isStarted||n||this.store.get("first_look_ad_loaded")&&!s.flad||(s.vpaidWrapper.workingVpaid=!0,this.store.multiSet({playFromQueueFound:i,ad_controls:!1!==s.getValueByKey("ad_controls")}),s.vpaidWrapper.working=!0,s.vpaidWrapper.isPlaying=!0,this.adIsPlaying=!0,n=!0,s.vpaidWrapper.startAd(t),(0,m.Hj)(s.vpaidWrapper.vpaidLog,"startFromQ",{score:s.score})))}this.store.get("run_wf_when_empty")&&0===r&&this.store.emit("playFromEmptyQueue")}}},{key:"bringVpaidToFront",value:function(){if(this.shouldCleanAdOnImpression)this.playingQueue.length>0&&this.playingQueue[0].bringToFront();else for(var e=this.schedule.length-1;e>=0;e--){var t=this.schedule[e];if(t&&t.vpaidWrapper.workingVpaid){t.vpaidWrapper.bringToFront();break}}}},{key:"_getItemScores",value:function(){for(var e=[],t=this.schedule.length-1;t>=0;t--){var i=this.schedule[t];i&&e.push(i.score)}return e}},{key:"_setItemScores",value:function(e,t,i){e.vpaidWrapper&&e.vpaidWrapper.vpaidLog&&e.vpaidWrapper.vpaidLog.data&&(e.vpaidWrapper.vpaidLog.data.itemScore=e.score,i&&(0,m.Hj)(e.vpaidWrapper.vpaidLog,"itemScores",{index:t,scores:i},!1,!1))}},{key:"resizeAd",value:function(e,t,i){if(!this.stopped){if(this.config.creatives.PLAYER_WIDTH=this.config.width=parseInt(e),this.config.creatives.PLAYER_HEIGHT=this.config.height=parseInt(t),this.config.creatives.VIEW_MODE=this.config.viewMode=i,this.shouldCleanAdOnImpression){var r,n=Nl(this.playingQueue);try{for(n.s();!(r=n.n()).done;)r.value.callVpaidMethod("resizeAd",[e,t,i],0)}catch(e){n.e(e)}finally{n.f()}}for(var o=0;o<this.schedule.length;o++)this.schedule[o].vpaidWrapper&&!this.schedule[o].vpaidWrapper.stopped&&this.schedule[o].vpaidWrapper.callVpaidMethod("resizeAd",[e,t,i],0)}}},{key:"setAdVolume",value:function(e,t){if(!this.stopped){if(e=e>1?e/100:e,isNaN(parseFloat(e)))return!1;if(e=parseFloat(e),t||(this.config.creatives.VOLUME=e),this.config.creatives.MUTED=0==e,this.shouldCleanAdOnImpression){var i,r=Nl(this.playingQueue);try{for(r.s();!(i=r.n()).done;)i.value.setAdVolume(e)}catch(e){r.e(e)}finally{r.f()}}else for(var n=0;n<this.schedule.length;n++)this.schedule[n].vpaidWrapper&&!this.schedule[n].vpaidWrapper.stopped&&this.schedule[n].vpaidWrapper.workingVpaid&&this.schedule[n].vpaidWrapper.setAdVolume(e)}}},{key:"callWorkingVpaid",value:function(e,t,i){if(!this.stopped)if(this.shouldCleanAdOnImpression){var r,n=Nl(this.playingQueue);try{for(n.s();!(r=n.n()).done;)return r.value.callVpaidMethod(e,t,i)}catch(e){n.e(e)}finally{n.f()}}else for(var o=0;o<this.schedule.length;o++){var a=this.schedule[o].vpaidWrapper;if(a&&a.workingVpaid)return a.callVpaidMethod(e,t,i)}}},{key:"getAd",value:function(e){var t=this;this.store.incr("getAdData.count");var i=this;this.debugTracker.info("getAd",e||"empty getAd",{color:"#5EB9FF"}),this.store.set("ppdAdImpressionTimeoutInMS",e.ppdAdImpressionTimeout);var r=new Promise((function(t,r){var n={getAdCallback:t};(e=e||{}).id=(new Date).getTime(),e.getAdContext=n,e.getAdRetries=0,e.getAdContext.getAdTimeout=setTimeout((function(){i.cancelGetAd(e),e.getAdContext=void 0,r({name:"error",message:"couldn't find a suitable ad to play"})}),1e3*(e.getAdTimeout||i.store.get("get_ad_timeout_seconds"))),i.getAdFromQueue(e)}));return r.cancel=function(i){t.cancelGetAd(e,i),t.debugTracker.info("getAd","getAd cancelled!",{color:"#5EB9FF"})},r}},{key:"cancelGetAd",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.store.decr("getAdData.count"),this._cleanGetAdTimeout(e),e.getAdContext=void 0;var i=this.schedule.find((function(t){return t.vpaidWrapper.getAdId===e.id}));!i||i.vpaidWrapper.stopped||i.vpaidWrapper.hadImpression||i.vpaidWrapper.stop(t)}},{key:"_cleanGetAdTimeout",value:function(e){e.getAdContext&&e.getAdContext.getAdTimeout&&(clearTimeout(e.getAdContext.getAdTimeout),e.getAdContext.getAdTimeout=void 0)}},{key:"_skipItemByPublisherPriority",value:function(e,t){return!(t&&e.advType===D||!t||e.advType===D)}},{key:"getAdFromQueue",value:function(e){if(!this.store.get("isIdleMode")&&!this.stopped&&(e=e||{})&&e.getAdContext&&(!e.requiredViewability||!document.hidden))if(e.predictId===C.l.PREDICTORS.ADX&&this.store.get("delayAdxLoad")||e.predictId===C.l.PREDICTORS.IMMEDIATE_START)this._createDelayedVpaidWrapper(e);else{this.store.get("first_look")||this.store.get("first_look_ad_loaded")||(this.schedule=Ie(this.schedule,this.store));for(var t=!1,i=this._getItemScores(),r=this._clientPreferPPD(e.preferPPD),n=this.schedule.length-1;n>=0;n--){var o=this.schedule[n];if(this._updateStatusesOnGetAd(o,e),this._setItemScores(o,n,i),this._reportIfADXExclude(o,e),this.isViewabilityMatch(o,e)&&this.checkAdProperties(o,e.adProperties,e.excAdProperties)&&!this._skipItemByPublisherPriority(o,r)&&!this._isViolateImmediateStartPredictorConditions(o)&&this._canPullItem(o)){this._pullItemFromQueue(o,e),t=!0;break}}this.store.get("run_wf_when_empty")&&0==this.getVpaidReadyCount()&&(this.store.emit("playFromEmptyQueue",e.forceWf),e.forceWf=!1),t||(this.nextAdFromQueue=setTimeout(this.getAdFromQueue.bind(this,e),1e3))}}},{key:"_isViolateImmediateStartPredictorConditions",value:function(e){var t;if(!this.store.get("isImmediateStartPredictorEnabled"))return!1;var i=null===(t=this.immediateStartDelayLoadAdProperties)||void 0===t?void 0:t.advId;return!(!i||!i.includes(e.advId))}},{key:"_reportIfADXExclude",value:function(e,t){var i,r,n=this,o=t.excAdProperties,a=t.extraOptions,s=e.vpaidWrapper;(null===(i=s.isIMATag)||void 0===i?void 0:i.call(s))&&(null==a?void 0:a.adxPubVideoPreventing)&&n._isAdPropertiesMatch(o,e,!0)&&(null===(r=e.vpaidWrapper.adEvents)||void 0===r||r.onEvent(V.MH.PUB_VIDEO_PREVENTING))}},{key:"_canPullItem",value:function(e){return"ready"===e.vpaidWrapper.status&&!e.vpaidWrapper.working&&!e.vpaidWrapper.isStarted&&(!this.store.get("first_look_ad_loaded")||e.flad)}},{key:"_pullItemFromQueue",value:function(e,t){e.vpaidWrapper.working=!0,e.vpaidWrapper.isPlaying=!0,this.adIsPlaying=!0,e.vpaidWrapper.bringToFront(),"mp4"===e.vpaidWrapper.type&&e.vpaidWrapper.vpaidHandler.logVideoBuffer("StartFromQ"),this._clientPreferPPD(t.preferPPD)&&e.advType===D&&this._sendPpdPixel(),e.vpaidWrapper.startAd(t),(0,m.Hj)(e.vpaidWrapper.vpaidLog,"startFromQ",{score:e.score,adx:e.adx}),t.getAdRetries++}},{key:"_updateStatusesOnGetAd",value:function(e,t){e.vpaidWrapper&&e.vpaidWrapper.adElasticLogger&&!e.vpaidWrapper.gotAd&&e.vpaidWrapper.updateStatusesOnGetAd(t)}},{key:"isViewabilityMatch",value:function(e,t){return!(!e||!e.vpaidWrapper)&&(void 0===t.requiredViewability||(t.requiredViewability?e.requiredViewability:!e.requiredViewability))}},{key:"checkAdProperties",value:function(e,t,i){return this._isAdPropertiesMatch(t,e,!0)&&this._isAdPropertiesMatch(i,e,!1)}},{key:"_isAdPropertiesMatch",value:function(e,t,i){if(e)for(var r in e){var n=this._isPropertyMatch(r,e[r],t);if(n&&!i||!n&&i)return!1}return!0}},{key:"_isPropertyMatch",value:function(e,t,i){for(var r=0;r<t.length;r++)if((0,m.Em)(i,e)==t[r])return!0;return!1}},{key:"callAllWorkingVpaids",value:function(e){if(!this.shouldCleanAdOnImpression)return this.schedule.map((function(t){if(t.vpaidWrapper&&!t.vpaidWrapper.stopped&&t.vpaidWrapper.workingVpaid)return e(t.vpaidWrapper)}));var t,i=Nl(this.playingQueue);try{for(i.s();!(t=i.n()).done;){var r=t.value;return e(r)}}catch(e){i.e(e)}finally{i.f()}}},{key:"play",value:function(){this.callAllWorkingVpaids((function(e){return e.resumeAd()}))}},{key:"pause",value:function(){this.callAllWorkingVpaids((function(e){return e.pauseAd()}))}},{key:"_emitQueueStatus",value:function(e){this.queueStatus.onScheduleChange(this.schedule,e)}},{key:"_getBackfillCount",value:function(){var e=this,t=0;return this.schedule.map((function(i){i&&i.priority===e.backfillPriority&&t++})),t}},{key:"_onNavigatorConnectionChange",value:function(){var e=this.store.get("navigatorConnection")||{},t=this.store.get("rmvrvlwntwrk"),i=this.store.get("dwnlnktrshld"),r=e.downlink;i&&t&&void 0!==r&&(r<i?(this.shouldBlockRv1Ads=!0,this._removeRv1AdsFromQueue()):this.shouldBlockRv1Ads=!1)}},{key:"_removeRv1AdsFromQueue",value:function(){this.schedule=this.schedule.filter((function(e){return!e.requiredViewability}))}},{key:"getClickedAd",value:function(){var e;return this.callAllWorkingVpaids((function(t){t.isClicked&&(e=t)})),e}},{key:"reportQueueStatus",value:function(){this.queueStatus&&this.queueStatus.emit(Me)}},{key:"_sendPpdPixel",value:function(){this.shouldFirePpdFlowPixel&&(0,m.jr)((0,m.TF)(E.A.ppdAdIsPlaying,this.store))}},{key:"_isMobileiOS",value:function(){return this.store.get("isMobile")&&this.store.get("wurfl.os.name")===me}},{key:"_registerToUnloadEvent",value:function(){this.unloadEvent=this._isMobileiOS()?jl:Hl,this.unloadCallback=this._onPageUnload.bind(this),window.addEventListener(this.unloadEvent,this.unloadCallback)}},{key:"_onPageUnload",value:function(){var e,t,i=Nl(this.schedule.concat(this.playingQueue).concat(this.delayedAdsSchedule));try{for(i.s();!(t=i.n()).done;){var r,n=t.value;null===(r=(n.vpaidWrapper||n).adEvents)||void 0===r||r.onEvent(V.MH.UNLOAD_PAGE)}}catch(e){i.e(e)}finally{i.f()}null===(e=this.options)||void 0===e||null===(e=e.oppsula)||void 0===e||e.destroy()}},{key:"_unregisterFromUnloadEvent",value:function(){this.unloadEvent&&this.unloadCallback&&window.removeEventListener(this.unloadEvent,this.unloadCallback)}}],t&&Ul(e.prototype,t),i&&Ul(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();const zl={WF_PARAMS:{VIEW_MODE:"normal",REFERRER:"",VIDEO_URL:"",DOMAIN:"",PUBID:0,TAGID:0,VPD:0,VPTD:0,AUC_DAST:"",VIDLENGTH:0,KEY_WORDS:"",DESCRIPTION:"",SERVICE:"WhiteLabelBidRequestHandlerServlet",VERTICAL:"",SCHEMA:"vast2-vpaid",TYPE:"application/javascript",PV:"17.8.7",RS:1,ST:1,WP:1,PT:5,CIRF:"",SDID:1,STS:0,CB:"",VOLUME:0,TAG:"",PAGE_URL:function(){var e=window;window.TRC&&window.TRC.isAMP&&(e=window.context);var t=e.location?e.location.href:"";return encodeURIComponent(t)}(),TIME_STAMP:"",TITLE:"",ISVIDEO:1,PLMD:2,MINDUR:1,MAXDUR:60,MINBR:1,MAXBR:512,AFBP:!1,ADTO:60,B2B:1,VMT:0,SORTORDERTYPE:0,DEFAULTTAGTIMEOUT:30,OID:"",NOAOP:"",CM_DOMAIN:"http://exchange.basebanner.com",OFFSET:0,MODE:"paralel",MUTED:!1,DEBUG:!1,PAUSE_ON_START:!1,PLAYER_WIDTH:0,PLAYER_HEIGHT:0},CONFIG:{waterfall:{},source:"",videoSlotCanAutoPlay:!0,videoSlotControls:!1,vpaid_protect_path:!1,running:!1,inited:!1,stopped:!1,started:!1,target:!1,video:!1,bitrate:512,creatives:{},protectedCreatives:["WP","PV","PT","SDID","CM_DOMAIN","SERVICE"]}};function Ql(e){return Ql="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ql(e)}function Kl(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Yl(r.key),r)}}function Yl(e){var t=function(e,t){if("object"!=Ql(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Ql(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ql(t)?t:t+""}var Xl=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(0,j.mixin)(this),this.options=t.options,this.store=t.store,this.target=t.target,this.video=t.video,this.stopped=!1,this.isMultiVpaidUnit=this.store.get("isMultiVpaidUnit"),this.playWithoutContainer=this.store.get("noplrcntr"),this.isMobile=this.store.get("isMobile"),this.viewmode="normal",this.adPlaying=!1,this.isAdPlayerVisible=!1,this.paused=!1,this._createDebugTracker(),this._normalizeAdParams(),this._createVideoPlayer(),this._init()},t=[{key:"_createDebugTracker",value:function(){this.debugTracker=new y.A("ComponentsManager")}},{key:"_normalizeAdParams",value:function(){this.options.vpaidTag=Object.assign({},this.options.tagDefault,this.options.vpaidTag),this.options.vpaidTag.adto=this.options.vpaidTag.ad_timeout,this.options.vpaidTag["player-width"]=this.video.offsetWidth||this.video.width,this.options.vpaidTag["player-height"]=this.video.offsetHeight||this.video.height,this.options.vpaidTag["video-url"]=this.video.name,this.options.vpaidTag.vidlength=parseInt(this.video.duration),this.options.vpaidTag.sts=0,this.options.vpaidTag["vpaid-version"]=this.options.vpaidTag.vpaid_version,this.options.vpaidTag["auc-dast"]=this.options.vpaidTag.auc_dast,this.options.vpaidTag.plmd=this._getPlayMode()}},{key:"_getPlayMode",value:function(){return this.options.vpaidTag.use_as_is?2:0===this.options.vpaidTag.plmd?this.options.vpaidTag.muted?2:1:this.options.vpaidTag.plmd}},{key:"_createVideoPlayer",value:function(){this.playWithoutContainer||(this.videoWrapper=document.createElement("div"),this.videoWrapper.className="".concat(this.target.className," vpaid-handler"),this.videoWrapper.id="0_".concat(this.target.id),this.videoWrapper.style.cssText="".concat(this.target.style.cssText,";position:absolute;top:0;left:0;border:0; z-index:0"),this._registerVideoWrapperEvents(),this.target.appendChild(this.videoWrapper)),this.options.vpaidTag.mute=this.options.vpaidTag.mute||this.options.mute,this.options.height=(0,m.Xg)(this.store.get("height")),this.options.width=(0,m.Xg)(this.store.get("width"))}},{key:"_registerVideoWrapperEvents",value:function(){this.store.get("contentClickUrl")&&!this.playWithoutContainer&&this.videoWrapper.addEventListener("click",this._onVideoWrapperClickEvent.bind(this))}},{key:"_onVideoWrapperClickEvent",value:function(e){e.stopPropagation()}},{key:"_init",value:function(){this._initializeConfig(),this._registerEvents(),this._setOppsulaInstance(),this._createWaterfallManager(),this._onWaterfallManagerCreated()}},{key:"_initializeConfig",value:function(){this.config=zl.CONFIG;var e=this._convertConfigToUpperCase();this.config.creatives=Object.assign({},zl.WF_PARAMS,e)}},{key:"_convertConfigToUpperCase",value:function(){var e={};for(var t in this.options.vpaidTag)e[t.toUpperCase()]=this.options.vpaidTag[t];return e}},{key:"_registerEvents",value:function(){this.store.get("mltads")&&this.store.on("resizeVpaidWrapper",this._onResizeAd.bind(this))}},{key:"_onResizeAd",value:function(e){this.config&&(this.config.width=e.width,this.config.height=e.height)}},{key:"_setOppsulaInstance",value:function(){var e=this.store.get("non_bllb_opps_base_path")||this.store.get("opps_base_path");this.store.multiSet({ms_data:{opps_base_path:e||this.config.creatives.CM_DOMAIN},oppsula:this.options.oppsula}),this.store.emit("oppsulaCreated",this.options.oppsula)}},{key:"_createWaterfallManager",value:function(){this.waterfallManager=new U(this.store,this.config),this._setCreativeData(),this.waterfallManager.init(this.config.creatives,this.config.creativeData.AdParameters),this.waterfallManager.SetWaterfallSuccess(this._onWaterfallSuccess.bind(this)),this.waterfallManager.SetShouldRun(this._shouldRunWaterfall.bind(this))}},{key:"_setCreativeData",value:function(){for(var e in this.config.creativeData={},this.config.creatives)(void 0===this.config.creativeData[e]||this.config.protectedCreatives.indexOf(e)>-1)&&(this.config.creativeData[e]=this.config.creatives[e]);try{this.config.creativeData.AdParameters&&"string"==typeof this.config.creativeData.AdParameters&&(this.config.creativeData.AdParameters=JSON.parse(this.config.creativeData.AdParameters))}catch(e){}}},{key:"_onWaterfallSuccess",value:function(e){this.manager&&this.manager.fillSchedule(e)}},{key:"_shouldRunWaterfall",value:function(){var e=this.store.get("max_ready_vpaid")||2;return!this.manager||this.manager.getVpaidReadyCount()<e}},{key:"_onWaterfallManagerCreated",value:function(){if(this.debugTracker.info("_onWaterfallManagerCreated","Vpaid-Player->Creating..."),this.slot=this._getVideoSlot(),this.slot){this._setSizesToConfig(),this._setAdParameters();try{this._initManagerAndLiteUnitResponse()}catch(e){this._initManagerAndLiteUnitResponseFallback()}this.manager&&this._registerManagerEvents()}}},{key:"_registerManagerEvents",value:function(){this.manager.on(ke.A.AdVideoStart,this._onAdVideoStartEvent.bind(this)),this.manager.on(ke.A.AdImpression,this._onAdImpressionEvent.bind(this)),this.manager.on(ke.A.AdStopped,this._onAdStoppedEvent.bind(this)),this.manager.on(ke.A.AdVideoComplete,this._onAdVideoCompleteEvent.bind(this)),this.manager.on(ke.A.AdError,this._onAdErrorEvent.bind(this)),this.manager.on(ke.A.AdStarted,this._onAdStartedEvent.bind(this)),this.manager.on(ke.A.HijackAttempt,this._onHijackAttemptEvent.bind(this)),this.manager.on(ke.A.AdPaused,this._onAdPausedEvent.bind(this)),this.manager.on(ke.A.AdPlaying,this._onAdPlayingEvent.bind(this)),this.manager.on(ke.A.AdSkipped,this._onAdStoppedEvent.bind(this)),this.manager.on("viewAdPlayer",this._displayAdPlayer.bind(this))}},{key:"_onAdVideoStartEvent",value:function(){this.stopped||(this.volume(this._getWorkingVolume()),this.emit(ke.A.AdVideoStart))}},{key:"_getWorkingVolume",value:function(){var e=0;return this.options.vpaidTag.volume?"auto"==this.options.vpaidTag.volume&&(e=this.store.get("volume")):e=this.options.volume/100,(0,m.ZE)(e)}},{key:"volume",value:function(e){if(null==(e=(0,m.ZE)(e)))return this._getAdVolume();this._setAdVolume(e),this._volume=e}},{key:"_setAdVolume",value:function(e){if(!this.isMobile){if(e=(0,m.ZE)(e),isNaN(parseFloat(e)))return!1;this.manager&&this.manager.setAdVolume(e)}}},{key:"_getAdVolume",value:function(){return this.manager?this.manager.callWorkingVpaid("getAdVolume",[],0):0}},{key:"_onAdImpressionEvent",value:function(e){this._displayAdPlayer(e?e.dispatcher:void 0),this.stopped||(this.emit(ke.A.AdImpression,e),this.volume(this._getWorkingVolume()),this.isMultiVpaidUnit||this._resizeAd(this.options.width,this.options.height,this.viewmode))}},{key:"_displayAdPlayer",value:function(){this._hideAdPlayer(),this.adPlaying||(this.adPlaying=!0,this._hideContentVideo(),this._displayVideoWrapper(),this.manager.bringVpaidToFront()),this.isAdPlayerVisible||(this.isAdPlayerVisible=!0,this.store.emit("AdPlayerVisible"))}},{key:"_hideContentVideo",value:function(){this.video.pause(),this.video.style.display="none",this.video.style.zIndex=0}},{key:"_displayVideoWrapper",value:function(){this.playWithoutContainer||(this.videoWrapper.style.zIndex=100,(0,m.iQ)(this.videoWrapper,"_ad-cm-playing"),this.videoWrapper.style.display="block")}},{key:"_resizeAd",value:function(e,t,i){try{this.config.width=e,this.config.height=t,this.config.viewMode=i,this.manager&&this.manager.resizeAd(e,t,i)}catch(e){this.debugTracker.error(e)}}},{key:"_onAdStoppedEvent",value:function(e){this.emit(ke.A.AdStopped,e),this.stop()}},{key:"_hideAdPlayer",value:function(){clearTimeout(this.hideAdPlayerDelayId)}},{key:"_onAdVideoCompleteEvent",value:function(){this._hideAdPlayer(),this.emit(ke.A.AdVideoComplete)}},{key:"_onAdErrorEvent",value:function(){var e=arguments&&arguments.length>0?arguments[0]:"";this.debugTracker.error("Ad-".concat(this.options.uid),e||"Ad Threw Error"),this.emit(ke.A.AdError),this.stop()}},{key:"_onAdStartedEvent",value:function(){this.volume(this._getWorkingVolume())}},{key:"_onHijackAttemptEvent",value:function(){(0,m._x)("".concat((0,m.tZ)({dataCenter:"us",baseReportD:"basebanner.com"}),"?cijs=0&ttype=5&pix=31542217&dast=").concat(this.options.vpaidTag.auc_dast,"&").concat((new Date).getTime()))}},{key:"_onAdPausedEvent",value:function(){this.store.emit("contentPaused"),this.paused=!0}},{key:"_onAdPlayingEvent",value:function(){this.paused&&this.store.emit("contentResumed"),this.paused=!1}},{key:"_getVideoSlot",value:function(){var e=this.playWithoutContainer?this.target:this.videoWrapper;if("string"==typeof e){if(document.getElementById(e))return document.getElementById(e)}else if("object"===Ql(e)&&e.style&&e.tagName)return e;return this.debugTracker.error("_getVideoSlot","Bad slot"),!1}},{key:"_setSizesToConfig",value:function(){this.config.width=parseInt(this.options.width),this.config.height=parseInt(this.options.height),this.config.creatives.PLAYER_WIDTH=this.config.width,this.config.creatives.PLAYER_HEIGHT=this.config.height}},{key:"_setAdParameters",value:function(){this.options.vpaidTag.skip_vast||!this.config.creativeData.adParameters?this.config.creativeData.adparameters=this.config.creativeData.AdParameters=this.config.creativeData.adParameters=this.options.vpaidTag.ad_parameters:this.config.creativeData.adparameters=this.config.creativeData.AdParameters=this.config.creativeData.adParameters}},{key:"_initManagerAndLiteUnitResponse",value:function(){this._createManager(),this.waterfallManager.handleLiteUnitWfResponse()}},{key:"_createManager",value:function(){this.manager=new ql({store:this.store,config:this.config,options:this.options,target:this.slot})}},{key:"_initManagerAndLiteUnitResponseFallback",value:function(){try{this._parseAdParameters(),this._initManagerAndLiteUnitResponse()}catch(e){this._onManagerInitError()}}},{key:"_parseAdParameters",value:function(){var e=this.config.creativeData.AdParameters||"{}";this.config.creativeData.adParameters={},this.config.creativeData.adParameters=JSON.parse(e),this.config.creativeData.adparameters=this.config.creativeData.AdParameters=this.config.creativeData.adParameters}},{key:"_onManagerInitError",value:function(){this.emit("AdLoadError"),this.stop()}},{key:"dropAds",value:function(e){this.manager.cleanQueue(this.store.get("queue_size")||10,e),this.waterfallManager.dropAds(e)}},{key:"addWfParameter",value:function(e,t){this.waterfallManager.addWfParameter(e,t)}},{key:"updateWfParameter",value:function(e,t){this.waterfallManager.updateWfParameter(e,t)}},{key:"removeWfParameter",value:function(e){this.waterfallManager.removeWfParameter(e)}},{key:"playManager",value:function(){this.manager.play()}},{key:"pauseManager",value:function(){this.manager.pause()}},{key:"runWaterfall",value:function(e){this.waterfallManager.runWaterfall(e)}},{key:"stop",value:function(){this.stopped||(this.stopped=!0,setTimeout(this._hideAdPlayer.bind(this),0),this.waterfallManager&&this.waterfallManager.stop(),this.manager&&this.manager.stop())}},{key:"resize",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"normal";if(t=parseInt(t),e=parseInt(e),this.options.height=t,this.options.width=e,this.viewmode=i,!isNaN(e)||!isNaN(t))return this._resizeVideoWrapper(e,t),this._tryResizeAdForSingleVpaidUnit(e,t,i)}},{key:"_resizeVideoWrapper",value:function(e,t){this.playWithoutContainer||(this.videoWrapper.style.width="".concat(e,"px"),this.videoWrapper.style.height="".concat(t,"px"))}},{key:"_tryResizeAdForSingleVpaidUnit",value:function(e,t,i){var r=this.isMultiVpaidUnit||!1;if(!this.isMultiVpaidUnit)try{this._resizeAd(e,t,i)}catch(e){this.debugTracker.error("resize",e),r=!1}return r}},{key:"getAd",value:function(e){if(this.manager)return this.manager.getAd(e)}},{key:"getClickedAd",value:function(){if(this.manager)return this.manager.getClickedAd()}},{key:"reportQueueStatus",value:function(){this.manager&&this.manager.reportQueueStatus()}}],t&&Kl(e.prototype,t),i&&Kl(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();function Jl(e){return Jl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jl(e)}function Zl(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,$l(r.key),r)}}function $l(e){var t=function(e,t){if("object"!=Jl(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=Jl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Jl(t)?t:t+""}var ed="killAfterXWithNoConversion",td="none",id="_onVpaidClosed",rd="pre-roll",nd=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._overrideWindowMethods(),this._init(),this._createStore(t),this._fireDisplayImpression(),this._loadAdxScript(),this.isMobile=this.store.get("isMobile"),this.isMultiVpaidUnit=this.store.get("isMultiVpaidUnit"),this.playWithoutContainer=this.store.get("noplrcntr"),this._setTrackerDebugLevels(),this.isClickToPlay=this._isAutoplayDisabled(),this._logConnectionType(),this._setBaseURL(),this._createModules(),this._setStaticSchedule(),this._overrideNonNativeFunctions(),this._shouldDisabledIosAutoPlay(),this.playContentBeforeAds=this.store.get("plcntbfrads"),this._onVpaidClosed=function(){},this._registerEvents(),this._killAfterXWithNoConversion(),this.onPlayerReadyActions=new Array,this.target=this._handleTarget(t.target_id),this.target?(this._createIframesWrapper(),this.store.set("can_opt_out",this._shouldOptOut()),this._onTargetCreated(),(0,m.v6)(this._handleReportVastXmlList,this),(0,m.v6)(this._createComponentsManager,this)):this.debugTracker.error("Constructor","No player target! Can't build player in [".concat(this.target,"]... aborting!"))},t=[{key:"_createIframesWrapper",value:function(){this.iframesWrapper=document.createElement("div"),this.iframesWrapper.id="_cm-iframes-wrapper",this.iframesWrapper.className="iframes-wrapper",this.iframesWrapper.style.display="none",this.target.appendChild(this.iframesWrapper)}},{key:"_overrideWindowMethods",value:function(){void 0!==Object.assign&&(0,m.$O)(Object.assign)||this._overrideObjectAssign()}},{key:"_overrideObjectAssign",value:function(){Object.assign=function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}}},{key:"_init",value:function(){this.status="loading",this.videoLength=0,this.video,this.repeatCount=0,this.schedule={},this.playerIsClosed=!1}},{key:"_createStore",value:function(e){this.options=function(e){var t={domain:window.location.hostname,cirf:"",referrer:document.referrer?document.referrer.split("//")[1]:window.location.hostname,vertical:"default",auc_dast:"0",title:"",description:"",keywords:"",default_ad_parameters:"",files:[],image:!1,target_id:"",height:!1,width:!1,controls:!0,aspect_ratio:"16:9",repeat:!0,mute:!1,oid:0,default_ad_timeout:30,volume:0,video_class_name:"video-js vjs-default-skin",schedule:[],schedule_auto:1,debug:[],report_vast_xml:!1,htmlVideoSupport:!!document.createElement("video").canPlayType,ga_factor:1,ad_controls:!1,time_between_waterfall:10,tmbtwfs:function(e,t,i,r){return i.get("time_between_waterfall")},mntmbtwfsf:function(e,t,i,r){return i.get("mintimwf")},mintimwf:5e3,mntmbtwfs:5,mxtmbtwfs:900,queue_size:6,max_ready_vpaid:3,base_url:"//vidstat.taboola.com",wf_path:"VideoBidRequestHandlerServlet",run_wf_when_empty:!0,kaxwnc:18e5,pstflrs:!0,pvpd:"javascript",altmot:6e4,adimptmot:0,rv1adimptmot:0,jsnoflshdtct:!1,qsrtscr:function(e,t){return 0===t.alfrox&&t.rpox>0?t.requiredViewability<<30|t.priority<<16|parseInt(1e3*t.rpox):t.requiredViewability<<30|t.priority<<16|parseInt(t.alfrox*t.rpox*1e3)},psthdrs:"text/plain",rstmrai:!0,global_ad_timeout:18e4,mprdct:void 0,run_wf_on_init:!0,wf_dynmc_ps:!0,sprssviderr:!1,get_ad_timeout_seconds:10,wf_manual:!1,disctxt:"By Taboola",httpsOverride:!0,usscrtgurl:!1,evtbsschdl:!0,timbtopps:2e3,cmbopps:!0,anltcsOptions:{withXHR:!0,withIframes:!0,withScripts:!0,maxNetworkCalls:0,timeout:3e3,deepIframes:!1},omidVerificationScriptVersion:"1.5.3-iab4563",omidWebUrl:"https://cdn.taboola.com/shared/omweb-v2.js",omidSessionUrl:"https://cdn.taboola.com/shared/omid-session-client-v2.js",omidPartnerName:"Taboola",omidExcludedVendors:["doubleverify"],novdtrm:!1,dcdvdurl:!1,firstWaterfallNoaop:0,mxlifls:0,kbnul:"//vidanalytics.taboola.com",frcmtfrms:!0,frcvlm:!1,pxlnotsmtp:!1,mxemptwf:0,mltads:!1,erlyai:!1,jsDsbleErlyai:!1,frcadvlmtrvl:1e3,dbncadvltm:50,stpfrcvlevnt:"AdVideoFirstQuartile",imapihok:!1,trmrdyvpaid:!0,dfltvlm:.4,dlywf:!1,adto:3e5,vakll:3e5,ovrtgbydc:!1,frstlk:!1,pusvidprtctn:!1,encwfrs:!0,dsktmouttoadcmpltn:3e4,mbltmouttoadcmpltn:3e4,wfv:1,isMultiVpaidUnit:!1,isIdleMode:!1,mxntwrkclls:80,rplvpdactv:!1,rvfctr:0,dnapmxvl:0,bllblevt:"1,25,21,22,23,24",ifrmswghts:{gen:15,ggl:6,pxls:30},dskVidMuted:!0,ovrdnonntvfnclst:{},fkadchcs:!1,mtdhkactv:!1,addprld:!0,blckbrngtofrnt:!1,tglifrmcntndsplyactv:!0,cmpltonstpddmn:["innovid.com"],cmpltonstpdms:0,aduntldflbfruntld:!0,bckflldlyms:1e4,mxbckflldlyitms:0,bfprty:0,shwadmtebtn:!0,shwadsplypusbtn:"hide",disprgrbrclk:!1,wtfradpsdbfrrsmad:!1,noplrcntr:!1,vpdcntrcstmcss:"",msnifrmsrchk:!0,prvaupl:!0,stpvpdonudfndsrc:!0,rvfrquesttsemttr:!0,cntgtad:!0,dftgprc:void 0,scrmf:!0,hjkbldomsencdd:[],cpcvcmpgntps:[14,17],cstmdltps:{tags:7,dCPM:9,externalCPCV:14,internalCPCV:17},drpbletps:["singleAd","hip"],rplcpxlmcrplchldr:!0,erronopp:!0,plcntbfrads:!0,frwferrpxls:0,frdmrvhpxls:0,frdqshpxls:0,hdtrgt:!1,spprtvrtclvd:!0,prvnterlyadimpopp:!1,untetrk:["viewability","viewable50precent1sec","fullyviewable1sec"],wtchvdointrvl:1e3,rprtvidsttsintrvl:1e3,q5byprgrss:!0,mnvlddrtn:.1,frmltplpxls:["AdPaused","AdClickThru","AdPlaying"],mblmdiadrctdmnd:!1,firstWfRes:void 0,fmli:void 0,fmpw:"",rvtyptodlyvdovmpson:!0,updtcmpbfrwf:!1,firedsplyimp:!1,aduntladtmt:1e4,mnbfrsz:.25,prftchmxlngth:15,imscrptsrc:"//imasdk.googleapis.com/js/sdkloader/ima3.js",adtrgtcss:!0,wtuntlcntrinvw:!1,cntrelm:"",sndgdprprmswf:!1,prfrmncmsrmnts:!0,slwcnctlngt:10,vwclcflbkenbld:!1,omidaccsmd:"FULL",frdwnlnkpxls:0,dwnlnktrshld:8,rmvrvlwntwrk:!1,vldtvwbfrcmp:!0,omddsbldbrwsrs:[],frppdfpxl:0,atplyhk:!1,sortByDurationAndCpm:!1,fileSizeConfiguration:{enabled:!1,frameTypes:[3],threshold:2},prfrmdfl:"video",dpndonuntfrlgtoelstc:!1,enblopp:{58:!0},useVideoControls:!0,regx:"",videoBlacklist:"",mxwrps:3,adxblck:{isActive:!1,advIds:[],mode:F},prebid:{timeout:5e3,isActive:!0,debug:!1,maxBidThreshold:100,iiq:{scriptUrl:"https://vidstat.taboola.com/assets/IIQAgent2.js",timeout:5e3,excludedPartners:["openx"],partnerId:189784809},id5:{partnerId:246,name:"id5Id",storageName:"id5id",excludedPartners:["rubicon"]}},overrideSessionDataOnEveryWfResponse:!0,cleanAdOnImp:!0,context:"outstream",nbladnoorgnc:!0,emitVimpOnMp4AdLoad:!0,blocklistFetchUrl:"",fireOldBlackListLoaded:0,isVerticalDemandBlocked:!1,onPlayerReady:function(e){},onPlayerLoadError:function(e){},onPlayerError:function(e){},onPlayerPlay:function(e){},onPlayerStop:function(e){},onPlayerClose:function(e){},onPlayerPause:function(e){},onPlayerResume:function(e){},onPlayerRepeat:function(e){},onPlayerComplete:function(e){},onAdLoadError:function(e,t){},onAdError:function(e,t){},onAdStopped:function(e,t){},onAdImpression:function(e,t){},onAdVideoStart:function(e,t){},onAdVideoEnd:function(e,t){},onAdClick:function(e,t,i){}};for(var i in t)null==e[i]&&(e[i]=t[i]);e.description||(e.description=e.title),e.keywords||(e.keywords=e.title),parseFloat(e.width)||parseFloat(e.height)||(e.width="377",e.height="314");var r=parseInt(100*Math.random())+1<=e.ron_percent;return e.tagDefault={ad_controls:e.ad_controls,url:"",pubid:"",tagid:"",vidlength:"",video_url:e.files[0],title:e.title,cirf:e.cirf,description:e.description,keywords:e.keywords,ad_parameters:e.default_ad_parameters,muted:e.mute?1:0,auc_dast:e.auc_dast,referrer:e.referrer,domain:e.domain,vertical:e.vertical,roll_type:"mid-roll",oid:e.oid,ad_timeout:e.default_ad_timeout,rs:"1",st:"1",sts:"1",type:"wf",noaop:"10",sortOrderType:0,afbp:e.use_flash_bypass,isRon:r,isvideo:0,mindur:1,maxdur:e.default_ad_timeout,minbr:1,maxbr:1e4,plmd:0,defaultTagTimeout:30,use_as_is:!1,skip_vast:!1},e}(e);var t=Object.assign(function(){var e={};try{e=window.cmTag.config}catch(e){return{}}var t={};for(var i in e)0===i.indexOf("player.settings.")&&(t[i.substr(16,i.length-16)]=W(e[i]));return t}(),e.dplayerSettings);this.options=(0,m.p4)(this.options,t),this.store=new Y(this.options),this._appendParamsToStore()}},{key:"_appendParamsToStore",value:function(){this.store.multiSet({player_id:"".concat(Date.now(),"_").concat((0,m.DA)(30)),fullPageUrl:window.location.href,forcePause:!1,forceMute:!1,conversionsCount:0,failsCount:this.store.get("failsCount")||0,"getAdData.count":0,playerAspectRatio:this.options.aspect_ratio,noplrcntr:this.store.get("noplrcntr")&&this.store.get("isMultiVpaidUnit"),isAmp:window.TRC&&window.TRC.isAMP,queueLength:0,vpaidReadyCount:0,"document.visible":!document.hidden,ads_playing:0,ads_started:0,total_impressions:0})}},{key:"_fireDisplayImpression",value:function(){this.store.get("firedsplyimp")&&(0,m.jr)((0,m.TF)(E.A.playerDisplayImpression,this.store))}},{key:"_loadAdxScript",value:function(){var e=this;if(this.store.get("shouldLoadAdxScript")){this.store.multiSet({"adxScript.loading.isComplete":!1,"adxScript.loading.inProgress":!0});var t=document.createElement("script");t.onload=function(){e.store.set("adxScript.loading.isComplete",!0),e.store.emit("adxScript.loading.complete")},t.src=this.store.get("imscrptsrc"),t.async=!0,document.getElementsByTagName("head")[0].appendChild(t)}else this.store.once("adxScript.loadScript",(function(){e.store.set("shouldLoadAdxScript",!0),e._loadAdxScript()}))}},{key:"_setTrackerDebugLevels",value:function(){y.A.prototype.debugLevels=this.store.get("debugLevels")||""}},{key:"_isAutoplayDisabled",value:function(){return!this.isMobile&&this.store.get("prvaupl")&&this.store.get("wurfl.browser.name").indexOf(be)>-1}},{key:"_logConnectionType",value:function(){var e,t=null===(e=this.store.get("navigatorConnection"))||void 0===e?void 0:e.typeId,i=fe.hasOwnProperty(t)?fe[t]:"unknown";this.store.set("connectionType",{type:i})}},{key:"_setBaseURL",value:function(){var e=this.store.get("base_url");e&&0!==e.length||this.store.multiSet({original_base_url:"empty",href:window.location.href,base_url:"//www.cmbestsrv.com"})}},{key:"_createModules",value:function(){this._createConnectionTypeDetector(),this._createDependciesLoader(),this._createDebugTracker()}},{key:"_createConnectionTypeDetector",value:function(){this.connectionTypeDetector=new pe(this.store)}},{key:"_createDependciesLoader",value:function(){this.dependenciesLoader=new de(this.store)}},{key:"_createDebugTracker",value:function(){this.debugTracker=new y.A("OvaMediaPlayer"),this.debugTracker.info("unit-version: ".concat(this.store.get("unit_loader_version"),", player-version: ").concat(this.store.get("player_version")),this.store,{color:"#D15EFF"}),this.debugTracker.info("userAgent: ".concat(JSON.stringify(this.store.get("wurfl"))))}},{key:"_createComponentsManager",value:function(){this.options.vpaidTag=this._getVpaidTag(),this._initContentSchedule(),this.componentsManager=new Xl({options:this.options,store:this.store,target:this.target,video:this.video}),this._registerToComponentsManagerEvents(),this.componentsManager.runWaterfall("vforceInit")}},{key:"_initContentSchedule",value:function(){var e={"00:00":this.options.vpaidTag,"00:01":this.options.vpaidTag};this.store.set("contentSchedule",e)}},{key:"_getVpaidTag",value:function(){var e=this.store.get("schedule"),t={};return e.forEach((function(e){e&&e.roll_type===rd&&(t=e)})),t}},{key:"_registerToComponentsManagerEvents",value:function(){this.componentsManager.on(ke.A.AdVideoStart,this._onAdVideoStartEvent.bind(this)),this.componentsManager.on(ke.A.AdImpression,this._onAdImpressionEvent.bind(this)),this.componentsManager.on(ke.A.AdStopped,this._onAdStoppedEvent.bind(this)),this.componentsManager.on(ke.A.AdVideoComplete,this._onAdVideoCompleteEvent.bind(this)),this.componentsManager.on(ke.A.AdError,this._onAdErrorEvent.bind(this)),this.componentsManager.on("AdLoadError",this._onAdLoadErrorEvent.bind(this))}},{key:"_onAdVideoStartEvent",value:function(){this.options.onAdVideoStart(this,this.componentsManager)}},{key:"_onAdImpressionEvent",value:function(e){this.options.onAdImpression(this.componentsManager,e.dispatcher,e.tag)}},{key:"_onAdStoppedEvent",value:function(e){this.options.onAdStopped(e.dispatcher.index,this.componentsManager)}},{key:"_onAdVideoCompleteEvent",value:function(){this.options.onAdVideoEnd(this,this.componentsManager)}},{key:"_onAdErrorEvent",value:function(){this.options.onAdError(this,this.componentsManager)}},{key:"_onAdLoadErrorEvent",value:function(){this.options.onAdLoadError(this,this.componentsManager)}},{key:"_setStaticSchedule",value:function(){this._shouldUseStaticSchedule()&&this.store.set("static_schedule",this.options.schedule)}},{key:"_shouldUseStaticSchedule",value:function(){return this.options.schedule&&this.options.schedule.length&&this.options.schedule[0].ad_parameters&&this.options.schedule[0].ad_parameters.length>2}},{key:"_overrideNonNativeFunctions",value:function(){var e=this.store.get("ovrdnonntvfnclst");if(0!==Object.keys(e).length){var t=this._createHiddenIframe();for(var i in e)(0,m.$O)(window[i])||(window[i]=e[i](t))}}},{key:"_createHiddenIframe",value:function(){var e=document.createElement("iframe");return e.style.width=0,e.style.height=0,e.style.visibility="hidden",e.style.display="none",document.body.appendChild(e),e}},{key:"_shouldDisabledIosAutoPlay",value:function(){var e=this;this.isMobile&&(this.store.get("iosAutoPlayDisabled")||this.store.get("wurfl.os.name")!==me||document.addEventListener("ltIosAutoDisable",(function(){e.store.set("iosAutoPlayDisabled",!0)})))}},{key:"_registerEvents",value:function(){this._registerBeforeUnloadEvent(),this._registerAdImpressionEvent(),this._registerClosePlayerEvent(),this._registerAdClickThroughEvent()}},{key:"_registerBeforeUnloadEvent",value:function(){var e=this;window.addEventListener("beforeunload",(function(){e.store.emit("beforeunload")}))}},{key:"_registerAdImpressionEvent",value:function(){this.store.on("AdImpression",this._killAfterXWithNoConversion.bind(this))}},{key:"_killAfterXWithNoConversion",value:function(){var e=this,t=this.store.get("kaxwnc");t&&(this.kaxwnc&&clearTimeout(this.kaxwnc),this.kaxwnc=setTimeout((function(){e.closeCleanPlayer(ed)}),t))}},{key:"closeCleanPlayer",value:function(e){var t=this;this.store.set("playerClosed",!0),setTimeout((function(){e=e||td,t.store.emit("stop","close:".concat(e)),t.playerIsClosed||(clearInterval(t.contentInterval),t._destroyModules(),t.playerIsClosed=!0,t._onVpaidClosed=function(){},t._stop(),t._removeTargetElement(),t.onPlayerReadyActions=t.debugTracker=t.video=t.schedule=t.options=t.target=void 0)}),0)}},{key:"_destroyModules",value:function(){this.componentsManager&&!this.componentsManager.stopped?this.componentsManager.stop():this.parent&&this._onVpaidClosed(),this.dependenciesLoader&&this.dependenciesLoader.destroy()}},{key:"_removeTargetElement",value:function(){if(!this.playWithoutContainer)for(;this.target.childNodes.length;)this.target.removeChild(this.target.childNodes[0])}},{key:"_registerClosePlayerEvent",value:function(){this.store.on("closePlayer",this._closePlayer.bind(this))}},{key:"_closePlayer",value:function(){this._onVpaidClosed=this.closeCleanPlayer.bind(this,id),this.options.onPlayerClose(this)}},{key:"_registerAdClickThroughEvent",value:function(e){this.store.on(ke.A.AdClickThru,this._onAdClickThroughEvent.bind(this))}},{key:"_onAdClickThroughEvent",value:function(e){this.options.onAdClick(this,this.componentsManager.getClickedAd(),e)}},{key:"_resizeVpaidHandler",value:function(e,t){var i;null===(i=this.componentsManager)||void 0===i||i.resize(e,t)}},{key:"_resize",value:function(e,t){this.options.height=t+"",this.options.width=e+"",this._setVideoSize((0,m.O5)(this.options.width),(0,m.O5)(this.options.height))}},{key:"_resizeBasedOnWidth",value:function(e){this.options.height=!1,this.options.width=e+"";var t=this.options.aspect_ratio.split(":")[1]/this.options.aspect_ratio.split(":")[0],i=(0,m.O5)(this.options.width),r=(0,m.O5)(Math.floor(parseFloat(i)*t)+"");this._setVideoSize(i,r)}},{key:"_resizeBasedOnHeight",value:function(e){this.options.width=!1,this.options.height=e+"";var t=this.options.aspect_ratio.split(":")[0]/this.options.aspect_ratio.split(":")[1],i=(0,m.O5)(this.options.height),r=(0,m.O5)(Math.floor(parseFloat(i)*t)+"");this._setVideoSize(r,i)}},{key:"_setVideoSize",value:function(e,t){this.isMultiVpaidUnit||(this.playWithoutContainer||this._resizeTarget(e,t),this._resizeVideo(e,t))}},{key:"_resizeTarget",value:function(e,t){this.target.style.width=e,this.target.style.height=t,this.target.setAttribute("width",parseInt(e)),this.target.setAttribute("height",parseInt(t))}},{key:"_resizeVideo",value:function(e,t){this.video.style.width=e,this.video.style.height=t,this.video.setAttribute("width",parseInt(e)),this.video.setAttribute("height",parseInt(t))}},{key:"_handleTarget",value:function(e){return this.playWithoutContainer?document.querySelector(e):"string"==typeof e?document.getElementById(e):e}},{key:"_shouldOptOut",value:function(){return this.store.get("can_opt_out")||null!==this.target.parentElement.querySelector("#_cm-opt-out-view")}},{key:"_onTargetCreated",value:function(){this.options.htmlVideoSupport?this._createMediaPlayer():(this.debugTracker.error("Constructor","Browser does not support <video> Tag!Nothing to do, aborting..."),this.options.onPlayerLoadError(this))}},{key:"_createMediaPlayer",value:function(){this._handlePlayerContainer(),this._createPlayerTag(),this._attachEventsToVideo(),this.isMultiVpaidUnit&&this._onMultiVpaidUnit(),this._setPlayerTagAttributes(),this._triggerPlayerReadyToUnit(),this.video=this.playerTag,this._setTargetId(),this._setVideoSize("".concat(this.options.width,"px"),"".concat(this.options.height,"px"))}},{key:"_setTargetId",value:function(){this.playWithoutContainer||(this.target.id="_cm-css-reset")}},{key:"_handlePlayerContainer",value:function(){this.playWithoutContainer||((0,m.iQ)(this.target,"vpaid-player-container"),this.isMultiVpaidUnit&&(0,m.iQ)(this.target,"multi-vpaids"))}},{key:"_createPlayerTag",value:function(){this.playerTag=new Pa(this.store,Hn),this.playerTag.id=this._generateId(),this.playerTag.className=this.options.video_class_name,this._initPlayerTag()}},{key:"_initPlayerTag",value:function(){this.isMultiVpaidUnit&&(0,m.iQ)(this.playerTag,"multi-vpaids"),this.playerTag.style.cssText="position: relative; z-index:99; cursor:pointer; display:block",this.isClickToPlay||this.playerTag.setAttribute("autoplay",""),this.isMobile&&this.store.get("wurfl.os.name")===me&&this.playerTag.removeAttribute("autoplay","")}},{key:"_attachEventsToVideo",value:function(){this.playerTag.addEventListener("error",this._onVideoError.bind(this),!0)}},{key:"_triggerReadyActions",value:function(){if(0!=this.onPlayerReadyActions.length){for(var e=0;e<this.onPlayerReadyActions.length;e++)this.onPlayerReadyActions[e].apply(this,[]);this.onPlayerReadyActions=new Array}}},{key:"_triggerPlayerReadyToUnit",value:function(){var e=this;window.setTimeout((function(){e._triggerReadyActions(),e.options.onPlayerReady(),e.componentsManager&&(0,m.v6)(e.componentsManager.reportQueueStatus,e)}),0)}},{key:"_onVideoError",value:function(e){this.isMobile||(this.status="stopping",this.video.pause(),this.status="loading",this.options.onPlayerError(this,e))}},{key:"_onMultiVpaidUnit",value:function(){if(this.options.height||this.options.width)if(this.options.height&&this.options.width)this.playerTag.style.height=(0,m.O5)(this.options.height),this.playerTag.style.width=(0,m.O5)(this.options.width);else{var e=this.options.aspect_ratio.split(":");if(this.options.width){var t=e[1]/e[0];this.playerTag.style.width=(0,m.O5)(this.options.width),this.playerTag.style.height=(0,m.O5)(Math.floor(parseFloat(this.playerTag.style.width)*t))}else{var i=e[0]/e[1];this.playerTag.style.height=(0,m.O5)(this.options.height),this.playerTag.style.width=(0,m.O5)(Math.floor(parseFloat(this.playerTag.style.height)*i))}}else this.debugTracker.error("createMediaPlayer","No `height` or `width` specified!")}},{key:"_setPlayerTagAttributes",value:function(){this.playerTag.muted=!0,this.playerTag.setAttribute("width",parseFloat(this.playerTag.style.width)+""),this.playerTag.setAttribute("height",parseFloat(this.playerTag.style.height)+""),this.playerTag.setAttribute("playsinline",""),this.options.repeat&&(this.playerTag.playerRepeat=!0),this.options.image&&this.playerTag.setAttribute("poster",this.options.image)}},{key:"_generateId",value:function(){for(var e="vpaid-".concat(Math.floor(65536*(1+Math.random())));document.getElementById(e);)e="vpaid-".concat(Math.floor(1e5*(1+Math.random())));return e}},{key:"_handleReportVastXmlList",value:function(){this.store.get("report_vast_xml")&&window.TRC&&(window.TRC.vastXmlList=[])}},{key:"set",value:function(e,t){this.store.set(e,t)}},{key:"get",value:function(e){return this.store.get(e)}},{key:"on",value:function(e,t){this.store.on(e,t)}},{key:"off",value:function(e,t){this.store.off(e,t)}},{key:"emit",value:function(e,t){e&&this.store.emit(e,t)}},{key:"getAd",value:function(e){if(this.componentsManager)return this.componentsManager.getAd(e)}},{key:"startIdleMode",value:function(){this.store.set("isIdleMode",!0)}},{key:"stopIdleMode",value:function(){this.store.set("isIdleMode",!1)}},{key:"startWf",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.store.emit("startWf",e)}},{key:"stopWf",value:function(){this.store.emit("stopWf")}},{key:"dropAds",value:function(e){this.componentsManager.dropAds(e)}},{key:"addWfParameter",value:function(e,t){this.componentsManager.addWfParameter(e,t)}},{key:"updateWfParameter",value:function(e,t){this.componentsManager.updateWfParameter(e,t)}},{key:"removeWfParameter",value:function(e){this.componentsManager.removeWfParameter(e)}},{key:"play",value:function(){this.store.get("forcePause")||this.componentsManager.playManager()}},{key:"pause",value:function(){this.componentsManager.pauseManager()}},{key:"_resume",value:function(){this.componentsManager.playManager()}},{key:"_stop",value:function(){try{this.status="stopped",this.options.onPlayerStop(this)}catch(e){}}},{key:"resize",value:function(e,t,i){this._resizeVpaidHandler(e,t);try{(null==e||isNaN(parseInt(e)))&&(e=!1),(null==t||isNaN(parseInt(t)))&&(t=!1),e||t||(this.debugTracker.error("resize","No `height` or `width` specified!"),e=this.store.get("width"),t=this.store.get("height")),t&&e?this._resize(e,t):(i&&i.split(":").length>1&&(this.options.aspect_ratio=i),e?this._resizeBasedOnWidth(e):this._resizeBasedOnHeight(t))}catch(e){this.debugTracker.error("resize","Resizing component failed!")}}},{key:"onPublisherVideoDetectChange",value:function(e){this.store.set("publisherVideoDetected",e)}}],t&&Zl(e.prototype,t),i&&Zl(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,i}();window.OvaMediaPlayer=nd})()})();